{"ast":null,"code":"import { __extends } from \"tslib\";\nimport { ColumnSeries } from \"./ColumnSeries\";\nimport { Candlestick } from \"./Candlestick\";\nimport { Template } from \"../../../core/util/Template\";\nimport { ListTemplate } from \"../../../core/util/List\";\nimport * as $utils from \"../../../core/util/Utils\";\nimport * as $array from \"../../../core/util/Array\";\n/**\r\n * Candlestick series.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/candlestick-series/} for more info\r\n * @important\r\n */\n\nvar CandlestickSeries =\n/** @class */\nfunction (_super) {\n  __extends(CandlestickSeries, _super);\n\n  function CandlestickSeries() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    /**\r\n     * A list of candles in the series.\r\n     *\r\n     * `columns.template` can be used to configure candles.\r\n     *\r\n     * @default new ListTemplate<Candlestick>\r\n     */\n\n\n    Object.defineProperty(_this, \"columns\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: new ListTemplate(Template.new({\n        themeTags: [\"autocolor\"]\n      }), function () {\n        return Candlestick._new(_this._root, {\n          themeTags: $utils.mergeTags(_this.columns.template.get(\"themeTags\", []), [\"candlestick\", \"series\", \"column\"])\n        }, [_this.columns.template]);\n      })\n    });\n    return _this;\n  }\n  /**\r\n   * @ignore\r\n   */\n\n\n  Object.defineProperty(CandlestickSeries.prototype, \"makeColumn\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (dataItem, listTemplate) {\n      var column = this.mainContainer.children.push(listTemplate.make());\n\n      column._setDataItem(dataItem);\n\n      listTemplate.push(column);\n      return column;\n    }\n  });\n  Object.defineProperty(CandlestickSeries.prototype, \"_updateGraphics\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (dataItem, previousDataItem) {\n      _super.prototype._updateGraphics.call(this, dataItem, previousDataItem);\n\n      var xAxis = this.getRaw(\"xAxis\");\n      var yAxis = this.getRaw(\"yAxis\");\n      var baseAxis = this.getRaw(\"baseAxis\");\n      var vcy = this.get(\"vcy\", 1);\n      var vcx = this.get(\"vcx\", 1);\n      var lx0;\n      var lx1;\n      var ly0;\n      var ly1;\n      var hx0;\n      var hx1;\n      var hy0;\n      var hy1;\n      var locationX = this.get(\"locationX\", dataItem.get(\"locationX\", 0.5));\n      var locationY = this.get(\"locationY\", dataItem.get(\"locationY\", 0.5));\n      var openLocationX = this.get(\"openLocationX\", dataItem.get(\"openLocationX\", locationX));\n      var openLocationY = this.get(\"openLocationY\", dataItem.get(\"openLocationY\", locationY));\n      var orientation;\n\n      if (yAxis === baseAxis) {\n        var open_1 = xAxis.getDataItemPositionX(dataItem, this._xOpenField, 1, vcx);\n        var close_1 = xAxis.getDataItemPositionX(dataItem, this._xField, 1, vcx);\n        lx1 = xAxis.getDataItemPositionX(dataItem, this._xLowField, 1, vcx);\n        hx1 = xAxis.getDataItemPositionX(dataItem, this._xHighField, 1, vcx);\n        hx0 = Math.max(open_1, close_1);\n        lx0 = Math.min(open_1, close_1);\n        var startLocation = this._aLocationY0 + openLocationY - 0.5;\n        var endLocation = this._aLocationY1 + locationY - 0.5;\n        ly0 = yAxis.getDataItemPositionY(dataItem, this._yField, startLocation + (endLocation - startLocation) / 2, vcy);\n        ly1 = ly0;\n        hy0 = ly0;\n        hy1 = ly0;\n        orientation = \"horizontal\";\n      } else {\n        var open_2 = yAxis.getDataItemPositionY(dataItem, this._yOpenField, 1, vcy);\n        var close_2 = yAxis.getDataItemPositionY(dataItem, this._yField, 1, vcy);\n        ly1 = yAxis.getDataItemPositionY(dataItem, this._yLowField, 1, vcy);\n        hy1 = yAxis.getDataItemPositionY(dataItem, this._yHighField, 1, vcy);\n        hy0 = Math.max(open_2, close_2);\n        ly0 = Math.min(open_2, close_2);\n        var startLocation = this._aLocationX0 + openLocationX - 0.5;\n        var endLocation = this._aLocationX1 + locationX - 0.5;\n        lx0 = xAxis.getDataItemPositionX(dataItem, this._xField, startLocation + (endLocation - startLocation) / 2, vcx);\n        lx1 = lx0;\n        hx0 = lx0;\n        hx1 = lx0;\n        orientation = \"vertical\";\n      }\n\n      this._updateCandleGraphics(dataItem, lx0, lx1, ly0, ly1, hx0, hx1, hy0, hy1, orientation);\n    }\n  });\n  Object.defineProperty(CandlestickSeries.prototype, \"_updateCandleGraphics\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (dataItem, lx0, lx1, ly0, ly1, hx0, hx1, hy0, hy1, orientation) {\n      var column = dataItem.get(\"graphics\");\n\n      if (column) {\n        var pl0_1 = this.getPoint(lx0, ly0);\n        var pl1_1 = this.getPoint(lx1, ly1);\n        var ph0_1 = this.getPoint(hx0, hy0);\n        var ph1_1 = this.getPoint(hx1, hy1);\n        var x_1 = column.x();\n        var y_1 = column.y();\n        column.set(\"lowX0\", pl0_1.x - x_1);\n        column.set(\"lowY0\", pl0_1.y - y_1);\n        column.set(\"lowX1\", pl1_1.x - x_1);\n        column.set(\"lowY1\", pl1_1.y - y_1);\n        column.set(\"highX0\", ph0_1.x - x_1);\n        column.set(\"highY0\", ph0_1.y - y_1);\n        column.set(\"highX1\", ph1_1.x - x_1);\n        column.set(\"highY1\", ph1_1.y - y_1);\n        column.set(\"orientation\", orientation);\n        var rangeGraphics = dataItem.get(\"rangeGraphics\");\n\n        if (rangeGraphics) {\n          $array.each(rangeGraphics, function (column) {\n            column.set(\"lowX0\", pl0_1.x - x_1);\n            column.set(\"lowY0\", pl0_1.y - y_1);\n            column.set(\"lowX1\", pl1_1.x - x_1);\n            column.set(\"lowY1\", pl1_1.y - y_1);\n            column.set(\"highX0\", ph0_1.x - x_1);\n            column.set(\"highY0\", ph0_1.y - y_1);\n            column.set(\"highX1\", ph1_1.x - x_1);\n            column.set(\"highY1\", ph1_1.y - y_1);\n            column.set(\"orientation\", orientation);\n          });\n        }\n      }\n    }\n  });\n  Object.defineProperty(CandlestickSeries.prototype, \"_processAxisRange\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (axisRange) {\n      var _this = this;\n\n      _super.prototype._processAxisRange.call(this, axisRange);\n\n      axisRange.columns = new ListTemplate(Template.new({}), function () {\n        return Candlestick._new(_this._root, {\n          themeTags: $utils.mergeTags(axisRange.columns.template.get(\"themeTags\", []), [\"candlestick\", \"series\", \"column\"])\n        }, [_this.columns.template, axisRange.columns.template]);\n      });\n    }\n  });\n  Object.defineProperty(CandlestickSeries, \"className\", {\n    enumerable: true,\n    configurable: true,\n    writable: true,\n    value: \"CandlestickSeries\"\n  });\n  Object.defineProperty(CandlestickSeries, \"classNames\", {\n    enumerable: true,\n    configurable: true,\n    writable: true,\n    value: ColumnSeries.classNames.concat([CandlestickSeries.className])\n  });\n  return CandlestickSeries;\n}(ColumnSeries);\n\nexport { CandlestickSeries };","map":{"version":3,"mappings":";AAEA,SAASA,YAAT,QAAyH,gBAAzH;AACA,SAASC,WAAT,QAA4B,eAA5B;AACA,SAASC,QAAT,QAAyB,6BAAzB;AACA,SAASC,YAAT,QAA6B,yBAA7B;AAEA,OAAO,KAAKC,MAAZ,MAAwB,0BAAxB;AACA,OAAO,KAAKC,MAAZ,MAAwB,0BAAxB;AAsBA;;;;;;;AAMA;AAAA;AAAA;EAAuCC;;EAAvC;IAAA;IAoBC;;;;;;;;;IAOAC;sBAAA;wBAAA;oBAAA;aAAqD,IAAIJ,YAAJ,CACpDD,QAAQ,CAACM,GAAT,CAAa;QACZC,SAAS,EAAE,CAAC,WAAD;MADC,CAAb,CADoD,EAIpD;QAAM,kBAAW,CAACC,IAAZ,CAAiBC,KAAI,CAACC,KAAtB,EAA6B;UAClCH,SAAS,EAAEL,MAAM,CAACS,SAAP,CAAiBF,KAAI,CAACG,OAAL,CAAaC,QAAb,CAAsBC,GAAtB,CAA0B,WAA1B,EAAuC,EAAvC,CAAjB,EAA6D,CAAC,aAAD,EAAgB,QAAhB,EAA0B,QAA1B,CAA7D;QADuB,CAA7B,EAEH,CAACL,KAAI,CAACG,OAAL,CAAaC,QAAd,CAFG;MAEqB,CANyB;IAArD;;EA0IA;EA3JA;;;;;;;;;WAGA,UAAkBE,QAAlB,EAAiEC,YAAjE,EAAwG;MACvG,IAAMC,MAAM,GAAG,KAAKC,aAAL,CAAmBC,QAAnB,CAA4BC,IAA5B,CAAiCJ,YAAY,CAACK,IAAb,EAAjC,CAAf;;MACAJ,MAAM,CAACK,YAAP,CAAoBP,QAApB;;MACAC,YAAY,CAACI,IAAb,CAAkBH,MAAlB;MACA,OAAOA,MAAP;IACA;;;;;;WAkBD,UAA0BF,QAA1B,EAAyEQ,gBAAzE,EAA8H;MAC7HC,iBAAMC,eAAN,CAAqBC,IAArB,CAAqB,IAArB,EAAsBX,QAAtB,EAAgCQ,gBAAhC;;MAEA,IAAMI,KAAK,GAAG,KAAKC,MAAL,CAAY,OAAZ,CAAd;MACA,IAAMC,KAAK,GAAG,KAAKD,MAAL,CAAY,OAAZ,CAAd;MACA,IAAME,QAAQ,GAAG,KAAKF,MAAL,CAAY,UAAZ,CAAjB;MAEA,IAAIG,GAAG,GAAG,KAAKjB,GAAL,CAAS,KAAT,EAAgB,CAAhB,CAAV;MACA,IAAIkB,GAAG,GAAG,KAAKlB,GAAL,CAAS,KAAT,EAAgB,CAAhB,CAAV;MAEA,IAAImB,GAAJ;MACA,IAAIC,GAAJ;MACA,IAAIC,GAAJ;MACA,IAAIC,GAAJ;MAEA,IAAIC,GAAJ;MACA,IAAIC,GAAJ;MACA,IAAIC,GAAJ;MACA,IAAIC,GAAJ;MAEA,IAAIC,SAAS,GAAG,KAAK3B,GAAL,CAAS,WAAT,EAAsBC,QAAQ,CAACD,GAAT,CAAa,WAAb,EAA0B,GAA1B,CAAtB,CAAhB;MACA,IAAI4B,SAAS,GAAG,KAAK5B,GAAL,CAAS,WAAT,EAAsBC,QAAQ,CAACD,GAAT,CAAa,WAAb,EAA0B,GAA1B,CAAtB,CAAhB;MAEA,IAAI6B,aAAa,GAAG,KAAK7B,GAAL,CAAS,eAAT,EAA0BC,QAAQ,CAACD,GAAT,CAAa,eAAb,EAA8B2B,SAA9B,CAA1B,CAApB;MACA,IAAIG,aAAa,GAAG,KAAK9B,GAAL,CAAS,eAAT,EAA0BC,QAAQ,CAACD,GAAT,CAAa,eAAb,EAA8B4B,SAA9B,CAA1B,CAApB;MAEA,IAAIG,WAAJ;;MAEA,IAAIhB,KAAK,KAAKC,QAAd,EAAwB;QACvB,IAAIgB,MAAI,GAAGnB,KAAK,CAACoB,oBAAN,CAA2BhC,QAA3B,EAAqC,KAAKiC,WAA1C,EAAuD,CAAvD,EAA0DhB,GAA1D,CAAX;QACA,IAAIiB,OAAK,GAAGtB,KAAK,CAACoB,oBAAN,CAA2BhC,QAA3B,EAAqC,KAAKmC,OAA1C,EAAmD,CAAnD,EAAsDlB,GAAtD,CAAZ;QAEAE,GAAG,GAAGP,KAAK,CAACoB,oBAAN,CAA2BhC,QAA3B,EAAqC,KAAKoC,UAA1C,EAAsD,CAAtD,EAAyDnB,GAAzD,CAAN;QACAM,GAAG,GAAGX,KAAK,CAACoB,oBAAN,CAA2BhC,QAA3B,EAAqC,KAAKqC,WAA1C,EAAuD,CAAvD,EAA0DpB,GAA1D,CAAN;QAEAK,GAAG,GAAGgB,IAAI,CAACC,GAAL,CAASR,MAAT,EAAeG,OAAf,CAAN;QACAhB,GAAG,GAAGoB,IAAI,CAACE,GAAL,CAAST,MAAT,EAAeG,OAAf,CAAN;QAEA,IAAIO,aAAa,GAAG,KAAKC,YAAL,GAAoBb,aAApB,GAAoC,GAAxD;QACA,IAAIc,WAAW,GAAG,KAAKC,YAAL,GAAoBjB,SAApB,GAAgC,GAAlD;QAEAP,GAAG,GAAGN,KAAK,CAAC+B,oBAAN,CAA2B7C,QAA3B,EAAqC,KAAK8C,OAA1C,EAAmDL,aAAa,GAAG,CAACE,WAAW,GAAGF,aAAf,IAAgC,CAAnG,EAAsGzB,GAAtG,CAAN;QACAK,GAAG,GAAGD,GAAN;QACAI,GAAG,GAAGJ,GAAN;QACAK,GAAG,GAAGL,GAAN;QAEAU,WAAW,GAAG,YAAd;MACA,CAnBD,MAoBK;QACJ,IAAIiB,MAAI,GAAGjC,KAAK,CAAC+B,oBAAN,CAA2B7C,QAA3B,EAAqC,KAAKgD,WAA1C,EAAuD,CAAvD,EAA0DhC,GAA1D,CAAX;QACA,IAAIiC,OAAK,GAAGnC,KAAK,CAAC+B,oBAAN,CAA2B7C,QAA3B,EAAqC,KAAK8C,OAA1C,EAAmD,CAAnD,EAAsD9B,GAAtD,CAAZ;QAEAK,GAAG,GAAGP,KAAK,CAAC+B,oBAAN,CAA2B7C,QAA3B,EAAqC,KAAKkD,UAA1C,EAAsD,CAAtD,EAAyDlC,GAAzD,CAAN;QACAS,GAAG,GAAGX,KAAK,CAAC+B,oBAAN,CAA2B7C,QAA3B,EAAqC,KAAKmD,WAA1C,EAAuD,CAAvD,EAA0DnC,GAA1D,CAAN;QAEAQ,GAAG,GAAGc,IAAI,CAACC,GAAL,CAASQ,MAAT,EAAeE,OAAf,CAAN;QACA7B,GAAG,GAAGkB,IAAI,CAACE,GAAL,CAASO,MAAT,EAAeE,OAAf,CAAN;QAEA,IAAIR,aAAa,GAAG,KAAKW,YAAL,GAAoBxB,aAApB,GAAoC,GAAxD;QACA,IAAIe,WAAW,GAAG,KAAKU,YAAL,GAAoB3B,SAApB,GAAgC,GAAlD;QAEAR,GAAG,GAAGN,KAAK,CAACoB,oBAAN,CAA2BhC,QAA3B,EAAqC,KAAKmC,OAA1C,EAAmDM,aAAa,GAAG,CAACE,WAAW,GAAGF,aAAf,IAAgC,CAAnG,EAAsGxB,GAAtG,CAAN;QACAE,GAAG,GAAGD,GAAN;QACAI,GAAG,GAAGJ,GAAN;QACAK,GAAG,GAAGL,GAAN;QAEAY,WAAW,GAAG,UAAd;MACA;;MAED,KAAKwB,qBAAL,CAA2BtD,QAA3B,EAAqCkB,GAArC,EAA0CC,GAA1C,EAA+CC,GAA/C,EAAoDC,GAApD,EAAyDC,GAAzD,EAA8DC,GAA9D,EAAmEC,GAAnE,EAAwEC,GAAxE,EAA6EK,WAA7E;IACA;;;;;;WAED,UAAgC9B,QAAhC,EAA+EkB,GAA/E,EAA4FC,GAA5F,EAAyGC,GAAzG,EAAsHC,GAAtH,EAAmIC,GAAnI,EAAgJC,GAAhJ,EAA6JC,GAA7J,EAA0KC,GAA1K,EAAuLK,WAAvL,EAA6N;MAC5N,IAAI5B,MAAM,GAAGF,QAAQ,CAACD,GAAT,CAAa,UAAb,CAAb;;MAEA,IAAIG,MAAJ,EAAY;QACX,IAAIqD,KAAG,GAAG,KAAKC,QAAL,CAActC,GAAd,EAAmBE,GAAnB,CAAV;QACA,IAAIqC,KAAG,GAAG,KAAKD,QAAL,CAAcrC,GAAd,EAAmBE,GAAnB,CAAV;QAEA,IAAIqC,KAAG,GAAG,KAAKF,QAAL,CAAclC,GAAd,EAAmBE,GAAnB,CAAV;QACA,IAAImC,KAAG,GAAG,KAAKH,QAAL,CAAcjC,GAAd,EAAmBE,GAAnB,CAAV;QAEA,IAAImC,GAAC,GAAG1D,MAAM,CAAC2D,CAAP,EAAR;QACA,IAAIC,GAAC,GAAG5D,MAAM,CAAC6D,CAAP,EAAR;QAEA7D,MAAM,CAAC8D,GAAP,CAAW,OAAX,EAAoBT,KAAG,CAACM,CAAJ,GAAQD,GAA5B;QACA1D,MAAM,CAAC8D,GAAP,CAAW,OAAX,EAAoBT,KAAG,CAACQ,CAAJ,GAAQD,GAA5B;QAEA5D,MAAM,CAAC8D,GAAP,CAAW,OAAX,EAAoBP,KAAG,CAACI,CAAJ,GAAQD,GAA5B;QACA1D,MAAM,CAAC8D,GAAP,CAAW,OAAX,EAAoBP,KAAG,CAACM,CAAJ,GAAQD,GAA5B;QAEA5D,MAAM,CAAC8D,GAAP,CAAW,QAAX,EAAqBN,KAAG,CAACG,CAAJ,GAAQD,GAA7B;QACA1D,MAAM,CAAC8D,GAAP,CAAW,QAAX,EAAqBN,KAAG,CAACK,CAAJ,GAAQD,GAA7B;QAEA5D,MAAM,CAAC8D,GAAP,CAAW,QAAX,EAAqBL,KAAG,CAACE,CAAJ,GAAQD,GAA7B;QACA1D,MAAM,CAAC8D,GAAP,CAAW,QAAX,EAAqBL,KAAG,CAACI,CAAJ,GAAQD,GAA7B;QAEA5D,MAAM,CAAC8D,GAAP,CAAW,aAAX,EAA0BlC,WAA1B;QAEA,IAAImC,aAAa,GAAGjE,QAAQ,CAACD,GAAT,CAAa,eAAb,CAApB;;QACA,IAAIkE,aAAJ,EAAmB;UAClB7E,MAAM,CAAC8E,IAAP,CAAYD,aAAZ,EAA2B,UAAC/D,MAAD,EAAY;YACtCA,MAAM,CAAC8D,GAAP,CAAW,OAAX,EAAoBT,KAAG,CAACM,CAAJ,GAAQD,GAA5B;YACA1D,MAAM,CAAC8D,GAAP,CAAW,OAAX,EAAoBT,KAAG,CAACQ,CAAJ,GAAQD,GAA5B;YAEA5D,MAAM,CAAC8D,GAAP,CAAW,OAAX,EAAoBP,KAAG,CAACI,CAAJ,GAAQD,GAA5B;YACA1D,MAAM,CAAC8D,GAAP,CAAW,OAAX,EAAoBP,KAAG,CAACM,CAAJ,GAAQD,GAA5B;YAEA5D,MAAM,CAAC8D,GAAP,CAAW,QAAX,EAAqBN,KAAG,CAACG,CAAJ,GAAQD,GAA7B;YACA1D,MAAM,CAAC8D,GAAP,CAAW,QAAX,EAAqBN,KAAG,CAACK,CAAJ,GAAQD,GAA7B;YAEA5D,MAAM,CAAC8D,GAAP,CAAW,QAAX,EAAqBL,KAAG,CAACE,CAAJ,GAAQD,GAA7B;YACA1D,MAAM,CAAC8D,GAAP,CAAW,QAAX,EAAqBL,KAAG,CAACI,CAAJ,GAAQD,GAA7B;YAEA5D,MAAM,CAAC8D,GAAP,CAAW,aAAX,EAA0BlC,WAA1B;UACA,CAdD;QAeA;MACD;IACD;;;;;;WAED,UAA4BqC,SAA5B,EAA6D;MAA7D;;MACC1D,iBAAM2D,iBAAN,CAAuBzD,IAAvB,CAAuB,IAAvB,EAAwBwD,SAAxB;;MACAA,SAAS,CAACtE,OAAV,GAAoB,IAAIX,YAAJ,CACnBD,QAAQ,CAACM,GAAT,CAAa,EAAb,CADmB,EAEnB;QAAM,kBAAW,CAACE,IAAZ,CAAiBC,KAAI,CAACC,KAAtB,EAA6B;UAClCH,SAAS,EAAEL,MAAM,CAACS,SAAP,CAAiBuE,SAAS,CAACtE,OAAV,CAAkBC,QAAlB,CAA2BC,GAA3B,CAA+B,WAA/B,EAA4C,EAA5C,CAAjB,EAAkE,CAAC,aAAD,EAAgB,QAAhB,EAA0B,QAA1B,CAAlE;QADuB,CAA7B,EAEH,CAACL,KAAI,CAACG,OAAL,CAAaC,QAAd,EAAwBqE,SAAS,CAACtE,OAAV,CAAkBC,QAA1C,CAFG;MAEiD,CAJpC,CAApB;IAMA;;EA7JDR;oBAAA;sBAAA;kBAAA;WAAkC;EAAlC;EACAA;oBAAA;sBAAA;kBAAA;WAA0CP,YAAY,CAACsF,UAAb,CAAwBC,MAAxB,CAA+B,CAACC,iBAAiB,CAACC,SAAnB,CAA/B;EAA1C;EA6JD;AAAC,CArKD,CAAuCzF,YAAvC;;SAAawF","names":["ColumnSeries","Candlestick","Template","ListTemplate","$utils","$array","__extends","Object","new","themeTags","_new","_this","_root","mergeTags","columns","template","get","dataItem","listTemplate","column","mainContainer","children","push","make","_setDataItem","previousDataItem","_super","_updateGraphics","call","xAxis","getRaw","yAxis","baseAxis","vcy","vcx","lx0","lx1","ly0","ly1","hx0","hx1","hy0","hy1","locationX","locationY","openLocationX","openLocationY","orientation","open_1","getDataItemPositionX","_xOpenField","close_1","_xField","_xLowField","_xHighField","Math","max","min","startLocation","_aLocationY0","endLocation","_aLocationY1","getDataItemPositionY","_yField","open_2","_yOpenField","close_2","_yLowField","_yHighField","_aLocationX0","_aLocationX1","_updateCandleGraphics","pl0_1","getPoint","pl1_1","ph0_1","ph1_1","x_1","x","y_1","y","set","rangeGraphics","each","axisRange","_processAxisRange","classNames","concat","CandlestickSeries","className"],"sourceRoot":"","sources":["../../../../../../src/.internal/charts/xy/series/CandlestickSeries.ts"],"sourcesContent":["import type { DataItem } from \"../../../core/render/Component\";\n\nimport { ColumnSeries, IColumnSeriesPrivate, IColumnSeriesSettings, IColumnSeriesDataItem, IColumnSeriesAxisRange } from \"./ColumnSeries\";\nimport { Candlestick } from \"./Candlestick\";\nimport { Template } from \"../../../core/util/Template\";\nimport { ListTemplate } from \"../../../core/util/List\";\n\nimport * as $utils from \"../../../core/util/Utils\";\nimport * as $array from \"../../../core/util/Array\";\n\nexport interface ICandlestickSeriesDataItem extends IColumnSeriesDataItem {\n}\n\nexport interface ICandlestickSeriesSettings extends IColumnSeriesSettings {\n}\n\nexport interface ICandlestickSeriesPrivate extends IColumnSeriesPrivate {\n}\n\nexport interface ICandlestickSeriesAxisRange extends IColumnSeriesAxisRange {\n\n\t/**\n\t * A list of [[Candlestick]] element in series.\n\t *\n\t * @readonly\n\t */\n\tcolumns: ListTemplate<Candlestick>\n\n}\n\n/**\n * Candlestick series.\n *\n * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/candlestick-series/} for more info\n * @important\n */\nexport class CandlestickSeries extends ColumnSeries {\n\n\tdeclare public _settings: ICandlestickSeriesSettings;\n\tdeclare public _privateSettings: ICandlestickSeriesPrivate;\n\tdeclare public _dataItemSettings: ICandlestickSeriesDataItem;\n\tdeclare public _axisRangeType: ICandlestickSeriesAxisRange;\n\n\tpublic static className: string = \"CandlestickSeries\";\n\tpublic static classNames: Array<string> = ColumnSeries.classNames.concat([CandlestickSeries.className]);\n\n\t/**\n\t * @ignore\n\t */\n\tpublic makeColumn(dataItem: DataItem<this[\"_dataItemSettings\"]>, listTemplate: ListTemplate<Candlestick>): Candlestick {\n\t\tconst column = this.mainContainer.children.push(listTemplate.make());\n\t\tcolumn._setDataItem(dataItem);\n\t\tlistTemplate.push(column);\n\t\treturn column;\n\t}\n\n\t/**\n\t * A list of candles in the series.\n\t *\n\t * `columns.template` can be used to configure candles.\n\t *\n\t * @default new ListTemplate<Candlestick>\n\t */\n\tpublic readonly columns: ListTemplate<Candlestick> = new ListTemplate(\n\t\tTemplate.new({\n\t\t\tthemeTags: [\"autocolor\"]\n\t\t}),\n\t\t() => Candlestick._new(this._root, {\n\t\t\tthemeTags: $utils.mergeTags(this.columns.template.get(\"themeTags\", []), [\"candlestick\", \"series\", \"column\"])\n\t\t}, [this.columns.template])\n\t);\n\n\tprotected _updateGraphics(dataItem: DataItem<this[\"_dataItemSettings\"]>, previousDataItem: DataItem<this[\"_dataItemSettings\"]>) {\n\t\tsuper._updateGraphics(dataItem, previousDataItem);\n\n\t\tconst xAxis = this.getRaw(\"xAxis\");\n\t\tconst yAxis = this.getRaw(\"yAxis\");\n\t\tconst baseAxis = this.getRaw(\"baseAxis\");\n\n\t\tlet vcy = this.get(\"vcy\", 1);\n\t\tlet vcx = this.get(\"vcx\", 1);\n\n\t\tlet lx0: number;\n\t\tlet lx1: number;\n\t\tlet ly0: number;\n\t\tlet ly1: number;\n\n\t\tlet hx0: number;\n\t\tlet hx1: number;\n\t\tlet hy0: number;\n\t\tlet hy1: number;\n\n\t\tlet locationX = this.get(\"locationX\", dataItem.get(\"locationX\", 0.5));\n\t\tlet locationY = this.get(\"locationY\", dataItem.get(\"locationY\", 0.5));\n\n\t\tlet openLocationX = this.get(\"openLocationX\", dataItem.get(\"openLocationX\", locationX));\n\t\tlet openLocationY = this.get(\"openLocationY\", dataItem.get(\"openLocationY\", locationY));\n\n\t\tlet orientation: \"horizontal\" | \"vertical\";\n\n\t\tif (yAxis === baseAxis) {\n\t\t\tlet open = xAxis.getDataItemPositionX(dataItem, this._xOpenField, 1, vcx);\n\t\t\tlet close = xAxis.getDataItemPositionX(dataItem, this._xField, 1, vcx);\n\n\t\t\tlx1 = xAxis.getDataItemPositionX(dataItem, this._xLowField, 1, vcx);\n\t\t\thx1 = xAxis.getDataItemPositionX(dataItem, this._xHighField, 1, vcx);\n\n\t\t\thx0 = Math.max(open, close);\n\t\t\tlx0 = Math.min(open, close);\n\n\t\t\tlet startLocation = this._aLocationY0 + openLocationY - 0.5;\n\t\t\tlet endLocation = this._aLocationY1 + locationY - 0.5;\n\n\t\t\tly0 = yAxis.getDataItemPositionY(dataItem, this._yField, startLocation + (endLocation - startLocation) / 2, vcy);\n\t\t\tly1 = ly0;\n\t\t\thy0 = ly0;\n\t\t\thy1 = ly0;\n\n\t\t\torientation = \"horizontal\";\n\t\t}\n\t\telse {\n\t\t\tlet open = yAxis.getDataItemPositionY(dataItem, this._yOpenField, 1, vcy);\n\t\t\tlet close = yAxis.getDataItemPositionY(dataItem, this._yField, 1, vcy);\n\n\t\t\tly1 = yAxis.getDataItemPositionY(dataItem, this._yLowField, 1, vcy);\n\t\t\thy1 = yAxis.getDataItemPositionY(dataItem, this._yHighField, 1, vcy);\n\n\t\t\thy0 = Math.max(open, close);\n\t\t\tly0 = Math.min(open, close);\n\n\t\t\tlet startLocation = this._aLocationX0 + openLocationX - 0.5;\n\t\t\tlet endLocation = this._aLocationX1 + locationX - 0.5;\n\n\t\t\tlx0 = xAxis.getDataItemPositionX(dataItem, this._xField, startLocation + (endLocation - startLocation) / 2, vcx);\n\t\t\tlx1 = lx0;\n\t\t\thx0 = lx0;\n\t\t\thx1 = lx0;\n\n\t\t\torientation = \"vertical\";\n\t\t}\n\n\t\tthis._updateCandleGraphics(dataItem, lx0, lx1, ly0, ly1, hx0, hx1, hy0, hy1, orientation)\n\t}\n\n\tprotected _updateCandleGraphics(dataItem: DataItem<this[\"_dataItemSettings\"]>, lx0: number, lx1: number, ly0: number, ly1: number, hx0: number, hx1: number, hy0: number, hy1: number, orientation: \"horizontal\" | \"vertical\") {\n\t\tlet column = dataItem.get(\"graphics\") as Candlestick;\n\n\t\tif (column) {\n\t\t\tlet pl0 = this.getPoint(lx0, ly0);\n\t\t\tlet pl1 = this.getPoint(lx1, ly1);\n\n\t\t\tlet ph0 = this.getPoint(hx0, hy0);\n\t\t\tlet ph1 = this.getPoint(hx1, hy1);\n\n\t\t\tlet x = column.x();\n\t\t\tlet y = column.y();\n\n\t\t\tcolumn.set(\"lowX0\", pl0.x - x);\n\t\t\tcolumn.set(\"lowY0\", pl0.y - y);\n\n\t\t\tcolumn.set(\"lowX1\", pl1.x - x);\n\t\t\tcolumn.set(\"lowY1\", pl1.y - y);\n\n\t\t\tcolumn.set(\"highX0\", ph0.x - x);\n\t\t\tcolumn.set(\"highY0\", ph0.y - y);\n\n\t\t\tcolumn.set(\"highX1\", ph1.x - x);\n\t\t\tcolumn.set(\"highY1\", ph1.y - y);\n\n\t\t\tcolumn.set(\"orientation\", orientation);\n\n\t\t\tlet rangeGraphics = dataItem.get(\"rangeGraphics\")!;\n\t\t\tif (rangeGraphics) {\n\t\t\t\t$array.each(rangeGraphics, (column: any) => {\n\t\t\t\t\tcolumn.set(\"lowX0\", pl0.x - x);\n\t\t\t\t\tcolumn.set(\"lowY0\", pl0.y - y);\n\n\t\t\t\t\tcolumn.set(\"lowX1\", pl1.x - x);\n\t\t\t\t\tcolumn.set(\"lowY1\", pl1.y - y);\n\n\t\t\t\t\tcolumn.set(\"highX0\", ph0.x - x);\n\t\t\t\t\tcolumn.set(\"highY0\", ph0.y - y);\n\n\t\t\t\t\tcolumn.set(\"highX1\", ph1.x - x);\n\t\t\t\t\tcolumn.set(\"highY1\", ph1.y - y);\n\n\t\t\t\t\tcolumn.set(\"orientation\", orientation);\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _processAxisRange(axisRange: this[\"_axisRangeType\"]) {\n\t\tsuper._processAxisRange(axisRange);\n\t\taxisRange.columns = new ListTemplate(\n\t\t\tTemplate.new({}),\n\t\t\t() => Candlestick._new(this._root, {\n\t\t\t\tthemeTags: $utils.mergeTags(axisRange.columns.template.get(\"themeTags\", []), [\"candlestick\", \"series\", \"column\"]),\n\t\t\t}, [this.columns.template, axisRange.columns.template])\n\t\t);\n\t}\n}\n"]},"metadata":{},"sourceType":"module"}