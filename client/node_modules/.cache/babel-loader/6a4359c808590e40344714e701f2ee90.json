{"ast":null,"code":"import { __extends } from \"tslib\";\nimport { Children } from \"../util/Children\";\nimport { Percent } from \"../util/Percent\";\nimport { Sprite } from \"./Sprite\";\nimport { Rectangle } from \"./Rectangle\";\nimport { HorizontalLayout } from \"./HorizontalLayout\";\nimport { VerticalLayout } from \"./VerticalLayout\";\nimport { GridLayout } from \"./GridLayout\";\nimport * as $array from \"../util/Array\";\nimport * as $type from \"../util/Type\";\n/**\r\n * A basic element that can have child elements, maintain their layout, and\r\n * have a background.\r\n *\r\n * It can have any [[Sprite]] element as a child, from very basic shapes, to\r\n * full-fledged charts.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/concepts/common-elements/containers/} for more info\r\n * @important\r\n */\n\nvar Container =\n/** @class */\nfunction (_super) {\n  __extends(Container, _super);\n\n  function Container() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    Object.defineProperty(_this, \"_display\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: _this._root._renderer.makeContainer()\n    });\n    Object.defineProperty(_this, \"_childrenDisplay\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: _this._root._renderer.makeContainer()\n    });\n    /**\r\n     * List of Container's child elements.\r\n     */\n\n    Object.defineProperty(_this, \"children\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: new Children(_this)\n    });\n    Object.defineProperty(_this, \"_percentageSizeChildren\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: []\n    });\n    Object.defineProperty(_this, \"_percentagePositionChildren\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: []\n    });\n    Object.defineProperty(_this, \"_prevWidth\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: 0\n    });\n    Object.defineProperty(_this, \"_prevHeight\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: 0\n    });\n    Object.defineProperty(_this, \"_contentWidth\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: 0\n    });\n    Object.defineProperty(_this, \"_contentHeight\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: 0\n    });\n    Object.defineProperty(_this, \"_contentMask\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    return _this;\n  }\n\n  Object.defineProperty(Container.prototype, \"_afterNew\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      _super.prototype._afterNew.call(this);\n\n      this._display.addChild(this._childrenDisplay);\n    }\n  });\n  Object.defineProperty(Container.prototype, \"_dispose\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      $array.eachReverse(this.allChildren(), function (child) {\n        child.dispose();\n      });\n\n      _super.prototype._dispose.call(this);\n    }\n  });\n  Object.defineProperty(Container.prototype, \"_changed\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      _super.prototype._changed.call(this);\n\n      if (this.isDirty(\"interactiveChildren\")) {\n        this._display.interactiveChildren = this.get(\"interactiveChildren\", false);\n      }\n\n      if (this.isDirty(\"layout\")) {\n        this._prevWidth = 0;\n        this._prevHeight = 0;\n        this.markDirtyBounds();\n\n        if (this._prevSettings.layout) {\n          this.children.each(function (child) {\n            child.removePrivate(\"x\");\n            child.removePrivate(\"y\");\n          });\n        }\n      }\n\n      if (this.isDirty(\"paddingTop\") || this.isDirty(\"paddingBottom\") || this.isDirty(\"paddingLeft\") || this.isDirty(\"paddingRight\")) {\n        this.children.each(function (child) {\n          child.markDirtyPosition();\n        });\n      }\n\n      if (this.isDirty(\"maskContent\")) {\n        var childrenDisplay = this._childrenDisplay;\n        var contentMask = this._contentMask;\n\n        if (this.get(\"maskContent\")) {\n          if (!contentMask) {\n            contentMask = Rectangle.new(this._root, {\n              width: this.width(),\n              height: this.height()\n            });\n            this._contentMask = contentMask;\n            childrenDisplay.addChildAt(contentMask._display, 0);\n            childrenDisplay.mask = contentMask._display;\n          }\n        } else {\n          if (contentMask) {\n            childrenDisplay.removeChild(contentMask._display);\n            childrenDisplay.mask = null;\n            contentMask.dispose();\n          }\n        }\n      }\n    }\n  });\n  Object.defineProperty(Container.prototype, \"_updateSize\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      _super.prototype._updateSize.call(this);\n\n      $array.each(this._percentageSizeChildren, function (child) {\n        child._updateSize();\n      });\n      $array.each(this._percentagePositionChildren, function (child) {\n        child.markDirtyPosition();\n\n        child._updateSize();\n      });\n      this.updateBackground();\n    }\n  });\n  Object.defineProperty(Container.prototype, \"updateBackground\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var background = this.get(\"background\");\n      var bounds = this._localBounds;\n\n      if (bounds && !this.isHidden()) {\n        var x = bounds.left;\n        var y = bounds.top;\n        var w = bounds.right - x;\n        var h = bounds.bottom - y;\n        var width = this.width();\n        var height = this.height();\n\n        if (background) {\n          background.setAll({\n            width: w,\n            height: h,\n            x: x,\n            y: y\n          });\n\n          if (this._display.interactive) {\n            background._display.interactive = true;\n          }\n        }\n\n        var contentMask = this._contentMask;\n\n        if (contentMask) {\n          contentMask.setAll({\n            width: width,\n            height: height\n          });\n        }\n\n        var verticalScrollbar = this.get(\"verticalScrollbar\");\n\n        if (verticalScrollbar) {\n          verticalScrollbar.set(\"height\", height);\n          verticalScrollbar.set(\"x\", width - verticalScrollbar.width() - verticalScrollbar.get(\"marginRight\", 0));\n          verticalScrollbar.set(\"end\", verticalScrollbar.get(\"start\", 0) + height / this._contentHeight);\n          var bg = verticalScrollbar.get(\"background\");\n\n          if (bg) {\n            bg.setAll({\n              width: verticalScrollbar.width(),\n              height: height\n            });\n          }\n\n          var visible = true;\n\n          if (this._contentHeight <= height) {\n            visible = false;\n          }\n\n          verticalScrollbar.setPrivate(\"visible\", visible);\n        }\n      }\n    }\n  });\n  Object.defineProperty(Container.prototype, \"_applyThemes\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      if (_super.prototype._applyThemes.call(this)) {\n        this.eachChildren(function (child) {\n          child._applyThemes();\n        });\n        return true;\n      } else {\n        return false;\n      }\n    }\n  });\n  Object.defineProperty(Container.prototype, \"_applyState\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (name) {\n      _super.prototype._applyState.call(this, name);\n\n      if (this.get(\"setStateOnChildren\")) {\n        this.eachChildren(function (child) {\n          child.states.apply(name);\n        });\n      }\n    }\n  });\n  Object.defineProperty(Container.prototype, \"_applyStateAnimated\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (name, duration) {\n      _super.prototype._applyStateAnimated.call(this, name, duration);\n\n      if (this.get(\"setStateOnChildren\")) {\n        this.eachChildren(function (child) {\n          child.states.applyAnimate(name, duration);\n        });\n      }\n    }\n  });\n  /**\r\n   * Returns container's inner width (width without padding) in pixels.\r\n   *\r\n   * @return Inner width (px)\r\n   */\n\n  Object.defineProperty(Container.prototype, \"innerWidth\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      return this.width() - this.get(\"paddingRight\", 0) - this.get(\"paddingLeft\", 0);\n    }\n  });\n  /**\r\n   * Returns container's inner height (height without padding) in pixels.\r\n   *\r\n   * @return Inner height (px)\r\n   */\n\n  Object.defineProperty(Container.prototype, \"innerHeight\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      return this.height() - this.get(\"paddingTop\", 0) - this.get(\"paddingBottom\", 0);\n    }\n  });\n  Object.defineProperty(Container.prototype, \"_getBounds\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var width = this.get(\"width\");\n      var height = this.get(\"height\");\n      var pWidth = this.getPrivate(\"width\");\n      var pHeight = this.getPrivate(\"height\");\n      var bounds = {\n        left: 0,\n        top: 0,\n        right: this.width(),\n        bottom: this.height()\n      };\n      var layout = this.get(\"layout\");\n      var horizontal = false;\n      var vertical = false;\n\n      if (layout instanceof HorizontalLayout || layout instanceof GridLayout) {\n        horizontal = true;\n      }\n\n      if (layout instanceof VerticalLayout) {\n        vertical = true;\n      }\n\n      if ((width != null || pWidth != null) && (height != null || pHeight != null) && !this.get(\"verticalScrollbar\")) {// void\n      } else {\n        var m = Number.MAX_VALUE;\n        var l_1 = m;\n        var r_1 = -m;\n        var t_1 = m;\n        var b_1 = -m;\n        var paddingLeft = this.get(\"paddingLeft\", 0);\n        var paddingTop = this.get(\"paddingTop\", 0);\n        var paddingRight = this.get(\"paddingRight\", 0);\n        var paddingBottom = this.get(\"paddingBottom\", 0);\n        this.children.each(function (child) {\n          if (child.get(\"position\") != \"absolute\" && child.get(\"isMeasured\")) {\n            var childBounds = child.adjustedLocalBounds();\n            var childX = child.x();\n            var childY = child.y();\n            var cl = childX + childBounds.left;\n            var cr = childX + childBounds.right;\n            var ct = childY + childBounds.top;\n            var cb = childY + childBounds.bottom;\n\n            if (horizontal) {\n              cl -= child.get(\"marginLeft\", 0);\n              cr += child.get(\"marginRight\", 0);\n            }\n\n            if (vertical) {\n              ct -= child.get(\"marginTop\", 0);\n              cb += child.get(\"marginBottom\", 0);\n            }\n\n            if (cl < l_1) {\n              l_1 = cl;\n            }\n\n            if (cr > r_1) {\n              r_1 = cr;\n            }\n\n            if (ct < t_1) {\n              t_1 = ct;\n            }\n\n            if (cb > b_1) {\n              b_1 = cb;\n            }\n          }\n        });\n\n        if (l_1 == m) {\n          l_1 = 0;\n        }\n\n        if (r_1 == -m) {\n          r_1 = 0;\n        }\n\n        if (t_1 == m) {\n          t_1 = 0;\n        }\n\n        if (b_1 == -m) {\n          b_1 = 0;\n        }\n\n        bounds.left = l_1 - paddingLeft;\n        bounds.top = t_1 - paddingTop;\n        bounds.right = r_1 + paddingRight;\n        bounds.bottom = b_1 + paddingBottom;\n      }\n\n      this._contentWidth = bounds.right - bounds.left;\n      this._contentHeight = bounds.bottom - bounds.top;\n\n      if ($type.isNumber(width)) {\n        bounds.left = 0;\n        bounds.right = width;\n      }\n\n      if ($type.isNumber(pWidth)) {\n        bounds.left = 0;\n        bounds.right = pWidth;\n      }\n\n      if ($type.isNumber(height)) {\n        bounds.top = 0;\n        bounds.bottom = height;\n      }\n\n      if ($type.isNumber(pHeight)) {\n        bounds.top = 0;\n        bounds.bottom = pHeight;\n      }\n\n      this._localBounds = bounds;\n    }\n  });\n  Object.defineProperty(Container.prototype, \"_updateBounds\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var layout = this.get(\"layout\");\n\n      if (layout) {\n        layout.updateContainer(this);\n      }\n\n      _super.prototype._updateBounds.call(this);\n\n      this.updateBackground();\n    }\n  });\n  /**\r\n   * @ignore\r\n   */\n\n  Object.defineProperty(Container.prototype, \"markDirty\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      _super.prototype.markDirty.call(this);\n\n      this._root._addDirtyParent(this);\n    }\n  });\n  Object.defineProperty(Container.prototype, \"_prepareChildren\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var innerWidth = this.innerWidth();\n      var innerHeight = this.innerHeight();\n\n      if (innerWidth != this._prevWidth || innerHeight != this._prevHeight) {\n        var layout = this.get(\"layout\");\n        var horizontal_1 = false;\n        var vertical_1 = false;\n\n        if (layout) {\n          if (layout instanceof HorizontalLayout || layout instanceof GridLayout) {\n            horizontal_1 = true;\n          }\n\n          if (layout instanceof VerticalLayout) {\n            vertical_1 = true;\n          }\n        }\n\n        $array.each(this._percentageSizeChildren, function (child) {\n          if (!horizontal_1) {\n            var width = child.get(\"width\");\n\n            if (width instanceof Percent) {\n              child.setPrivate(\"width\", width.value * innerWidth);\n            }\n          }\n\n          if (!vertical_1) {\n            var height = child.get(\"height\");\n\n            if (height instanceof Percent) {\n              child.setPrivate(\"height\", height.value * innerHeight);\n            }\n          }\n        });\n        $array.each(this._percentagePositionChildren, function (child) {\n          child.markDirtyPosition();\n          child.markDirtyBounds();\n        });\n        this._prevWidth = innerWidth;\n        this._prevHeight = innerHeight;\n        this._sizeDirty = true;\n        this.updateBackground();\n      }\n\n      this._handleStates();\n    }\n  });\n  Object.defineProperty(Container.prototype, \"_updateChildren\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var _this = this;\n\n      if (this.isDirty(\"verticalScrollbar\")) {\n        var verticalScrollbar_1 = this.get(\"verticalScrollbar\");\n\n        if (verticalScrollbar_1) {\n          verticalScrollbar_1._setParent(this);\n\n          verticalScrollbar_1.children.removeValue(verticalScrollbar_1.startGrip);\n          verticalScrollbar_1.children.removeValue(verticalScrollbar_1.endGrip);\n          this.set(\"maskContent\", true);\n          this.set(\"paddingRight\", verticalScrollbar_1.width() + verticalScrollbar_1.get(\"marginRight\", 0) + verticalScrollbar_1.get(\"marginLeft\", 0));\n          var background = this.get(\"background\");\n\n          if (!background) {\n            background = this.set(\"background\", Rectangle.new(this._root, {\n              themeTags: [\"background\"],\n              fillOpacity: 0,\n              fill: this._root.interfaceColors.get(\"alternativeBackground\")\n            }));\n          }\n\n          this._disposers.push(this.events.on(\"wheel\", function (event) {\n            var wheelEvent = event.originalEvent;\n            wheelEvent.preventDefault();\n            var shiftY = wheelEvent.deltaY / 5000;\n            var start = verticalScrollbar_1.get(\"start\", 0);\n            var end = verticalScrollbar_1.get(\"end\", 1);\n\n            if (start + shiftY > 0 && end + shiftY < 1) {\n              verticalScrollbar_1.set(\"start\", start + shiftY);\n              verticalScrollbar_1.set(\"end\", end + shiftY);\n            }\n          }));\n\n          this._disposers.push(verticalScrollbar_1.events.on(\"rangechanged\", function () {\n            var h = _this._contentHeight;\n            var childrenDisplay = _this._childrenDisplay;\n            var contentMask = _this._contentMask;\n            childrenDisplay.y = -verticalScrollbar_1.get(\"start\") * h;\n            childrenDisplay.markDirtyLayer();\n\n            if (contentMask) {\n              contentMask._display.y = -childrenDisplay.y;\n              childrenDisplay.mask = contentMask._display;\n            }\n          }));\n\n          this._display.addChild(verticalScrollbar_1._display);\n        }\n      }\n\n      if (this.isDirty(\"background\")) {\n        // TODO maybe this should dispose ?\n        var previous = this._prevSettings[\"background\"];\n\n        if (previous) {\n          this._display.removeChild(previous._display);\n        }\n\n        var background = this.get(\"background\");\n\n        if (background instanceof Sprite) {\n          background.set(\"isMeasured\", false);\n\n          background._setParent(this);\n\n          this._display.addChildAt(background._display, 0);\n        }\n      }\n\n      if (this.isDirty(\"mask\")) {\n        var mask = this.get(\"mask\");\n        var previous = this._prevSettings[\"mask\"];\n\n        if (previous) {\n          this._display.removeChild(previous._display);\n\n          if (previous != mask) {\n            previous.dispose();\n          }\n        }\n\n        if (mask) {\n          var parent = mask.parent;\n\n          if (parent) {\n            parent.children.removeValue(mask);\n          }\n\n          mask._setParent(this);\n\n          this._display.addChildAt(mask._display, 0);\n\n          this._childrenDisplay.mask = mask._display;\n        }\n      }\n    }\n  });\n  Object.defineProperty(Container.prototype, \"_processTemplateField\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      _super.prototype._processTemplateField.call(this);\n\n      this.children.each(function (child) {\n        child._processTemplateField();\n      });\n    }\n  });\n  /**\r\n   * @ignore\r\n   */\n\n  Object.defineProperty(Container.prototype, \"walkChildren\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (f) {\n      this.children.each(function (child) {\n        if (child instanceof Container) {\n          child.walkChildren(f);\n        }\n\n        f(child);\n      });\n    }\n  });\n  Object.defineProperty(Container.prototype, \"eachChildren\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (f) {\n      var background = this.get(\"background\");\n\n      if (background) {\n        f(background);\n      }\n\n      var verticalScrollbar = this.get(\"verticalScrollbar\");\n\n      if (verticalScrollbar) {\n        f(verticalScrollbar);\n      }\n\n      var mask = this.get(\"mask\");\n\n      if (mask) {\n        f(mask);\n      }\n\n      this.children.values.forEach(function (child) {\n        f(child);\n      });\n    }\n  });\n  Object.defineProperty(Container.prototype, \"allChildren\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var output = [];\n      this.eachChildren(function (x) {\n        output.push(x);\n      });\n      return output;\n    }\n  });\n  Object.defineProperty(Container, \"className\", {\n    enumerable: true,\n    configurable: true,\n    writable: true,\n    value: \"Container\"\n  });\n  Object.defineProperty(Container, \"classNames\", {\n    enumerable: true,\n    configurable: true,\n    writable: true,\n    value: Sprite.classNames.concat([Container.className])\n  });\n  return Container;\n}(Sprite);\n\nexport { Container };","map":{"version":3,"mappings":"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","names":["Children","Percent","Sprite","Rectangle","HorizontalLayout","VerticalLayout","GridLayout","$array","$type","__extends","Object","_this","_root","_renderer","makeContainer","_super","_afterNew","call","_display","addChild","_childrenDisplay","eachReverse","allChildren","child","dispose","_dispose","_changed","isDirty","interactiveChildren","get","_prevWidth","_prevHeight","markDirtyBounds","_prevSettings","layout","children","each","removePrivate","markDirtyPosition","childrenDisplay","contentMask","_contentMask","new","width","height","addChildAt","mask","removeChild","_updateSize","_percentageSizeChildren","_percentagePositionChildren","updateBackground","background","bounds","_localBounds","isHidden","x","left","y","top","w","right","h","bottom","setAll","interactive","verticalScrollbar","set","_contentHeight","bg","visible","setPrivate","_applyThemes","eachChildren","name","_applyState","states","apply","duration","_applyStateAnimated","applyAnimate","pWidth","getPrivate","pHeight","horizontal","vertical","m","Number","MAX_VALUE","l_1","r_1","t_1","b_1","paddingLeft","paddingTop","paddingRight","paddingBottom","childBounds","adjustedLocalBounds","childX","childY","cl","cr","ct","cb","_contentWidth","isNumber","updateContainer","_updateBounds","markDirty","_addDirtyParent","innerWidth","innerHeight","horizontal_1","vertical_1","value","_sizeDirty","_handleStates","verticalScrollbar_1","_setParent","removeValue","startGrip","endGrip","themeTags","fillOpacity","fill","interfaceColors","_disposers","push","events","on","event","wheelEvent","originalEvent","preventDefault","shiftY","deltaY","start","end","markDirtyLayer","previous","parent","_processTemplateField","f","Container","walkChildren","values","forEach","output","classNames","concat","className"],"sourceRoot":"","sources":["../../../../../src/.internal/core/render/Container.ts"],"sourcesContent":["import type { Graphics } from \"./Graphics\";\nimport type { Layout } from \"./Layout\";\nimport type { IContainer } from \"./backend/Renderer\";\nimport type { IBounds } from \"../util/IBounds\";\nimport type { Scrollbar } from \"./Scrollbar\";\n\nimport { Children } from \"../util/Children\";\nimport { Percent } from \"../util/Percent\";\nimport { Sprite, ISpriteSettings, ISpritePrivate, ISpriteEvents } from \"./Sprite\";\nimport { Rectangle } from \"./Rectangle\";\nimport { HorizontalLayout } from \"./HorizontalLayout\";\nimport { VerticalLayout } from \"./VerticalLayout\";\nimport { GridLayout } from \"./GridLayout\";\n\nimport * as $array from \"../util/Array\";\nimport * as $type from \"../util/Type\";\n\nexport interface IContainerSettings extends ISpriteSettings {\n\n\t/**\n\t * Left padding in pixels.\n\t */\n\tpaddingLeft?: number;\n\n\t/**\n\t * Right padding in pixels.\n\t */\n\tpaddingRight?: number;\n\n\t/**\n\t * Top padding in pixels.\n\t */\n\tpaddingTop?: number;\n\n\t/**\n\t * Bottom padding in pixels.\n\t */\n\tpaddingBottom?: number;\n\n\t/**\n\t * Background element.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/containers/#Background} for more info\n\t */\n\tbackground?: Graphics;\n\n\t/**\n\t * A method to layout\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/containers/#Layout} for more info\n\t */\n\tlayout?: Layout | null;\n\n\t/**\n\t * An element to use as a container's mask (clipping region).\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/containers/#Masks} for more info\n\t */\n\tmask?: Graphics | null;\n\n\t/**\n\t * If set to `true` all content going outside the bounds of the container\n\t * will be clipped.\n\t */\n\tmaskContent?: boolean;\n\n\t/**\n\t * If set to `true` all descendants - not just direct children, but every\n\t * element in it - will become \"interactive\".\n\t */\n\tinteractiveChildren?: boolean;\n\n\t/**\n\t * If set to `true`, applying a state on a container will also apply the same\n\t * state on its children.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/containers/#States} for more info\n\t */\n\tsetStateOnChildren?: boolean;\n\n\t/**\n\t * Setting this to an instance of [[Scrollbar]] will enable vertical\n\t * scrolling of content if it does not fit into the Container.\n\t * \n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/containers/#Scrollbar} for more info\n\t */\n\tverticalScrollbar?: Scrollbar;\n\n\t/**\n\t * If set to `true` its children will be laid out in opposite order.\n\t *\n\t * @since 5.1.1\n\t */\n\treverseChildren?: boolean;\n\n}\n\nexport interface IContainerEvents extends ISpriteEvents {\n}\n\nexport interface IContainerPrivate extends ISpritePrivate {\n}\n\nexport interface IContainerEvents extends ISpriteEvents {\n}\n\n/**\n * A basic element that can have child elements, maintain their layout, and\n * have a background.\n *\n * It can have any [[Sprite]] element as a child, from very basic shapes, to\n * full-fledged charts.\n *\n * @see {@link https://www.amcharts.com/docs/v5/concepts/common-elements/containers/} for more info\n * @important\n */\nexport class Container extends Sprite {\n\n\tdeclare public _settings: IContainerSettings;\n\tdeclare public _privateSettings: IContainerPrivate;\n\tdeclare public _events: IContainerEvents;\n\n\tpublic _display: IContainer = this._root._renderer.makeContainer();\n\n\tpublic _childrenDisplay: IContainer = this._root._renderer.makeContainer();\n\n\t/**\n\t * List of Container's child elements.\n\t */\n\tpublic children: Children<Sprite> = new Children(this);\n\n\tpublic _percentageSizeChildren: Array<Sprite> = [];\n\tpublic _percentagePositionChildren: Array<Sprite> = [];\n\n\tpublic static className: string = \"Container\";\n\tpublic static classNames: Array<string> = Sprite.classNames.concat([Container.className]);\n\n\tpublic _prevWidth: number = 0;\n\tpublic _prevHeight: number = 0;\n\n\tprotected _contentWidth: number = 0;\n\tprotected _contentHeight: number = 0;\n\n\tprotected _contentMask: Rectangle | undefined;\n\n\tprotected _afterNew() {\n\t\tsuper._afterNew();\n\t\tthis._display.addChild(this._childrenDisplay);\n\t}\n\n\tprotected _dispose() {\n\t\t$array.eachReverse(this.allChildren(), (child) => {\n\t\t\tchild.dispose();\n\t\t});\n\n\t\tsuper._dispose();\n\t}\n\n\tpublic _changed() {\n\t\tsuper._changed();\n\n\t\tif (this.isDirty(\"interactiveChildren\")) {\n\t\t\tthis._display.interactiveChildren = this.get(\"interactiveChildren\", false);\n\t\t}\n\n\t\tif (this.isDirty(\"layout\")) {\n\t\t\tthis._prevWidth = 0;\n\t\t\tthis._prevHeight = 0;\n\t\t\tthis.markDirtyBounds();\n\t\t\tif (this._prevSettings.layout) {\n\t\t\t\tthis.children.each((child) => {\n\t\t\t\t\tchild.removePrivate(\"x\");\n\t\t\t\t\tchild.removePrivate(\"y\");\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDirty(\"paddingTop\") || this.isDirty(\"paddingBottom\") || this.isDirty(\"paddingLeft\") || this.isDirty(\"paddingRight\")) {\n\t\t\tthis.children.each((child) => {\n\t\t\t\tchild.markDirtyPosition();\n\t\t\t})\n\t\t}\n\n\t\tif (this.isDirty(\"maskContent\")) {\n\n\t\t\tconst childrenDisplay = this._childrenDisplay;\n\n\t\t\tlet contentMask = this._contentMask;\n\t\t\tif (this.get(\"maskContent\")) {\n\t\t\t\tif (!contentMask) {\n\t\t\t\t\tcontentMask = Rectangle.new(this._root, {\n\t\t\t\t\t\twidth: this.width(),\n\t\t\t\t\t\theight: this.height()\n\t\t\t\t\t});\n\t\t\t\t\tthis._contentMask = contentMask;\n\t\t\t\t\tchildrenDisplay.addChildAt(contentMask._display, 0);\n\t\t\t\t\tchildrenDisplay.mask = contentMask._display;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (contentMask) {\n\t\t\t\t\tchildrenDisplay.removeChild(contentMask._display);\n\t\t\t\t\tchildrenDisplay.mask = null;\n\t\t\t\t\tcontentMask.dispose();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _updateSize() {\n\t\tsuper._updateSize();\n\n\t\t$array.each(this._percentageSizeChildren, (child) => {\n\t\t\tchild._updateSize();\n\t\t});\n\n\t\t$array.each(this._percentagePositionChildren, (child) => {\n\t\t\tchild.markDirtyPosition();\n\t\t\tchild._updateSize();\n\t\t});\n\n\t\tthis.updateBackground();\n\t}\n\n\tprotected updateBackground() {\n\t\tconst background = this.get(\"background\");\n\t\tlet bounds = this._localBounds;\n\n\t\tif (bounds && !this.isHidden()) {\n\t\t\tlet x = bounds.left;\n\t\t\tlet y = bounds.top;\n\t\t\tlet w = bounds.right - x;\n\t\t\tlet h = bounds.bottom - y;\n\n\t\t\tlet width = this.width();\n\t\t\tlet height = this.height();\n\n\t\t\tif (background) {\n\t\t\t\tbackground.setAll({ width: w, height: h, x: x, y: y });\n\t\t\t\tif (this._display.interactive) {\n\t\t\t\t\tbackground._display.interactive = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst contentMask = this._contentMask;\n\t\t\tif (contentMask) {\n\t\t\t\tcontentMask.setAll({ width, height });\n\t\t\t}\n\n\t\t\tconst verticalScrollbar = this.get(\"verticalScrollbar\")!;\n\t\t\tif (verticalScrollbar) {\n\t\t\t\tverticalScrollbar.set(\"height\", height);\n\t\t\t\tverticalScrollbar.set(\"x\", width - verticalScrollbar.width() - verticalScrollbar.get(\"marginRight\", 0));\n\t\t\t\tverticalScrollbar.set(\"end\", verticalScrollbar.get(\"start\", 0) + height / this._contentHeight);\n\n\t\t\t\tconst bg = verticalScrollbar.get(\"background\");\n\t\t\t\tif (bg) {\n\t\t\t\t\tbg.setAll({ width: verticalScrollbar.width(), height: height })\n\t\t\t\t}\n\n\t\t\t\tlet visible = true;\n\t\t\t\tif(this._contentHeight <= height){\n\t\t\t\t\tvisible = false;\n\t\t\t\t}\n\t\t\t\tverticalScrollbar.setPrivate(\"visible\", visible);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _applyThemes(): boolean {\n\t\tif (super._applyThemes()) {\n\t\t\tthis.eachChildren((child) => {\n\t\t\t\tchild._applyThemes();\n\t\t\t});\n\n\t\t\treturn true;\n\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tpublic _applyState(name: string): void {\n\t\tsuper._applyState(name);\n\n\t\tif (this.get(\"setStateOnChildren\")) {\n\t\t\tthis.eachChildren((child) => {\n\t\t\t\tchild.states.apply(name);\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic _applyStateAnimated(name: string, duration?: number): void {\n\t\tsuper._applyStateAnimated(name, duration);\n\n\t\tif (this.get(\"setStateOnChildren\")) {\n\t\t\tthis.eachChildren((child) => {\n\t\t\t\tchild.states.applyAnimate(name, duration);\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Returns container's inner width (width without padding) in pixels.\n\t *\n\t * @return Inner width (px)\n\t */\n\tpublic innerWidth(): number {\n\t\treturn this.width() - this.get(\"paddingRight\", 0) - this.get(\"paddingLeft\", 0);\n\t}\n\n\t/**\n\t * Returns container's inner height (height without padding) in pixels.\n\t *\n\t * @return Inner height (px)\n\t */\n\tpublic innerHeight(): number {\n\t\treturn this.height() - this.get(\"paddingTop\", 0) - this.get(\"paddingBottom\", 0);\n\t}\n\n\tprotected _getBounds() {\n\n\t\tlet width = this.get(\"width\");\n\t\tlet height = this.get(\"height\");\n\t\tlet pWidth = this.getPrivate(\"width\");\n\t\tlet pHeight = this.getPrivate(\"height\");\n\n\t\tlet bounds: IBounds = {\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t\tright: this.width(),\n\t\t\tbottom: this.height(),\n\t\t};\n\n\t\tlet layout = this.get(\"layout\");\n\t\tlet horizontal = false;\n\t\tlet vertical = false;\n\t\tif (layout instanceof HorizontalLayout || layout instanceof GridLayout) {\n\t\t\thorizontal = true;\n\t\t}\n\n\t\tif (layout instanceof VerticalLayout) {\n\t\t\tvertical = true;\n\t\t}\n\n\t\tif ((width != null || pWidth != null) && (height != null || pHeight != null) && !this.get(\"verticalScrollbar\")) {\n\t\t\t// void\n\t\t}\n\t\telse {\n\t\t\tlet m = Number.MAX_VALUE;\n\n\t\t\tlet l = m;\n\t\t\tlet r = -m;\n\t\t\tlet t = m;\n\t\t\tlet b = -m;\n\n\t\t\tconst paddingLeft = this.get(\"paddingLeft\", 0);\n\t\t\tconst paddingTop = this.get(\"paddingTop\", 0);\n\t\t\tconst paddingRight = this.get(\"paddingRight\", 0);\n\t\t\tconst paddingBottom = this.get(\"paddingBottom\", 0);\n\n\t\t\tthis.children.each((child) => {\n\t\t\t\tif (child.get(\"position\") != \"absolute\" && child.get(\"isMeasured\")) {\n\t\t\t\t\tlet childBounds = child.adjustedLocalBounds();\n\t\t\t\t\tlet childX = child.x();\n\t\t\t\t\tlet childY = child.y();\n\t\t\t\t\tlet cl = childX + childBounds.left;\n\t\t\t\t\tlet cr = childX + childBounds.right;\n\t\t\t\t\tlet ct = childY + childBounds.top;\n\t\t\t\t\tlet cb = childY + childBounds.bottom;\n\n\t\t\t\t\tif (horizontal) {\n\t\t\t\t\t\tcl -= child.get(\"marginLeft\", 0);\n\t\t\t\t\t\tcr += child.get(\"marginRight\", 0);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (vertical) {\n\t\t\t\t\t\tct -= child.get(\"marginTop\", 0);\n\t\t\t\t\t\tcb += child.get(\"marginBottom\", 0);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (cl < l) {\n\t\t\t\t\t\tl = cl;\n\t\t\t\t\t}\n\t\t\t\t\tif (cr > r) {\n\t\t\t\t\t\tr = cr;\n\t\t\t\t\t}\n\t\t\t\t\tif (ct < t) {\n\t\t\t\t\t\tt = ct;\n\t\t\t\t\t}\n\t\t\t\t\tif (cb > b) {\n\t\t\t\t\t\tb = cb;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tif (l == m) {\n\t\t\t\tl = 0;\n\t\t\t}\n\n\t\t\tif (r == -m) {\n\t\t\t\tr = 0;\n\t\t\t}\n\n\t\t\tif (t == m) {\n\t\t\t\tt = 0;\n\t\t\t}\n\n\t\t\tif (b == -m) {\n\t\t\t\tb = 0;\n\t\t\t}\n\n\t\t\tbounds.left = l - paddingLeft;\n\t\t\tbounds.top = t - paddingTop;\n\t\t\tbounds.right = r + paddingRight;\n\t\t\tbounds.bottom = b + paddingBottom;\n\t\t}\n\n\t\tthis._contentWidth = bounds.right - bounds.left;\n\t\tthis._contentHeight = bounds.bottom - bounds.top;\n\n\t\tif ($type.isNumber(width)) {\n\t\t\tbounds.left = 0;\n\t\t\tbounds.right = width;\n\t\t}\n\n\t\tif ($type.isNumber(pWidth)) {\n\t\t\tbounds.left = 0;\n\t\t\tbounds.right = pWidth;\n\t\t}\n\n\t\tif ($type.isNumber(height)) {\n\t\t\tbounds.top = 0;\n\t\t\tbounds.bottom = height;\n\t\t}\n\n\t\tif ($type.isNumber(pHeight)) {\n\t\t\tbounds.top = 0;\n\t\t\tbounds.bottom = pHeight;\n\t\t}\n\n\t\tthis._localBounds = bounds;\n\t}\n\n\tpublic _updateBounds() {\n\t\tconst layout = this.get(\"layout\");\n\n\t\tif (layout) {\n\t\t\tlayout.updateContainer(this);\n\t\t}\n\n\t\tsuper._updateBounds();\n\n\t\tthis.updateBackground();\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic markDirty(): void {\n\t\tsuper.markDirty();\n\t\tthis._root._addDirtyParent(this);\n\t}\n\n\tpublic _prepareChildren() {\n\t\tconst innerWidth = this.innerWidth();\n\t\tconst innerHeight = this.innerHeight();\n\n\t\tif (innerWidth != this._prevWidth || innerHeight != this._prevHeight) {\n\t\t\tlet layout = this.get(\"layout\");\n\t\t\tlet horizontal = false;\n\t\t\tlet vertical = false;\n\t\t\tif (layout) {\n\t\t\t\tif (layout instanceof HorizontalLayout || layout instanceof GridLayout) {\n\t\t\t\t\thorizontal = true;\n\t\t\t\t}\n\t\t\t\tif (layout instanceof VerticalLayout) {\n\t\t\t\t\tvertical = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t$array.each(this._percentageSizeChildren, (child) => {\n\t\t\t\tif (!horizontal) {\n\t\t\t\t\tlet width = child.get(\"width\");\n\t\t\t\t\tif (width instanceof Percent) {\n\t\t\t\t\t\tchild.setPrivate(\"width\", width.value * innerWidth);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!vertical) {\n\t\t\t\t\tlet height = child.get(\"height\");\n\t\t\t\t\tif (height instanceof Percent) {\n\t\t\t\t\t\tchild.setPrivate(\"height\", height.value * innerHeight);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\n\t\t\t$array.each(this._percentagePositionChildren, (child) => {\n\t\t\t\tchild.markDirtyPosition();\n\t\t\t\tchild.markDirtyBounds();\n\t\t\t})\n\n\t\t\tthis._prevWidth = innerWidth;\n\t\t\tthis._prevHeight = innerHeight;\n\n\t\t\tthis._sizeDirty = true;\n\t\t\tthis.updateBackground();\n\t\t}\n\n\t\tthis._handleStates();\n\t}\n\n\tpublic _updateChildren() {\n\n\t\tif (this.isDirty(\"verticalScrollbar\")) {\n\t\t\tconst verticalScrollbar = this.get(\"verticalScrollbar\")!;\n\t\t\tif (verticalScrollbar) {\n\t\t\t\tverticalScrollbar._setParent(this);\n\t\t\t\tverticalScrollbar.children.removeValue(verticalScrollbar.startGrip);\n\t\t\t\tverticalScrollbar.children.removeValue(verticalScrollbar.endGrip);\n\n\t\t\t\tthis.set(\"maskContent\", true);\n\t\t\t\tthis.set(\"paddingRight\", verticalScrollbar.width() + verticalScrollbar.get(\"marginRight\", 0) + verticalScrollbar.get(\"marginLeft\", 0));\n\n\t\t\t\tlet background = this.get(\"background\");\n\n\t\t\t\tif (!background) {\n\t\t\t\t\tbackground = this.set(\"background\", Rectangle.new(this._root, {\n\t\t\t\t\t\tthemeTags: [\"background\"],\n\t\t\t\t\t\tfillOpacity: 0,\n\t\t\t\t\t\tfill: this._root.interfaceColors.get(\"alternativeBackground\")\n\t\t\t\t\t}));\n\t\t\t\t}\n\n\t\t\t\tthis._disposers.push(this.events.on(\"wheel\", (event) => {\n\t\t\t\t\tconst wheelEvent = event.originalEvent;\n\t\t\t\t\twheelEvent.preventDefault();\n\t\t\t\t\tconst shiftY = wheelEvent.deltaY / 5000;\n\t\t\t\t\tconst start = verticalScrollbar.get(\"start\", 0);\n\t\t\t\t\tconst end = verticalScrollbar.get(\"end\", 1);\n\t\t\t\t\tif (start + shiftY > 0 && end + shiftY < 1) {\n\t\t\t\t\t\tverticalScrollbar.set(\"start\", start + shiftY);\n\t\t\t\t\t\tverticalScrollbar.set(\"end\", end + shiftY);\n\t\t\t\t\t}\n\t\t\t\t}))\n\n\t\t\t\tthis._disposers.push(verticalScrollbar.events.on(\"rangechanged\", () => {\n\t\t\t\t\tlet h = this._contentHeight;\n\t\t\t\t\tconst childrenDisplay = this._childrenDisplay;\n\t\t\t\t\tconst contentMask = this._contentMask;\n\n\t\t\t\t\tchildrenDisplay.y = -verticalScrollbar.get(\"start\") * h;\n\t\t\t\t\tchildrenDisplay.markDirtyLayer();\n\n\t\t\t\t\tif (contentMask) {\n\t\t\t\t\t\tcontentMask._display.y = -childrenDisplay.y;\n\t\t\t\t\t\tchildrenDisplay.mask = contentMask._display;\n\t\t\t\t\t}\n\t\t\t\t}))\n\n\t\t\t\tthis._display.addChild(verticalScrollbar._display);\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDirty(\"background\")) {\n\t\t\t// TODO maybe this should dispose ?\n\t\t\tconst previous = this._prevSettings[\"background\"];\n\t\t\tif (previous) {\n\t\t\t\tthis._display.removeChild(previous._display);\n\t\t\t}\n\n\t\t\tconst background = this.get(\"background\");\n\t\t\tif (background instanceof Sprite) {\n\t\t\t\tbackground.set(\"isMeasured\", false);\n\t\t\t\tbackground._setParent(this);\n\t\t\t\tthis._display.addChildAt(background._display, 0);\n\t\t\t}\n\t\t}\n\n\t\tif (this.isDirty(\"mask\")) {\n\n\t\t\tconst mask = this.get(\"mask\");\n\n\t\t\tconst previous = this._prevSettings[\"mask\"];\n\t\t\tif (previous) {\n\t\t\t\tthis._display.removeChild(previous._display);\n\t\t\t\tif (previous != mask) {\n\t\t\t\t\tprevious.dispose();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (mask) {\n\t\t\t\tvar parent = mask.parent;\n\t\t\t\tif (parent) {\n\t\t\t\t\tparent.children.removeValue(mask);\n\t\t\t\t}\n\n\t\t\t\tmask._setParent(this);\n\t\t\t\tthis._display.addChildAt(mask._display, 0);\n\t\t\t\tthis._childrenDisplay.mask = mask._display;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _processTemplateField(): void {\n\t\tsuper._processTemplateField();\n\t\tthis.children.each((child) => {\n\t\t\tchild._processTemplateField();\n\t\t})\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic walkChildren(f: (child: Sprite) => void): void {\n\t\tthis.children.each((child) => {\n\t\t\tif (child instanceof Container) {\n\t\t\t\tchild.walkChildren(f);\n\t\t\t}\n\t\t\tf(child);\n\t\t});\n\t}\n\n\tpublic eachChildren(f: (child: Sprite) => void): void {\n\t\tconst background = this.get(\"background\");\n\t\tif (background) {\n\t\t\tf(background);\n\t\t}\n\n\t\tconst verticalScrollbar = this.get(\"verticalScrollbar\");\n\t\tif (verticalScrollbar) {\n\t\t\tf(verticalScrollbar);\n\t\t}\n\n\t\tconst mask = this.get(\"mask\");\n\t\tif (mask) {\n\t\t\tf(mask);\n\t\t}\n\n\t\tthis.children.values.forEach((child) => {\n\t\t\tf(child);\n\t\t});\n\t}\n\n\tpublic allChildren(): Array<Sprite> {\n\t\tconst output: Array<Sprite> = [];\n\n\t\tthis.eachChildren((x) => {\n\t\t\toutput.push(x);\n\t\t});\n\n\t\treturn output;\n\t}\n}\n"]},"metadata":{},"sourceType":"module"}