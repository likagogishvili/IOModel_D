{"ast":null,"code":"import { __awaiter, __extends, __generator } from \"tslib\";\nimport { DataItem } from \"../../../core/render/Component\";\nimport { Series } from \"../../../core/render/Series\";\nimport { List } from \"../../../core/util/List\";\nimport { Container } from \"../../../core/render/Container\";\nimport { Graphics } from \"../../../core/render/Graphics\";\nimport * as $type from \"../../../core/util/Type\";\nimport * as $object from \"../../../core/util/Object\";\nimport * as $array from \"../../../core/util/Array\";\nimport * as $utils from \"../../../core/util/Utils\";\n/**\r\n * @ignore\r\n */\n\nfunction min(left, right) {\n  if (left == null) {\n    return right;\n  } else if (right == null) {\n    return left;\n  } else if (right < left) {\n    return right;\n  } else {\n    return left;\n  }\n}\n/**\r\n * @ignore\r\n */\n\n\nfunction max(left, right) {\n  if (left == null) {\n    return right;\n  } else if (right == null) {\n    return left;\n  } else if (right > left) {\n    return right;\n  } else {\n    return left;\n  }\n}\n/**\r\n * A base class for all XY chart series.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/} for more info\r\n */\n\n\nvar XYSeries =\n/** @class */\nfunction (_super) {\n  __extends(XYSeries, _super);\n\n  function XYSeries() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    Object.defineProperty(_this, \"_xField\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(_this, \"_yField\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(_this, \"_xOpenField\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(_this, \"_yOpenField\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(_this, \"_xLowField\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(_this, \"_xHighField\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(_this, \"_yLowField\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(_this, \"_yHighField\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(_this, \"_axesDirty\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: false\n    });\n    Object.defineProperty(_this, \"_stackDirty\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: false\n    });\n    Object.defineProperty(_this, \"_selectionProcessed\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: false\n    });\n    Object.defineProperty(_this, \"_dataSets\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: {}\n    });\n    Object.defineProperty(_this, \"_mainContainerMask\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(_this, \"_x\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: 0\n    });\n    Object.defineProperty(_this, \"_y\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: 0\n    });\n    /**\r\n     * A [[Container]] that us used to put series' elements in.\r\n     *\r\n     * @default Container.new()\r\n     */\n\n    Object.defineProperty(_this, \"mainContainer\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: _this.children.push(Container.new(_this._root, {}))\n    });\n    /**\r\n     * A list of axis ranges that affect the series.\r\n     *\r\n     * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/axes/axis-ranges/} for more info\r\n     */\n\n    Object.defineProperty(_this, \"axisRanges\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: new List()\n    });\n    Object.defineProperty(_this, \"_skipped\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: false\n    });\n    Object.defineProperty(_this, \"_couldStackTo\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: []\n    });\n    Object.defineProperty(_this, \"_reallyStackedTo\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: {}\n    });\n    Object.defineProperty(_this, \"_stackedSeries\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: {}\n    });\n    Object.defineProperty(_this, \"_aLocationX0\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: 0\n    });\n    Object.defineProperty(_this, \"_aLocationX1\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: 1\n    });\n    Object.defineProperty(_this, \"_aLocationY0\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: 0\n    });\n    Object.defineProperty(_this, \"_aLocationY1\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: 1\n    });\n    Object.defineProperty(_this, \"_showBullets\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: true\n    });\n    Object.defineProperty(_this, \"valueXFields\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: [\"valueX\", \"openValueX\", \"lowValueX\", \"highValueX\"]\n    });\n    Object.defineProperty(_this, \"valueYFields\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: [\"valueY\", \"openValueY\", \"lowValueY\", \"highValueY\"]\n    });\n    Object.defineProperty(_this, \"_valueXFields\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(_this, \"_valueYFields\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    }); // used for full min/max\n\n    Object.defineProperty(_this, \"_valueXShowFields\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(_this, \"_valueYShowFields\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    }); // used for selection (uses working)\n\n    Object.defineProperty(_this, \"__valueXShowFields\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(_this, \"__valueYShowFields\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(_this, \"_emptyDataItem\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: new DataItem(_this, undefined, {})\n    });\n    Object.defineProperty(_this, \"_dataSetId\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(_this, \"_tooltipFieldX\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(_this, \"_tooltipFieldY\", {\n      enumerable: true,\n      configurable: true,\n      writable: true,\n      value: void 0\n    });\n    return _this;\n  }\n\n  Object.defineProperty(XYSeries.prototype, \"_afterNew\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var _this = this;\n\n      this.fields.push(\"categoryX\", \"categoryY\", \"openCategoryX\", \"openCategoryY\");\n      this.valueFields.push(\"valueX\", \"valueY\", \"openValueX\", \"openValueY\", \"lowValueX\", \"lowValueY\", \"highValueX\", \"highValueY\");\n\n      this._setRawDefault(\"vcx\", 1);\n\n      this._setRawDefault(\"vcy\", 1); // this can't go to themes, as data might be parsed before theme\n\n\n      this._setRawDefault(\"valueXShow\", \"valueXWorking\");\n\n      this._setRawDefault(\"valueYShow\", \"valueYWorking\");\n\n      this._setRawDefault(\"openValueXShow\", \"openValueXWorking\");\n\n      this._setRawDefault(\"openValueYShow\", \"openValueYWorking\");\n\n      this._setRawDefault(\"lowValueXShow\", \"lowValueXWorking\");\n\n      this._setRawDefault(\"lowValueYShow\", \"lowValueYWorking\");\n\n      this._setRawDefault(\"highValueXShow\", \"highValueXWorking\");\n\n      this._setRawDefault(\"highValueYShow\", \"highValueYWorking\");\n\n      this._setRawDefault(\"lowValueXGrouped\", \"low\");\n\n      this._setRawDefault(\"lowValueYGrouped\", \"low\");\n\n      this._setRawDefault(\"highValueXGrouped\", \"high\");\n\n      this._setRawDefault(\"highValueYGrouped\", \"high\");\n\n      _super.prototype._afterNew.call(this);\n\n      this._settings.xAxis.series.push(this);\n\n      this._settings.yAxis.series.push(this);\n\n      this.set(\"maskContent\", true);\n\n      this._disposers.push(this.axisRanges.events.onAll(function (change) {\n        if (change.type === \"clear\") {\n          $array.each(change.oldValues, function (axisRange) {\n            _this._removeAxisRange(axisRange);\n          });\n        } else if (change.type === \"push\") {\n          _this._processAxisRange(change.newValue);\n        } else if (change.type === \"setIndex\") {\n          _this._processAxisRange(change.newValue);\n        } else if (change.type === \"insertIndex\") {\n          _this._processAxisRange(change.newValue);\n        } else if (change.type === \"removeIndex\") {\n          _this._removeAxisRange(change.oldValue);\n        } else if (change.type === \"moveIndex\") {\n          _this._processAxisRange(change.value);\n        } else {\n          throw new Error(\"Unknown IStreamEvent type\");\n        }\n      }));\n\n      if (!this.get(\"baseAxis\")) {\n        var xAxis = this.get(\"xAxis\");\n        var yAxis = this.get(\"yAxis\");\n\n        if (yAxis.isType(\"CategoryAxis\") || yAxis.isType(\"DateAxis\")) {\n          this.set(\"baseAxis\", yAxis);\n        } else {\n          this.set(\"baseAxis\", xAxis);\n        }\n      }\n\n      this.states.create(\"hidden\", {\n        opacity: 1,\n        visible: false\n      });\n\n      this._makeFieldNames();\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_processAxisRange\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (axisRange) {\n      var container = Container.new(this._root, {});\n      axisRange.container = container;\n      this.children.push(container);\n      axisRange.series = this;\n      var axisDataItem = axisRange.axisDataItem;\n      axisDataItem.setRaw(\"isRange\", true);\n      var axis = axisDataItem.component;\n\n      if (axis) {\n        axis._processAxisRange(axisDataItem, [\"range\", \"series\"]);\n\n        var bullet = axisDataItem.get(\"bullet\");\n\n        if (bullet) {\n          var sprite = bullet.get(\"sprite\");\n\n          if (sprite) {\n            sprite.setPrivate(\"visible\", false);\n          }\n        }\n\n        var axisFill = axisDataItem.get(\"axisFill\");\n\n        if (axisFill) {\n          container.set(\"mask\", axisFill);\n        }\n\n        axis._seriesAxisRanges.push(axisDataItem);\n      }\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_removeAxisRange\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (axisRange) {\n      var axisDataItem = axisRange.axisDataItem;\n      var axis = axisDataItem.component;\n      axis.disposeDataItem(axisDataItem);\n      $array.remove(axis._seriesAxisRanges, axisDataItem);\n      var container = axisRange.container;\n\n      if (container) {\n        container.dispose();\n      }\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_updateFields\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var _this = this;\n\n      _super.prototype._updateFields.call(this);\n\n      this._valueXFields = [];\n      this._valueYFields = [];\n      this._valueXShowFields = [];\n      this._valueYShowFields = [];\n      this.__valueXShowFields = [];\n      this.__valueYShowFields = [];\n\n      if (this.valueXFields) {\n        $array.each(this.valueXFields, function (key) {\n          var field = _this.get(key + \"Field\");\n\n          if (field) {\n            _this._valueXFields.push(key);\n\n            var field_1 = _this.get(key + \"Show\");\n\n            _this.__valueXShowFields.push(field_1);\n\n            if (field_1.indexOf(\"Working\") != -1) {\n              _this._valueXShowFields.push(field_1.split(\"Working\")[0]);\n            } else {\n              _this._valueYShowFields.push(field_1);\n            }\n          }\n        });\n      }\n\n      if (this.valueYFields) {\n        $array.each(this.valueYFields, function (key) {\n          var field = _this.get(key + \"Field\");\n\n          if (field) {\n            _this._valueYFields.push(key);\n\n            var field_2 = _this.get(key + \"Show\");\n\n            _this.__valueYShowFields.push(field_2);\n\n            if (field_2.indexOf(\"Working\") != -1) {\n              _this._valueYShowFields.push(field_2.split(\"Working\")[0]);\n            } else {\n              _this._valueYShowFields.push(field_2);\n            }\n          }\n        });\n      }\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_dispose\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      _super.prototype._dispose.call(this);\n\n      var chart = this.chart;\n\n      if (chart) {\n        chart.series.removeValue(this);\n      }\n\n      $array.removeFirst(this.get(\"xAxis\").series, this);\n      $array.removeFirst(this.get(\"yAxis\").series, this);\n    }\n  }); // TODO use  SelectKeys<this[\"_privateSettings\"], number | undefined>\n\n  Object.defineProperty(XYSeries.prototype, \"_min\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (key, value) {\n      var newValue = min(this.getPrivate(key), value);\n      this.setPrivate(key, newValue);\n    }\n  }); // TODO use  SelectKeys<this[\"_privateSettings\"], number | undefined>\n\n  Object.defineProperty(XYSeries.prototype, \"_max\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (key, value) {\n      var newValue = max(this.getPrivate(key), value);\n      this.setPrivate(key, newValue);\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_shouldMakeBullet\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (dataItem) {\n      if (!this.get(\"xAxis\").inited || !this.get(\"yAxis\").inited) {\n        return false;\n      }\n\n      if (dataItem.get(this._xField) != null && dataItem.get(this._yField) != null) {\n        return true;\n      }\n\n      return false;\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_makeFieldNames\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var xAxis = this.get(\"xAxis\");\n      var yAxis = this.get(\"yAxis\");\n      var xName = xAxis.getPrivate(\"name\");\n      var xCapName = $utils.capitalizeFirst(xName);\n      var yName = yAxis.getPrivate(\"name\");\n      var yCapName = $utils.capitalizeFirst(yName);\n      var xLetter = xAxis.get(\"renderer\").getPrivate(\"letter\");\n      var yLetter = yAxis.get(\"renderer\").getPrivate(\"letter\");\n      var open = \"open\";\n      var low = \"low\";\n      var high = \"high\";\n      var show = \"Show\";\n\n      if (xAxis.className === \"ValueAxis\") {\n        this._xField = this.get(xName + xLetter + show);\n        this._xOpenField = this.get(open + xCapName + xLetter + show);\n        this._xLowField = this.get(low + xCapName + xLetter + show);\n        this._xHighField = this.get(high + xCapName + xLetter + show);\n      } else {\n        this._xField = xName + xLetter;\n        this._xOpenField = open + xCapName + xLetter;\n        this._xLowField = low + xCapName + xLetter;\n        this._xHighField = high + xCapName + xLetter;\n      }\n\n      if (yAxis.className === \"ValueAxis\") {\n        this._yField = this.get(yName + yLetter + show);\n        this._yOpenField = this.get(open + yCapName + yLetter + show);\n        this._yLowField = this.get(low + yCapName + yLetter + show);\n        this._yHighField = this.get(high + yCapName + yLetter + show);\n      } else {\n        this._yField = yName + yLetter;\n        this._yOpenField = open + yCapName + yLetter;\n        this._yLowField = low + yCapName + yLetter;\n        this._yHighField = high + yCapName + yLetter;\n      }\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_fixVC\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var xAxis = this.get(\"xAxis\");\n      var yAxis = this.get(\"yAxis\");\n      var baseAxis = this.get(\"baseAxis\");\n      var hiddenState = this.states.lookup(\"hidden\");\n      var sequencedInterpolation = this.get(\"sequencedInterpolation\");\n\n      if (hiddenState) {\n        var value = 0;\n\n        if (sequencedInterpolation) {\n          value = 0.999999999999; // makes animate, good for stacked\n        }\n\n        if (xAxis === baseAxis) {\n          hiddenState.set(\"vcy\", value);\n        } else if (yAxis === baseAxis) {\n          hiddenState.set(\"vcx\", value);\n        } else {\n          hiddenState.set(\"vcy\", value);\n          hiddenState.set(\"vcx\", value);\n        }\n      }\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_handleMaskBullets\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      if (this.isDirty(\"maskBullets\")) {\n        this.bulletsContainer.set(\"maskContent\", this.get(\"maskBullets\"));\n      }\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_prepareChildren\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var _this = this;\n\n      _super.prototype._prepareChildren.call(this);\n\n      if (this.isDirty(\"valueYShow\") || this.isDirty(\"valueXShow\" || this.isDirty(\"openValueYShow\") || this.isDirty(\"openValueXShow\") || this.isDirty(\"lowValueYShow\") || this.isDirty(\"lowValueXShow\") || this.isDirty(\"highValueYShow\") || this.isDirty(\"highValueXShow\"))) {\n        this._updateFields();\n\n        this._makeFieldNames();\n\n        this._valuesDirty = true;\n      }\n\n      this.set(\"width\", this.get(\"xAxis\").width());\n      this.set(\"height\", this.get(\"yAxis\").height());\n\n      this._handleMaskBullets();\n\n      var xAxis = this.get(\"xAxis\");\n      var yAxis = this.get(\"yAxis\");\n      var baseAxis = this.get(\"baseAxis\");\n      var tooltipPositionX = this.get(\"tooltipPositionX\");\n      var tooltipFieldX;\n\n      switch (tooltipPositionX) {\n        case \"open\":\n          tooltipFieldX = this._xOpenField;\n          break;\n\n        case \"low\":\n          tooltipFieldX = this._xLowField;\n          break;\n\n        case \"high\":\n          tooltipFieldX = this._xHighField;\n          break;\n\n        default:\n          tooltipFieldX = this._xField;\n      }\n\n      this._tooltipFieldX = tooltipFieldX;\n      var tooltipPositionY = this.get(\"tooltipPositionY\");\n      var tooltipFieldY;\n\n      switch (tooltipPositionY) {\n        case \"open\":\n          tooltipFieldY = this._yOpenField;\n          break;\n\n        case \"low\":\n          tooltipFieldY = this._yLowField;\n          break;\n\n        case \"high\":\n          tooltipFieldY = this._yHighField;\n          break;\n\n        default:\n          tooltipFieldY = this._yField;\n      }\n\n      this._tooltipFieldY = tooltipFieldY;\n\n      if (this.isDirty(\"baseAxis\")) {\n        this._fixVC();\n      }\n\n      this.set(\"x\", xAxis.x() - $utils.relativeToValue(xAxis.get(\"centerX\", 0), xAxis.width()) - xAxis.parent.get(\"paddingLeft\", 0));\n      this.set(\"y\", yAxis.y() - $utils.relativeToValue(yAxis.get(\"centerY\", 0), yAxis.height()) - yAxis.parent.get(\"paddingTop\", 0));\n      this.bulletsContainer.set(\"y\", this.y());\n      this.bulletsContainer.set(\"x\", this.x());\n      var stacked = this.get(\"stacked\");\n\n      if (this.isDirty(\"stacked\")) {\n        if (stacked) {\n          if (this._valuesDirty && !this._dataProcessed) {} else {\n            this._stack();\n          }\n        } else {\n          this._unstack();\n        }\n      }\n\n      if (this._valuesDirty && !this._dataProcessed) {\n        this._dataProcessed = true;\n\n        if (stacked) {\n          this._stack();\n        }\n\n        $array.each(this.dataItems, function (dataItem) {\n          $array.each(_this._valueXShowFields, function (key) {\n            var value = dataItem.get(key);\n\n            if (value != null) {\n              if (stacked) {\n                value += _this.getStackedXValue(dataItem, key);\n              }\n\n              _this._min(\"minX\", value);\n\n              _this._max(\"maxX\", value);\n            }\n          });\n          $array.each(_this._valueYShowFields, function (key) {\n            var value = dataItem.get(key);\n\n            if (value != null) {\n              if (stacked) {\n                value += _this.getStackedYValue(dataItem, key);\n              }\n\n              _this._min(\"minY\", value);\n\n              _this._max(\"maxY\", value);\n            }\n          });\n          xAxis.processSeriesDataItem(dataItem, _this._valueXFields);\n          yAxis.processSeriesDataItem(dataItem, _this._valueYFields);\n        });\n        xAxis._seriesValuesDirty = true;\n        yAxis._seriesValuesDirty = true;\n\n        if (!this.get(\"ignoreMinMax\")) {\n          if (this.isPrivateDirty(\"minX\") || this.isPrivateDirty(\"maxX\")) {\n            xAxis.markDirtyExtremes();\n          }\n\n          if (this.isPrivateDirty(\"minY\") || this.isPrivateDirty(\"maxY\")) {\n            yAxis.markDirtyExtremes();\n          }\n        }\n\n        this._markStakedDirtyStack(); //this.updateLegendMarker(undefined); // causes legend marker to change color instantly when on\n\n\n        this.updateLegendValue(undefined);\n      }\n\n      if (this.isDirty(\"vcx\") || this.isDirty(\"vcy\")) {\n        this._markStakedDirtyStack();\n      }\n\n      if (!this._dataGrouped) {\n        xAxis._groupSeriesData(this);\n\n        yAxis._groupSeriesData(this);\n\n        this._dataGrouped = true;\n      }\n\n      if (this._valuesDirty || this.isPrivateDirty(\"startIndex\") || this.isPrivateDirty(\"endIndex\") || this.isDirty(\"vcx\") || this.isDirty(\"vcy\") || this._stackDirty) {\n        var startIndex = this.startIndex();\n        var endIndex = this.endIndex();\n        var minBulletDistance = this.get(\"minBulletDistance\", 0);\n\n        if (minBulletDistance > 0 && baseAxis) {\n          if (baseAxis.get(\"renderer\").axisLength() / (endIndex - startIndex) > minBulletDistance) {\n            this._showBullets = true;\n          } else {\n            this._showBullets = false;\n          }\n        }\n\n        if ((this._psi != startIndex || this._pei != endIndex || this.isDirty(\"vcx\") || this.isDirty(\"vcy\") || this._stackDirty || this._valuesDirty) && !this._selectionProcessed) {\n          this._selectionProcessed = true;\n          var vcx = this.get(\"vcx\", 1);\n          var vcy = this.get(\"vcy\", 1);\n          var stacked_1 = this.get(\"stacked\", false);\n          var outOfSelection = this.getPrivate(\"outOfSelection\");\n\n          if (baseAxis === xAxis) {\n            yAxis._calculateTotals();\n\n            this.setPrivateRaw(\"selectionMinY\", undefined);\n            this.setPrivateRaw(\"selectionMaxY\", undefined);\n\n            if (!outOfSelection) {\n              for (var i = startIndex; i < endIndex; i++) {\n                this.processYSelectionDataItem(this.dataItems[i], vcy, stacked_1);\n              }\n            } else {\n              yAxis.markDirtySelectionExtremes();\n            }\n          } else if (baseAxis === yAxis) {\n            xAxis._calculateTotals();\n\n            this.setPrivateRaw(\"selectionMinX\", undefined);\n            this.setPrivateRaw(\"selectionMaxX\", undefined);\n\n            if (!outOfSelection) {\n              for (var i = startIndex; i < endIndex; i++) {\n                this.processXSelectionDataItem(this.dataItems[i], vcx, stacked_1);\n              }\n            } else {\n              yAxis.markDirtySelectionExtremes();\n            }\n          }\n\n          if (baseAxis === xAxis) {\n            if (this.get(\"valueYShow\") !== \"valueYWorking\") {\n              var selectionMinY = this.getPrivate(\"selectionMinY\");\n\n              if (selectionMinY != null) {\n                this.setPrivateRaw(\"minY\", selectionMinY);\n                yAxis.markDirtyExtremes();\n              }\n\n              var selectionMaxY = this.getPrivate(\"selectionMaxY\");\n\n              if (selectionMaxY != null) {\n                this.setPrivateRaw(\"maxY\", selectionMaxY);\n                yAxis.markDirtyExtremes();\n              }\n            }\n          } else if (baseAxis === yAxis) {\n            if (this.get(\"valueXShow\") !== \"valueXWorking\") {\n              var selectionMinX = this.getPrivate(\"selectionMinX\");\n\n              if (selectionMinX != null) {\n                this.setPrivateRaw(\"minX\", selectionMinX);\n                yAxis.markDirtyExtremes();\n              }\n\n              var selectionMaxX = this.getPrivate(\"selectionMaxX\");\n\n              if (selectionMaxX != null) {\n                this.setPrivateRaw(\"maxX\", selectionMaxX);\n                xAxis.markDirtyExtremes();\n              }\n            }\n          }\n\n          if (this.isPrivateDirty(\"selectionMinX\") || this.isPrivateDirty(\"selectionMaxX\")) {\n            xAxis.markDirtySelectionExtremes();\n          }\n\n          if (this.isPrivateDirty(\"selectionMinY\") || this.isPrivateDirty(\"selectionMaxY\")) {\n            yAxis.markDirtySelectionExtremes();\n          } // this.updateLegendValue(undefined); flickers while panning\n\n        }\n      }\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_makeRangeMask\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var _this = this;\n\n      if (this.axisRanges.length > 0) {\n        var mainContainerMask_1 = this._mainContainerMask;\n\n        if (mainContainerMask_1 == null) {\n          mainContainerMask_1 = this.children.push(Graphics.new(this._root, {}));\n          this._mainContainerMask = mainContainerMask_1;\n          mainContainerMask_1.set(\"draw\", function (display, target) {\n            var parent = _this.parent;\n\n            if (parent) {\n              var w = _this._root.container.width();\n\n              var h = _this._root.container.height();\n\n              display.moveTo(-w, -h);\n              display.lineTo(-w, h * 2);\n              display.lineTo(w * 2, h * 2);\n              display.lineTo(w * 2, -h);\n              display.lineTo(-w, -h);\n\n              _this.axisRanges.each(function (axisRange) {\n                var fill = axisRange.axisDataItem.get(\"axisFill\");\n\n                if (parent) {\n                  if (fill) {\n                    var draw = fill.get(\"draw\");\n\n                    if (draw) {\n                      draw(display, target);\n                    }\n                  }\n                }\n              });\n            }\n\n            _this.mainContainer._display.mask = mainContainerMask_1._display;\n          });\n        }\n\n        mainContainerMask_1.markDirty();\n\n        mainContainerMask_1._markDirtyKey(\"fill\");\n      } else {\n        this.mainContainer._display.mask = null;\n      }\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_updateChildren\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      _super.prototype._updateChildren.call(this); // save for performance\n\n\n      this._x = this.x();\n      this._y = this.y();\n\n      this._makeRangeMask();\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_stack\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var chart = this.chart;\n\n      if (chart) {\n        var seriesIndex = chart.series.indexOf(this);\n        this._couldStackTo = [];\n\n        if (seriesIndex > 0) {\n          var series = void 0;\n\n          for (var i = seriesIndex - 1; i >= 0; i--) {\n            series = chart.series.getIndex(i);\n\n            if (series.get(\"xAxis\") === this.get(\"xAxis\") && series.get(\"yAxis\") === this.get(\"yAxis\") && series.className === this.className) {\n              this._couldStackTo.push(series);\n\n              if (!series.get(\"stacked\")) {\n                break;\n              }\n            }\n          }\n        }\n\n        this._stackDataItems();\n      }\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_unstack\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var _this = this;\n\n      $object.each(this._reallyStackedTo, function (_key, value) {\n        delete value._stackedSeries[_this.uid];\n      });\n      this._reallyStackedTo = {};\n      $array.each(this.dataItems, function (dataItem) {\n        dataItem.setRaw(\"stackToItemY\", undefined);\n        dataItem.setRaw(\"stackToItemX\", undefined);\n      });\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_stackDataItems\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var _this = this; // this works only with the same number of data @todo: search by date/category?\n\n\n      var baseAxis = this.get(\"baseAxis\");\n      var xAxis = this.get(\"xAxis\");\n      var yAxis = this.get(\"yAxis\");\n      var field;\n      var stackToItemKey;\n\n      if (baseAxis === xAxis) {\n        field = \"valueY\";\n        stackToItemKey = \"stackToItemY\";\n      } else if (baseAxis === yAxis) {\n        field = \"valueX\";\n        stackToItemKey = \"stackToItemX\";\n      }\n\n      var len = this._couldStackTo.length;\n      var index = 0;\n      var stackToNegative = this.get(\"stackToNegative\");\n      this._reallyStackedTo = {};\n      $array.each(this.dataItems, function (dataItem) {\n        for (var s = 0; s < len; s++) {\n          var stackToSeries = _this._couldStackTo[s];\n          var stackToItem = stackToSeries.dataItems[index];\n          var value = dataItem.get(field);\n\n          if (stackToItem) {\n            var stackValue = stackToItem.get(field);\n\n            if (stackToNegative) {\n              if ($type.isNumber(value)) {\n                if ($type.isNumber(stackValue)) {\n                  if (value >= 0 && stackValue >= 0) {\n                    dataItem.setRaw(stackToItemKey, stackToItem);\n                    _this._reallyStackedTo[stackToSeries.uid] = stackToSeries;\n                    stackToSeries._stackedSeries[_this.uid] = _this;\n                    break;\n                  }\n\n                  if (value < 0 && stackValue < 0) {\n                    dataItem.setRaw(stackToItemKey, stackToItem);\n                    _this._reallyStackedTo[stackToSeries.uid] = stackToSeries;\n                    stackToSeries._stackedSeries[_this.uid] = _this;\n                    break;\n                  }\n                }\n              } else {\n                break;\n              }\n            } else {\n              if ($type.isNumber(value) && $type.isNumber(stackValue)) {\n                dataItem.setRaw(stackToItemKey, stackToItem);\n                _this._reallyStackedTo[stackToSeries.uid] = stackToSeries;\n                stackToSeries._stackedSeries[_this.uid] = _this;\n                break;\n              }\n            }\n          }\n        }\n\n        index++;\n      });\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"processXSelectionDataItem\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (dataItem, vcx, stacked) {\n      var _this = this;\n\n      $array.each(this.__valueXShowFields, function (key) {\n        var value = dataItem.get(key);\n\n        if (value != null) {\n          if (stacked) {\n            value += _this.getStackedXValueWorking(dataItem, key);\n          }\n\n          _this._min(\"selectionMinX\", value);\n\n          _this._max(\"selectionMaxX\", value * vcx);\n        }\n      });\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"processYSelectionDataItem\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (dataItem, vcy, stacked) {\n      var _this = this;\n\n      $array.each(this.__valueYShowFields, function (key) {\n        var value = dataItem.get(key);\n\n        if (value != null) {\n          if (stacked) {\n            value += _this.getStackedYValueWorking(dataItem, key);\n          }\n\n          _this._min(\"selectionMinY\", value);\n\n          _this._max(\"selectionMaxY\", value * vcy);\n        }\n      });\n    }\n  });\n  /**\r\n   * @ignore\r\n   */\n\n  Object.defineProperty(XYSeries.prototype, \"getStackedYValueWorking\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (dataItem, key) {\n      var stackToItem = dataItem.get(\"stackToItemY\");\n\n      if (stackToItem) {\n        var stackedToSeries = stackToItem.component;\n        return stackToItem.get(key, 0) * stackedToSeries.get(\"vcy\", 1) + this.getStackedYValueWorking(stackToItem, key);\n      }\n\n      return 0;\n    }\n  });\n  /**\r\n   * @ignore\r\n   */\n\n  Object.defineProperty(XYSeries.prototype, \"getStackedXValueWorking\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (dataItem, key) {\n      var stackToItem = dataItem.get(\"stackToItemX\");\n\n      if (stackToItem) {\n        var stackedToSeries = stackToItem.component;\n        return stackToItem.get(key, 0) * stackedToSeries.get(\"vcx\", 1) + this.getStackedXValueWorking(stackToItem, key);\n      }\n\n      return 0;\n    }\n  });\n  /**\r\n   * @ignore\r\n   */\n\n  Object.defineProperty(XYSeries.prototype, \"getStackedYValue\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (dataItem, key) {\n      var stackToItem = dataItem.get(\"stackToItemY\");\n\n      if (stackToItem) {\n        return stackToItem.get(key, 0) + this.getStackedYValue(stackToItem, key);\n      }\n\n      return 0;\n    }\n  });\n  /**\r\n   * @ignore\r\n   */\n\n  Object.defineProperty(XYSeries.prototype, \"getStackedXValue\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (dataItem, key) {\n      var stackToItem = dataItem.get(\"stackToItemX\");\n\n      if (stackToItem) {\n        return stackToItem.get(key, 0) + this.getStackedXValue(stackToItem, key);\n      }\n\n      return 0;\n    }\n  });\n  /**\r\n   * @ignore\r\n   */\n\n  Object.defineProperty(XYSeries.prototype, \"createLegendMarker\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (_dataItem) {\n      this.updateLegendMarker();\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_markDirtyAxes\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      this._axesDirty = true;\n      this.markDirty();\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_markDataSetDirty\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      this._afterDataChange();\n\n      this._valuesDirty = true;\n      this._dataProcessed = false;\n      this._aggregatesCalculated = false;\n      this.markDirty();\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_clearDirty\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      _super.prototype._clearDirty.call(this);\n\n      this._axesDirty = false;\n      this._selectionProcessed = false;\n      this._stackDirty = false;\n      this._dataProcessed = false;\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_positionBullet\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (bullet) {\n      var sprite = bullet.get(\"sprite\");\n\n      if (sprite) {\n        var dataItem = sprite.dataItem;\n        var locationX = bullet.get(\"locationX\", dataItem.get(\"locationX\", 0.5));\n        var locationY = bullet.get(\"locationY\", dataItem.get(\"locationY\", 0.5));\n        var xAxis = this.get(\"xAxis\");\n        var yAxis = this.get(\"yAxis\");\n        var positionX = xAxis.getDataItemPositionX(dataItem, this._xField, locationX, this.get(\"vcx\", 1));\n        var positionY = yAxis.getDataItemPositionY(dataItem, this._yField, locationY, this.get(\"vcy\", 1));\n        var point = this.getPoint(positionX, positionY);\n        var left = dataItem.get(\"left\", point.x);\n        var right = dataItem.get(\"right\", point.x);\n        var top_1 = dataItem.get(\"top\", point.y);\n        var bottom = dataItem.get(\"bottom\", point.y);\n\n        if (this._shouldShowBullet(positionX, positionY)) {\n          if (!bullet.getPrivate(\"hidden\")) {\n            sprite.setPrivate(\"visible\", true);\n          } else {\n            sprite.setPrivate(\"visible\", false);\n          }\n\n          var w = right - left;\n          var h = bottom - top_1;\n\n          if (sprite.isType(\"Label\")) {\n            sprite.set(\"maxWidth\", Math.abs(w));\n            sprite.set(\"maxHeight\", Math.abs(h));\n          }\n\n          var x = left + w * locationX;\n          var y = bottom - h * locationY;\n          sprite.set(\"x\", x);\n          sprite.set(\"y\", y);\n        } else {\n          sprite.setPrivate(\"visible\", false);\n        }\n      }\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_shouldShowBullet\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (_positionX, _positionY) {\n      return this._showBullets;\n    }\n  });\n  /**\r\n   * @ignore\r\n   */\n\n  Object.defineProperty(XYSeries.prototype, \"setDataSet\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (id) {\n      if (this._dataSets[id]) {\n        this._handleDataSetChange();\n\n        this._dataItems = this._dataSets[id];\n\n        this._markDataSetDirty();\n\n        this._dataSetId = id;\n        var type = \"datasetchanged\";\n\n        if (this.events.isEnabled(type)) {\n          this.events.dispatch(type, {\n            type: type,\n            target: this,\n            id: id\n          });\n        }\n      }\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_handleDataSetChange\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      if (this.bullets.length > 0) {\n        $array.each(this._dataItems, function (dataItem) {\n          var bullets = dataItem.bullets;\n\n          if (bullets) {\n            $array.each(bullets, function (bullet) {\n              var sprite = bullet.get(\"sprite\");\n\n              if (sprite) {\n                sprite.setPrivate(\"visible\", false);\n              }\n            });\n          }\n        });\n      }\n\n      this._selectionProcessed = false; // for totals to be calculated\n    }\n  });\n  /**\r\n   * Shows hidden series.\r\n   *\r\n   * @param   duration  Duration of animation in milliseconds\r\n   * @return            Animation promise\r\n   */\n\n  Object.defineProperty(XYSeries.prototype, \"show\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (duration) {\n      return __awaiter(this, void 0, void 0, function () {\n        var promises;\n\n        var _this = this;\n\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              this._fixVC();\n\n              promises = [];\n              promises.push(_super.prototype.show.call(this, duration).then(function () {\n                _this._isShowing = false;\n\n                var xAxis = _this.get(\"xAxis\");\n\n                var yAxis = _this.get(\"yAxis\");\n\n                var baseAxis = _this.get(\"baseAxis\");\n\n                if (yAxis !== baseAxis) {\n                  yAxis.markDirtySelectionExtremes();\n                }\n\n                if (xAxis !== baseAxis) {\n                  xAxis.markDirtySelectionExtremes();\n                }\n              }));\n              promises.push(this.bulletsContainer.show(duration));\n              promises.push(this._sequencedShowHide(true, duration));\n              return [4\n              /*yield*/\n              , Promise.all(promises)];\n\n            case 1:\n              _a.sent();\n\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    }\n  });\n  /**\r\n   * Hides series.\r\n   *\r\n   * @param   duration  Duration of animation in milliseconds\r\n   * @return            Animation promise\r\n   */\n\n  Object.defineProperty(XYSeries.prototype, \"hide\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (duration) {\n      return __awaiter(this, void 0, void 0, function () {\n        var promises;\n\n        var _this = this;\n\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              this._fixVC();\n\n              promises = [];\n              promises.push(_super.prototype.hide.call(this, duration).then(function () {\n                _this._isHiding = false;\n              }));\n              promises.push(this.bulletsContainer.hide(duration));\n              promises.push(this._sequencedShowHide(false, duration));\n              return [4\n              /*yield*/\n              , Promise.all(promises)];\n\n            case 1:\n              _a.sent();\n\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    }\n  });\n  /**\r\n   * Shows series's data item.\r\n   *\r\n   * @param   dataItem  Data item\r\n   * @param   duration  Animation duration in milliseconds\r\n   * @return            Promise\r\n   */\n\n  Object.defineProperty(XYSeries.prototype, \"showDataItem\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (dataItem, duration) {\n      return __awaiter(this, void 0, void 0, function () {\n        var promises, easing;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              promises = [_super.prototype.showDataItem.call(this, dataItem, duration)];\n\n              if (!$type.isNumber(duration)) {\n                duration = this.get(\"stateAnimationDuration\", 0);\n              }\n\n              easing = this.get(\"stateAnimationEasing\");\n              $array.each(this._valueFields, function (key) {\n                promises.push(dataItem.animate({\n                  key: key + \"Working\",\n                  to: dataItem.get(key),\n                  duration: duration,\n                  easing: easing\n                }).waitForStop());\n              });\n              return [4\n              /*yield*/\n              , Promise.all(promises)];\n\n            case 1:\n              _a.sent();\n\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    }\n  });\n  /**\r\n   * Hides series's data item.\r\n   *\r\n   * @param   dataItem  Data item\r\n   * @param   duration  Animation duration in milliseconds\r\n   * @return            Promise\r\n   */\n\n  Object.defineProperty(XYSeries.prototype, \"hideDataItem\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (dataItem, duration) {\n      return __awaiter(this, void 0, void 0, function () {\n        var promises, hiddenState, easing, xAxis, yAxis, baseAxis, stacked, min_1, baseValue_1;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              promises = [_super.prototype.hideDataItem.call(this, dataItem, duration)];\n              hiddenState = this.states.create(\"hidden\", {});\n\n              if (!$type.isNumber(duration)) {\n                duration = hiddenState.get(\"stateAnimationDuration\", this.get(\"stateAnimationDuration\", 0));\n              }\n\n              easing = hiddenState.get(\"stateAnimationEasing\", this.get(\"stateAnimationEasing\"));\n              xAxis = this.get(\"xAxis\");\n              yAxis = this.get(\"yAxis\");\n              baseAxis = this.get(\"baseAxis\");\n              stacked = this.get(\"stacked\");\n\n              if (baseAxis === xAxis || !baseAxis) {\n                $array.each(this._valueYFields, function (key) {\n                  var min = yAxis.getPrivate(\"min\");\n                  var baseValue = yAxis.baseValue();\n\n                  if ($type.isNumber(min) && min > baseValue) {\n                    baseValue = min;\n                  }\n\n                  if (stacked) {\n                    baseValue = 0;\n                  }\n\n                  promises.push(dataItem.animate({\n                    key: key + \"Working\",\n                    to: baseValue,\n                    duration: duration,\n                    easing: easing\n                  }).waitForStop());\n                });\n              }\n\n              if (baseAxis === yAxis || !baseAxis) {\n                min_1 = xAxis.getPrivate(\"min\");\n                baseValue_1 = xAxis.baseValue();\n\n                if ($type.isNumber(min_1) && min_1 > baseValue_1) {\n                  baseValue_1 = min_1;\n                }\n\n                if (stacked) {\n                  baseValue_1 = 0;\n                }\n\n                $array.each(this._valueXFields, function (key) {\n                  promises.push(dataItem.animate({\n                    key: key + \"Working\",\n                    to: baseValue_1,\n                    duration: duration,\n                    easing: easing\n                  }).waitForStop());\n                });\n              }\n\n              return [4\n              /*yield*/\n              , Promise.all(promises)];\n\n            case 1:\n              _a.sent();\n\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_markDirtyStack\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      this._stackDirty = true;\n      this.markDirty();\n\n      this._markStakedDirtyStack();\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_markStakedDirtyStack\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var stackedSeries = this._stackedSeries;\n\n      if (stackedSeries) {\n        $object.each(stackedSeries, function (_key, value) {\n          if (!value._stackDirty) {\n            value._markDirtyStack();\n          }\n        });\n      }\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_afterChanged\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      _super.prototype._afterChanged.call(this);\n\n      if (this._skipped) {\n        this._markDirtyAxes();\n\n        this._skipped = false;\n      }\n    }\n  });\n  /**\r\n   * Shows a tooltip for specific data item.\r\n   *\r\n   * @param  dataItem  Data item\r\n   */\n\n  Object.defineProperty(XYSeries.prototype, \"showDataItemTooltip\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (dataItem) {\n      this.updateLegendMarker(dataItem);\n      this.updateLegendValue(dataItem);\n\n      if (this.get(\"tooltip\")) {\n        if (!this.isHidden()) {\n          var tooltip = this.get(\"tooltip\");\n\n          if (tooltip) {\n            tooltip._setDataItem(dataItem);\n\n            if (dataItem) {\n              var locationX = this.get(\"locationX\", 0);\n              var locationY = this.get(\"locationY\", 1);\n              var itemLocationX = dataItem.get(\"locationX\", locationX);\n              var itemLocationY = dataItem.get(\"locationY\", locationY);\n              var xAxis = this.get(\"xAxis\");\n              var yAxis = this.get(\"yAxis\");\n              var vcx = this.get(\"vcx\", 1);\n              var vcy = this.get(\"vcy\", 1);\n              var xPos = xAxis.getDataItemPositionX(dataItem, this._tooltipFieldX, this._aLocationX0 + (this._aLocationX1 - this._aLocationX0) * itemLocationX, vcx);\n              var yPos = yAxis.getDataItemPositionY(dataItem, this._tooltipFieldY, this._aLocationY0 + (this._aLocationY1 - this._aLocationY0) * itemLocationY, vcy);\n              var point = this.getPoint(xPos, yPos);\n              var show_1 = true;\n              $array.each(this._valueFields, function (field) {\n                if (dataItem.get(field) == null) {\n                  show_1 = false;\n                }\n              });\n\n              if (show_1) {\n                var chart = this.chart;\n\n                if (chart && chart.inPlot(point)) {\n                  tooltip.label.text.markDirtyText();\n                  tooltip.set(\"tooltipTarget\", this._getTooltipTarget(dataItem));\n                  tooltip.set(\"pointTo\", this._display.toGlobal({\n                    x: point.x,\n                    y: point.y\n                  }));\n                } else {\n                  tooltip._setDataItem(undefined);\n                }\n              } else {\n                tooltip._setDataItem(undefined);\n              }\n            }\n          }\n        } else {\n          this.hideTooltip();\n        }\n      }\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_getTooltipTarget\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (dataItem) {\n      if (this.get(\"seriesTooltipTarget\") == \"bullet\") {\n        var bullets = dataItem.bullets;\n\n        if (bullets && bullets.length > 0) {\n          var bullet = bullets[0];\n          var sprite = bullet.get(\"sprite\");\n\n          if (sprite) {\n            return sprite;\n          }\n        }\n      }\n\n      return this;\n    }\n  });\n  /**\r\n   * @ignore\r\n   */\n\n  Object.defineProperty(XYSeries.prototype, \"updateLegendValue\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (dataItem) {\n      var legendDataItem = this.get(\"legendDataItem\");\n\n      if (legendDataItem) {\n        var label = legendDataItem.get(\"label\");\n\n        if (label) {\n          var txt = \"\";\n\n          if (dataItem) {\n            label._setDataItem(dataItem);\n\n            txt = this.get(\"legendLabelText\", label.get(\"text\", this.get(\"name\", \"\")));\n          } else {\n            label._setDataItem(this._emptyDataItem);\n\n            txt = this.get(\"legendRangeLabelText\", this.get(\"legendLabelText\", label.get(\"text\", this.get(\"name\", \"\"))));\n          }\n\n          label.set(\"text\", txt);\n        }\n\n        var valueLabel = legendDataItem.get(\"valueLabel\");\n\n        if (valueLabel) {\n          var txt = \"\";\n\n          if (dataItem) {\n            valueLabel._setDataItem(dataItem);\n\n            txt = this.get(\"legendValueText\", valueLabel.get(\"text\", \"\"));\n          } else {\n            valueLabel._setDataItem(this._emptyDataItem);\n\n            txt = this.get(\"legendRangeValueText\", valueLabel.get(\"text\", \"\"));\n          }\n\n          valueLabel.set(\"text\", txt);\n        }\n      }\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_getItemReaderLabel\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var text = \"X: {\" + this._xField;\n\n      if (this.get(\"xAxis\").isType(\"DateAxis\")) {\n        text += \".formatDate()\";\n      }\n\n      text += \"}; Y: {\" + this._yField;\n\n      if (this.get(\"yAxis\").isType(\"DateAxis\")) {\n        text += \".formatDate()\";\n      }\n\n      text += \"}\";\n      return text;\n    }\n  });\n  /**\r\n   * @ignore\r\n   */\n\n  Object.defineProperty(XYSeries.prototype, \"getPoint\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (positionX, positionY) {\n      var x = this.get(\"xAxis\").get(\"renderer\").positionToCoordinate(positionX);\n      var y = this.get(\"yAxis\").get(\"renderer\").positionToCoordinate(positionY);\n      return {\n        x: x,\n        y: y\n      };\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_shouldInclude\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (_position) {\n      return true;\n    }\n  });\n  /**\r\n   * @ignore\r\n   */\n\n  Object.defineProperty(XYSeries.prototype, \"handleCursorHide\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      this.hideTooltip();\n      this.updateLegendValue(undefined);\n      this.updateLegendMarker(undefined);\n    }\n  });\n  Object.defineProperty(XYSeries.prototype, \"_afterDataChange\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      _super.prototype._afterDataChange.call(this);\n\n      this.resetExtremes();\n    }\n  }); // todo description\n\n  Object.defineProperty(XYSeries.prototype, \"resetExtremes\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      this.setPrivate(\"selectionMinX\", undefined);\n      this.setPrivate(\"selectionMaxX\", undefined);\n      this.setPrivate(\"selectionMinY\", undefined);\n      this.setPrivate(\"selectionMaxY\", undefined);\n      this.setPrivate(\"minX\", undefined);\n      this.setPrivate(\"minY\", undefined);\n      this.setPrivate(\"maxX\", undefined);\n      this.setPrivate(\"maxY\", undefined);\n    }\n  });\n  /**\r\n   * Creates and returns an axis range object.\r\n   *\r\n   * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/axes/axis-ranges/} for more info\r\n   * @param   axisDataItem  Axis data item\r\n   * @return                Axis range\r\n   */\n\n  Object.defineProperty(XYSeries.prototype, \"createAxisRange\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function (axisDataItem) {\n      return this.axisRanges.push({\n        axisDataItem: axisDataItem\n      });\n    }\n  });\n  Object.defineProperty(XYSeries, \"className\", {\n    enumerable: true,\n    configurable: true,\n    writable: true,\n    value: \"XYSeries\"\n  });\n  Object.defineProperty(XYSeries, \"classNames\", {\n    enumerable: true,\n    configurable: true,\n    writable: true,\n    value: Series.classNames.concat([XYSeries.className])\n  });\n  return XYSeries;\n}(Series);\n\nexport { XYSeries };","map":{"version":3,"mappings":";AAUA,SAASA,QAAT,QAAyB,gCAAzB;AACA,SAASC,MAAT,QAAwF,6BAAxF;AACA,SAASC,IAAT,QAAqB,yBAArB;AACA,SAASC,SAAT,QAA0B,gCAA1B;AACA,SAASC,QAAT,QAAyB,+BAAzB;AAEA,OAAO,KAAKC,KAAZ,MAAuB,yBAAvB;AACA,OAAO,KAAKC,OAAZ,MAAyB,2BAAzB;AACA,OAAO,KAAKC,MAAZ,MAAwB,0BAAxB;AACA,OAAO,KAAKC,MAAZ,MAAwB,0BAAxB;AAEA;;;;AAGA,SAASC,GAAT,CAAaC,IAAb,EAAuCC,KAAvC,EAAgE;EAC/D,IAAID,IAAI,IAAI,IAAZ,EAAkB;IACjB,OAAOC,KAAP;EAEA,CAHD,MAGO,IAAIA,KAAK,IAAI,IAAb,EAAmB;IACzB,OAAOD,IAAP;EAEA,CAHM,MAGA,IAAIC,KAAK,GAAGD,IAAZ,EAAkB;IACxB,OAAOC,KAAP;EAEA,CAHM,MAGA;IACN,OAAOD,IAAP;EACA;AACD;AAED;;;;;AAGA,SAASE,GAAT,CAAaF,IAAb,EAAuCC,KAAvC,EAAgE;EAC/D,IAAID,IAAI,IAAI,IAAZ,EAAkB;IACjB,OAAOC,KAAP;EAEA,CAHD,MAGO,IAAIA,KAAK,IAAI,IAAb,EAAmB;IACzB,OAAOD,IAAP;EAEA,CAHM,MAGA,IAAIC,KAAK,GAAGD,IAAZ,EAAkB;IACxB,OAAOC,KAAP;EAEA,CAHM,MAGA;IACN,OAAOD,IAAP;EACA;AACD;AA+uBD;;;;;;;AAKA;AAAA;AAAA;EAAuCG;;EAAvC;IAAA;;IAUCC;sBAAA;wBAAA;oBAAA;;IAAA;IACAA;sBAAA;wBAAA;oBAAA;;IAAA;IACAA;sBAAA;wBAAA;oBAAA;;IAAA;IACAA;sBAAA;wBAAA;oBAAA;;IAAA;IAEAA;sBAAA;wBAAA;oBAAA;;IAAA;IACAA;sBAAA;wBAAA;oBAAA;;IAAA;IACAA;sBAAA;wBAAA;oBAAA;;IAAA;IACAA;sBAAA;wBAAA;oBAAA;;IAAA;IAEAA;sBAAA;wBAAA;oBAAA;aAAgC;IAAhC;IACAA;sBAAA;wBAAA;oBAAA;aAA8B;IAA9B;IAEAA;sBAAA;wBAAA;oBAAA;aAAgC;IAAhC;IAIAA;sBAAA;wBAAA;oBAAA;aAA4E;IAA5E;IAEAA;sBAAA;wBAAA;oBAAA;;IAAA;IAEAA;sBAAA;wBAAA;oBAAA;aAAuB;IAAvB;IACAA;sBAAA;wBAAA;oBAAA;aAAuB;IAAvB;IAEA;;;;;;IAKAA;sBAAA;wBAAA;oBAAA;aAA2CC,KAAI,CAACC,QAAL,CAAcC,IAAd,CAAmBd,SAAS,CAACe,GAAV,CAAcH,KAAI,CAACI,KAAnB,EAA0B,EAA1B,CAAnB;IAA3C;IAEA;;;;;;IAKAL;sBAAA;wBAAA;oBAAA;aAA2D,IAAIZ,IAAJ;IAA3D;IAEAY;sBAAA;wBAAA;oBAAA;aAA8B;IAA9B;IAEAA;sBAAA;wBAAA;oBAAA;aAA2C;IAA3C;IAEAA;sBAAA;wBAAA;oBAAA;aAA4D;IAA5D;IAEAA;sBAAA;wBAAA;oBAAA;aAAuD;IAAvD;IAEAA;sBAAA;wBAAA;oBAAA;aAAiC;IAAjC;IACAA;sBAAA;wBAAA;oBAAA;aAAiC;IAAjC;IACAA;sBAAA;wBAAA;oBAAA;aAAiC;IAAjC;IACAA;sBAAA;wBAAA;oBAAA;aAAiC;IAAjC;IAEAA;sBAAA;wBAAA;oBAAA;aAAkC;IAAlC;IAEAA;sBAAA;wBAAA;oBAAA;aAAyB,CACxB,QADwB,EAExB,YAFwB,EAGxB,WAHwB,EAIxB,YAJwB;IAAzB;IAOAA;sBAAA;wBAAA;oBAAA;aAAyB,CACxB,QADwB,EAExB,YAFwB,EAGxB,WAHwB,EAIxB,YAJwB;IAAzB;IAOAA;sBAAA;wBAAA;oBAAA;;IAAA;IACAA;sBAAA;wBAAA;oBAAA;;IAAA,GA9ED,CAgFC;;IACAA;sBAAA;wBAAA;oBAAA;;IAAA;IACAA;sBAAA;wBAAA;oBAAA;;IAAA,GAlFD,CAoFC;;IACAA;sBAAA;wBAAA;oBAAA;;IAAA;IACAA;sBAAA;wBAAA;oBAAA;;IAAA;IAEAA;sBAAA;wBAAA;oBAAA;aAA2B,IAAId,QAAJ,CAAae,KAAb,EAAmBK,SAAnB,EAA8B,EAA9B;IAA3B;IAEAN;sBAAA;wBAAA;oBAAA;;IAAA;IAEAA;sBAAA;wBAAA;oBAAA;;IAAA;IACAA;sBAAA;wBAAA;oBAAA;;IAAA;;EA4qCA;;;;;;WA1qCA;MAAA;;MACC,KAAKO,MAAL,CAAYJ,IAAZ,CAAiB,WAAjB,EAA8B,WAA9B,EAA2C,eAA3C,EAA4D,eAA5D;MACA,KAAKK,WAAL,CAAiBL,IAAjB,CAAsB,QAAtB,EAAgC,QAAhC,EAA0C,YAA1C,EAAwD,YAAxD,EAAsE,WAAtE,EAAmF,WAAnF,EAAgG,YAAhG,EAA8G,YAA9G;;MAEA,KAAKM,cAAL,CAAoB,KAApB,EAA2B,CAA3B;;MACA,KAAKA,cAAL,CAAoB,KAApB,EAA2B,CAA3B,EALD,CAMC;;;MACA,KAAKA,cAAL,CAAoB,YAApB,EAAkC,eAAlC;;MACA,KAAKA,cAAL,CAAoB,YAApB,EAAkC,eAAlC;;MAEA,KAAKA,cAAL,CAAoB,gBAApB,EAAsC,mBAAtC;;MACA,KAAKA,cAAL,CAAoB,gBAApB,EAAsC,mBAAtC;;MAEA,KAAKA,cAAL,CAAoB,eAApB,EAAqC,kBAArC;;MACA,KAAKA,cAAL,CAAoB,eAApB,EAAqC,kBAArC;;MAEA,KAAKA,cAAL,CAAoB,gBAApB,EAAsC,mBAAtC;;MACA,KAAKA,cAAL,CAAoB,gBAApB,EAAsC,mBAAtC;;MAEA,KAAKA,cAAL,CAAoB,kBAApB,EAAwC,KAAxC;;MACA,KAAKA,cAAL,CAAoB,kBAApB,EAAwC,KAAxC;;MAEA,KAAKA,cAAL,CAAoB,mBAApB,EAAyC,MAAzC;;MACA,KAAKA,cAAL,CAAoB,mBAApB,EAAyC,MAAzC;;MAIAC,iBAAMC,SAAN,CAAeC,IAAf,CAAe,IAAf;;MAEA,KAAKC,SAAL,CAAeC,KAAf,CAAqBC,MAArB,CAA4BZ,IAA5B,CAAiC,IAAjC;;MACA,KAAKU,SAAL,CAAeG,KAAf,CAAqBD,MAArB,CAA4BZ,IAA5B,CAAiC,IAAjC;;MAEA,KAAKc,GAAL,CAAS,aAAT,EAAwB,IAAxB;;MAEA,KAAKC,UAAL,CAAgBf,IAAhB,CAAqB,KAAKgB,UAAL,CAAgBC,MAAhB,CAAuBC,KAAvB,CAA6B,UAACC,MAAD,EAAO;QACxD,IAAIA,MAAM,CAACC,IAAP,KAAgB,OAApB,EAA6B;UAC5B9B,MAAM,CAAC+B,IAAP,CAAYF,MAAM,CAACG,SAAnB,EAA8B,UAACC,SAAD,EAAU;YACvCzB,KAAI,CAAC0B,gBAAL,CAAsBD,SAAtB;UACA,CAFD;QAGA,CAJD,MAIO,IAAIJ,MAAM,CAACC,IAAP,KAAgB,MAApB,EAA4B;UAClCtB,KAAI,CAAC2B,iBAAL,CAAuBN,MAAM,CAACO,QAA9B;QACA,CAFM,MAEA,IAAIP,MAAM,CAACC,IAAP,KAAgB,UAApB,EAAgC;UACtCtB,KAAI,CAAC2B,iBAAL,CAAuBN,MAAM,CAACO,QAA9B;QACA,CAFM,MAEA,IAAIP,MAAM,CAACC,IAAP,KAAgB,aAApB,EAAmC;UACzCtB,KAAI,CAAC2B,iBAAL,CAAuBN,MAAM,CAACO,QAA9B;QACA,CAFM,MAEA,IAAIP,MAAM,CAACC,IAAP,KAAgB,aAApB,EAAmC;UACzCtB,KAAI,CAAC0B,gBAAL,CAAsBL,MAAM,CAACQ,QAA7B;QACA,CAFM,MAEA,IAAIR,MAAM,CAACC,IAAP,KAAgB,WAApB,EAAiC;UACvCtB,KAAI,CAAC2B,iBAAL,CAAuBN,MAAM,CAACS,KAA9B;QACA,CAFM,MAEA;UACN,MAAM,IAAIC,KAAJ,CAAU,2BAAV,CAAN;QACA;MACD,CAlBoB,CAArB;;MAoBA,IAAI,CAAC,KAAKC,GAAL,CAAS,UAAT,CAAL,EAA2B;QAC1B,IAAMnB,KAAK,GAAG,KAAKmB,GAAL,CAAS,OAAT,CAAd;QACA,IAAMjB,KAAK,GAAG,KAAKiB,GAAL,CAAS,OAAT,CAAd;;QAEA,IAAIjB,KAAK,CAACkB,MAAN,CAAgC,cAAhC,KAAmDlB,KAAK,CAACkB,MAAN,CAA4B,UAA5B,CAAvD,EAAgG;UAC/F,KAAKjB,GAAL,CAAS,UAAT,EAAqBD,KAArB;QACA,CAFD,MAGK;UACJ,KAAKC,GAAL,CAAS,UAAT,EAAqBH,KAArB;QACA;MACD;;MAED,KAAKqB,MAAL,CAAYC,MAAZ,CAAmB,QAAnB,EAAkC;QAAEC,OAAO,EAAE,CAAX;QAAcC,OAAO,EAAE;MAAvB,CAAlC;;MAEA,KAAKC,eAAL;IACA;;;;;;WAED,UAA4Bb,SAA5B,EAA6D;MAC5D,IAAMc,SAAS,GAAGnD,SAAS,CAACe,GAAV,CAAc,KAAKC,KAAnB,EAA0B,EAA1B,CAAlB;MACAqB,SAAS,CAACc,SAAV,GAAsBA,SAAtB;MACA,KAAKtC,QAAL,CAAcC,IAAd,CAAmBqC,SAAnB;MAEAd,SAAS,CAACX,MAAV,GAAmB,IAAnB;MAEA,IAAM0B,YAAY,GAAGf,SAAS,CAACe,YAA/B;MACAA,YAAY,CAACC,MAAb,CAAoB,SAApB,EAA+B,IAA/B;MAEA,IAAMC,IAAI,GAAuBF,YAAY,CAACG,SAA9C;;MACA,IAAID,IAAJ,EAAU;QACTA,IAAI,CAACf,iBAAL,CAAuBa,YAAvB,EAAqC,CAAC,OAAD,EAAU,QAAV,CAArC;;QAEA,IAAMI,MAAM,GAAGJ,YAAY,CAACR,GAAb,CAAiB,QAAjB,CAAf;;QACA,IAAIY,MAAJ,EAAY;UACX,IAAMC,MAAM,GAAGD,MAAM,CAACZ,GAAP,CAAW,QAAX,CAAf;;UACA,IAAIa,MAAJ,EAAY;YACXA,MAAM,CAACC,UAAP,CAAkB,SAAlB,EAA6B,KAA7B;UACA;QACD;;QACD,IAAMC,QAAQ,GAAGP,YAAY,CAACR,GAAb,CAAiB,UAAjB,CAAjB;;QACA,IAAIe,QAAJ,EAAc;UACbR,SAAS,CAACvB,GAAV,CAAc,MAAd,EAAsB+B,QAAtB;QACA;;QACDL,IAAI,CAACM,iBAAL,CAAuB9C,IAAvB,CAA4BsC,YAA5B;MACA;IACD;;;;;;WAED,UAA2Bf,SAA3B,EAA4D;MAC3D,IAAMe,YAAY,GAAGf,SAAS,CAACe,YAA/B;MACA,IAAME,IAAI,GAAuBF,YAAY,CAACG,SAA9C;MACAD,IAAI,CAACO,eAAL,CAAqBT,YAArB;MAEAhD,MAAM,CAAC0D,MAAP,CAAcR,IAAI,CAACM,iBAAnB,EAAsCR,YAAtC;MAEA,IAAMD,SAAS,GAAGd,SAAS,CAACc,SAA5B;;MACA,IAAIA,SAAJ,EAAe;QACdA,SAAS,CAACY,OAAV;MACA;IACD;;;;;;WAED;MAAA;;MACC1C,iBAAM2C,aAAN,CAAmBzC,IAAnB,CAAmB,IAAnB;;MAEA,KAAK0C,aAAL,GAAqB,EAArB;MACA,KAAKC,aAAL,GAAqB,EAArB;MACA,KAAKC,iBAAL,GAAyB,EAAzB;MACA,KAAKC,iBAAL,GAAyB,EAAzB;MAEA,KAAKC,kBAAL,GAA0B,EAA1B;MACA,KAAKC,kBAAL,GAA0B,EAA1B;;MAEA,IAAI,KAAKC,YAAT,EAAuB;QACtBnE,MAAM,CAAC+B,IAAP,CAAY,KAAKoC,YAAjB,EAAiE,UAACC,GAAD,EAAI;UACpE,IAAMC,KAAK,GAAG7D,KAAI,CAACgC,GAAL,CAAe4B,GAAG,GAAG,OAArB,CAAd;;UACA,IAAIC,KAAJ,EAAW;YACV7D,KAAI,CAACqD,aAAL,CAAmBnD,IAAnB,CAA6B0D,GAA7B;;YACA,IAAIE,OAAK,GAAG9D,KAAI,CAACgC,GAAL,CAAe4B,GAAG,GAAG,MAArB,CAAZ;;YACA5D,KAAI,CAACyD,kBAAL,CAAwBvD,IAAxB,CAA6B4D,OAA7B;;YAEA,IAAIA,OAAK,CAACC,OAAN,CAAc,SAAd,KAA4B,CAAC,CAAjC,EAAoC;cACnC/D,KAAI,CAACuD,iBAAL,CAAuBrD,IAAvB,CAA4B4D,OAAK,CAACE,KAAN,CAAY,SAAZ,EAAuB,CAAvB,CAA5B;YACA,CAFD,MAGK;cACJhE,KAAI,CAACwD,iBAAL,CAAuBtD,IAAvB,CAA4B4D,OAA5B;YACA;UACD;QACD,CAdD;MAeA;;MAED,IAAI,KAAKG,YAAT,EAAuB;QACtBzE,MAAM,CAAC+B,IAAP,CAAY,KAAK0C,YAAjB,EAAiE,UAACL,GAAD,EAAI;UACpE,IAAMC,KAAK,GAAG7D,KAAI,CAACgC,GAAL,CAAe4B,GAAG,GAAG,OAArB,CAAd;;UAEA,IAAIC,KAAJ,EAAW;YACV7D,KAAI,CAACsD,aAAL,CAAmBpD,IAAnB,CAA6B0D,GAA7B;;YACA,IAAIM,OAAK,GAAGlE,KAAI,CAACgC,GAAL,CAAe4B,GAAG,GAAG,MAArB,CAAZ;;YACA5D,KAAI,CAAC0D,kBAAL,CAAwBxD,IAAxB,CAA6BgE,OAA7B;;YAEA,IAAIA,OAAK,CAACH,OAAN,CAAc,SAAd,KAA4B,CAAC,CAAjC,EAAoC;cACnC/D,KAAI,CAACwD,iBAAL,CAAuBtD,IAAvB,CAA4BgE,OAAK,CAACF,KAAN,CAAY,SAAZ,EAAuB,CAAvB,CAA5B;YACA,CAFD,MAGK;cACJhE,KAAI,CAACwD,iBAAL,CAAuBtD,IAAvB,CAA4BgE,OAA5B;YACA;UACD;QACD,CAfD;MAgBA;IACD;;;;;;WAED;MACCzD,iBAAM0D,QAAN,CAAcxD,IAAd,CAAc,IAAd;;MAEA,IAAMyD,KAAK,GAAG,KAAKA,KAAnB;;MACA,IAAIA,KAAJ,EAAW;QACVA,KAAK,CAACtD,MAAN,CAAauD,WAAb,CAAyB,IAAzB;MACA;;MAED7E,MAAM,CAAC8E,WAAP,CAAmB,KAAKtC,GAAL,CAAS,OAAT,EAAkBlB,MAArC,EAA6C,IAA7C;MACAtB,MAAM,CAAC8E,WAAP,CAAmB,KAAKtC,GAAL,CAAS,OAAT,EAAkBlB,MAArC,EAA6C,IAA7C;IACA;KA3QF,CA6QC;;;;;;WACA,UAA2D8C,GAA3D,EAAqE9B,KAArE,EAA8F;MAC7F,IAAIF,QAAQ,GAAGlC,GAAG,CAAC,KAAK6E,UAAL,CAAgBX,GAAhB,CAAD,EAA8B9B,KAA9B,CAAlB;MACA,KAAKgB,UAAL,CAAgBc,GAAhB,EAAqBhC,QAArB;IACA;KAjRF,CAmRC;;;;;;WACA,UAA2DgC,GAA3D,EAAqE9B,KAArE,EAA8F;MAC7F,IAAIF,QAAQ,GAAG/B,GAAG,CAAC,KAAK0E,UAAL,CAAgBX,GAAhB,CAAD,EAA8B9B,KAA9B,CAAlB;MACA,KAAKgB,UAAL,CAAgBc,GAAhB,EAAqBhC,QAArB;IACA;;;;;;WAED,UAA4B4C,QAA5B,EAAyE;MACxE,IAAI,CAAC,KAAKxC,GAAL,CAAS,OAAT,EAAkByC,MAAnB,IAA6B,CAAC,KAAKzC,GAAL,CAAS,OAAT,EAAkByC,MAApD,EAA4D;QAC3D,OAAO,KAAP;MACA;;MACD,IAAID,QAAQ,CAACxC,GAAT,CAAa,KAAK0C,OAAlB,KAAqC,IAArC,IAA6CF,QAAQ,CAACxC,GAAT,CAAa,KAAK2C,OAAlB,KAAqC,IAAtF,EAA4F;QAC3F,OAAO,IAAP;MACA;;MACD,OAAO,KAAP;IACA;;;;;;WAED;MACC,IAAM9D,KAAK,GAAG,KAAKmB,GAAL,CAAS,OAAT,CAAd;MACA,IAAMjB,KAAK,GAAG,KAAKiB,GAAL,CAAS,OAAT,CAAd;MACA,IAAM4C,KAAK,GAAG/D,KAAK,CAAC0D,UAAN,CAAiB,MAAjB,CAAd;MACA,IAAMM,QAAQ,GAAGpF,MAAM,CAACqF,eAAP,CAAuBF,KAAvB,CAAjB;MAEA,IAAMG,KAAK,GAAGhE,KAAK,CAACwD,UAAN,CAAiB,MAAjB,CAAd;MACA,IAAMS,QAAQ,GAAGvF,MAAM,CAACqF,eAAP,CAAuBC,KAAvB,CAAjB;MAEA,IAAME,OAAO,GAAGpE,KAAK,CAACmB,GAAN,CAAU,UAAV,EAAsBuC,UAAtB,CAAiC,QAAjC,CAAhB;MACA,IAAMW,OAAO,GAAGnE,KAAK,CAACiB,GAAN,CAAU,UAAV,EAAsBuC,UAAtB,CAAiC,QAAjC,CAAhB;MAEA,IAAMY,IAAI,GAAG,MAAb;MACA,IAAMC,GAAG,GAAG,KAAZ;MACA,IAAMC,IAAI,GAAG,MAAb;MACA,IAAMC,IAAI,GAAG,MAAb;;MAEA,IAAIzE,KAAK,CAAC0E,SAAN,KAAoB,WAAxB,EAAqC;QACpC,KAAKb,OAAL,GAAe,KAAK1C,GAAL,CAAe4C,KAAK,GAAGK,OAAR,GAAmBK,IAAlC,CAAf;QACA,KAAKE,WAAL,GAAmB,KAAKxD,GAAL,CAAemD,IAAI,GAAGN,QAAP,GAAkBI,OAAlB,GAA6BK,IAA5C,CAAnB;QACA,KAAKG,UAAL,GAAkB,KAAKzD,GAAL,CAAeoD,GAAG,GAAGP,QAAN,GAAiBI,OAAjB,GAA4BK,IAA3C,CAAlB;QACA,KAAKI,WAAL,GAAmB,KAAK1D,GAAL,CAAeqD,IAAI,GAAGR,QAAP,GAAkBI,OAAlB,GAA6BK,IAA5C,CAAnB;MACA,CALD,MAMK;QACJ,KAAKZ,OAAL,GAAqBE,KAAK,GAAGK,OAA7B;QACA,KAAKO,WAAL,GAAyBL,IAAI,GAAGN,QAAP,GAAkBI,OAA3C;QACA,KAAKQ,UAAL,GAAwBL,GAAG,GAAGP,QAAN,GAAiBI,OAAzC;QACA,KAAKS,WAAL,GAAyBL,IAAI,GAAGR,QAAP,GAAkBI,OAA3C;MACA;;MAED,IAAIlE,KAAK,CAACwE,SAAN,KAAoB,WAAxB,EAAqC;QACpC,KAAKZ,OAAL,GAAe,KAAK3C,GAAL,CAAe+C,KAAK,GAAGG,OAAR,GAAmBI,IAAlC,CAAf;QACA,KAAKK,WAAL,GAAmB,KAAK3D,GAAL,CAAemD,IAAI,GAAGH,QAAP,GAAkBE,OAAlB,GAA6BI,IAA5C,CAAnB;QACA,KAAKM,UAAL,GAAkB,KAAK5D,GAAL,CAAeoD,GAAG,GAAGJ,QAAN,GAAiBE,OAAjB,GAA4BI,IAA3C,CAAlB;QACA,KAAKO,WAAL,GAAmB,KAAK7D,GAAL,CAAeqD,IAAI,GAAGL,QAAP,GAAkBE,OAAlB,GAA6BI,IAA5C,CAAnB;MACA,CALD,MAMK;QACJ,KAAKX,OAAL,GAAqBI,KAAK,GAAGG,OAA7B;QACA,KAAKS,WAAL,GAAyBR,IAAI,GAAGH,QAAP,GAAkBE,OAA3C;QACA,KAAKU,UAAL,GAAwBR,GAAG,GAAGJ,QAAN,GAAiBE,OAAzC;QACA,KAAKW,WAAL,GAAyBR,IAAI,GAAGL,QAAP,GAAkBE,OAA3C;MACA;IACD;;;;;;WAED;MACC,IAAMrE,KAAK,GAAG,KAAKmB,GAAL,CAAS,OAAT,CAAd;MACA,IAAMjB,KAAK,GAAG,KAAKiB,GAAL,CAAS,OAAT,CAAd;MACA,IAAM8D,QAAQ,GAAG,KAAK9D,GAAL,CAAS,UAAT,CAAjB;MACA,IAAM+D,WAAW,GAAG,KAAK7D,MAAL,CAAY8D,MAAZ,CAAmB,QAAnB,CAApB;MACA,IAAMC,sBAAsB,GAAG,KAAKjE,GAAL,CAAS,wBAAT,CAA/B;;MAEA,IAAI+D,WAAJ,EAAiB;QAChB,IAAIjE,KAAK,GAAG,CAAZ;;QACA,IAAImE,sBAAJ,EAA4B;UAC3BnE,KAAK,GAAG,cAAR,CAD2B,CACH;QACxB;;QAED,IAAIjB,KAAK,KAAKiF,QAAd,EAAwB;UACvBC,WAAW,CAAC/E,GAAZ,CAAgB,KAAhB,EAAuBc,KAAvB;QACA,CAFD,MAGK,IAAIf,KAAK,KAAK+E,QAAd,EAAwB;UAC5BC,WAAW,CAAC/E,GAAZ,CAAgB,KAAhB,EAAuBc,KAAvB;QACA,CAFI,MAGA;UACJiE,WAAW,CAAC/E,GAAZ,CAAgB,KAAhB,EAAuBc,KAAvB;UACAiE,WAAW,CAAC/E,GAAZ,CAAgB,KAAhB,EAAuBc,KAAvB;QACA;MACD;IACD;;;;;;WAGD;MACC,IAAI,KAAKoE,OAAL,CAAa,aAAb,CAAJ,EAAiC;QAChC,KAAKC,gBAAL,CAAsBnF,GAAtB,CAA0B,aAA1B,EAAyC,KAAKgB,GAAL,CAAS,aAAT,CAAzC;MACA;IACD;;;;;;WAGD;MAAA;;MACCvB,iBAAM2F,gBAAN,CAAsBzF,IAAtB,CAAsB,IAAtB;;MAEA,IAAI,KAAKuF,OAAL,CAAa,YAAb,KAA8B,KAAKA,OAAL,CAAa,gBAAgB,KAAKA,OAAL,CAAa,gBAAb,CAAhB,IAAkD,KAAKA,OAAL,CAAa,gBAAb,CAAlD,IAAoF,KAAKA,OAAL,CAAa,eAAb,CAApF,IAAqH,KAAKA,OAAL,CAAa,eAAb,CAArH,IAAsJ,KAAKA,OAAL,CAAa,gBAAb,CAAtJ,IAAwL,KAAKA,OAAL,CAAa,gBAAb,CAArM,CAAlC,EAAwQ;QACvQ,KAAK9C,aAAL;;QACA,KAAKd,eAAL;;QACA,KAAK+D,YAAL,GAAoB,IAApB;MACA;;MAED,KAAKrF,GAAL,CAAS,OAAT,EAAkB,KAAKgB,GAAL,CAAS,OAAT,EAAkBsE,KAAlB,EAAlB;MACA,KAAKtF,GAAL,CAAS,QAAT,EAAmB,KAAKgB,GAAL,CAAS,OAAT,EAAkBuE,MAAlB,EAAnB;;MAEA,KAAKC,kBAAL;;MAEA,IAAM3F,KAAK,GAAG,KAAKmB,GAAL,CAAS,OAAT,CAAd;MACA,IAAMjB,KAAK,GAAG,KAAKiB,GAAL,CAAS,OAAT,CAAd;MACA,IAAM8D,QAAQ,GAAG,KAAK9D,GAAL,CAAS,UAAT,CAAjB;MAEA,IAAMyE,gBAAgB,GAAG,KAAKzE,GAAL,CAAS,kBAAT,CAAzB;MACA,IAAI0E,aAAJ;;MAEA,QAAQD,gBAAR;QACC,KAAK,MAAL;UACCC,aAAa,GAAG,KAAKlB,WAArB;UACA;;QACD,KAAK,KAAL;UACCkB,aAAa,GAAG,KAAKjB,UAArB;UACA;;QACD,KAAK,MAAL;UACCiB,aAAa,GAAG,KAAKhB,WAArB;UACA;;QACD;UACCgB,aAAa,GAAG,KAAKhC,OAArB;MAXF;;MAaA,KAAKiC,cAAL,GAAsBD,aAAtB;MAEA,IAAME,gBAAgB,GAAG,KAAK5E,GAAL,CAAS,kBAAT,CAAzB;MACA,IAAI6E,aAAJ;;MACA,QAAQD,gBAAR;QACC,KAAK,MAAL;UACCC,aAAa,GAAG,KAAKlB,WAArB;UACA;;QACD,KAAK,KAAL;UACCkB,aAAa,GAAG,KAAKjB,UAArB;UACA;;QACD,KAAK,MAAL;UACCiB,aAAa,GAAG,KAAKhB,WAArB;UACA;;QACD;UACCgB,aAAa,GAAG,KAAKlC,OAArB;MAXF;;MAaA,KAAKmC,cAAL,GAAsBD,aAAtB;;MAEA,IAAI,KAAKX,OAAL,CAAa,UAAb,CAAJ,EAA8B;QAC7B,KAAKa,MAAL;MACA;;MAGD,KAAK/F,GAAL,CAAS,GAAT,EAAcH,KAAK,CAACmG,CAAN,KAAYvH,MAAM,CAACwH,eAAP,CAAuBpG,KAAK,CAACmB,GAAN,CAAU,SAAV,EAAqB,CAArB,CAAvB,EAAgDnB,KAAK,CAACyF,KAAN,EAAhD,CAAZ,GAA6EzF,KAAK,CAACqG,MAAN,CAAclF,GAAd,CAAkB,aAAlB,EAAiC,CAAjC,CAA3F;MACA,KAAKhB,GAAL,CAAS,GAAT,EAAcD,KAAK,CAACoG,CAAN,KAAY1H,MAAM,CAACwH,eAAP,CAAuBlG,KAAK,CAACiB,GAAN,CAAU,SAAV,EAAqB,CAArB,CAAvB,EAAgDjB,KAAK,CAACwF,MAAN,EAAhD,CAAZ,GAA8ExF,KAAK,CAACmG,MAAN,CAAclF,GAAd,CAAkB,YAAlB,EAAgC,CAAhC,CAA5F;MACA,KAAKmE,gBAAL,CAAsBnF,GAAtB,CAA0B,GAA1B,EAA+B,KAAKmG,CAAL,EAA/B;MACA,KAAKhB,gBAAL,CAAsBnF,GAAtB,CAA0B,GAA1B,EAA+B,KAAKgG,CAAL,EAA/B;MAEA,IAAMI,OAAO,GAAG,KAAKpF,GAAL,CAAS,SAAT,CAAhB;;MAEA,IAAI,KAAKkE,OAAL,CAAa,SAAb,CAAJ,EAA6B;QAC5B,IAAIkB,OAAJ,EAAa;UACZ,IAAI,KAAKf,YAAL,IAAqB,CAAC,KAAKgB,cAA/B,EAA+C,CAE9C,CAFD,MAGK;YACJ,KAAKC,MAAL;UACA;QACD,CAPD,MAQK;UACJ,KAAKC,QAAL;QACA;MACD;;MAED,IAAI,KAAKlB,YAAL,IAAqB,CAAC,KAAKgB,cAA/B,EAA+C;QAC9C,KAAKA,cAAL,GAAsB,IAAtB;;QAEA,IAAID,OAAJ,EAAa;UACZ,KAAKE,MAAL;QACA;;QAED9H,MAAM,CAAC+B,IAAP,CAAY,KAAKiG,SAAjB,EAA4B,UAAChD,QAAD,EAAS;UACpChF,MAAM,CAAC+B,IAAP,CAAYvB,KAAI,CAACuD,iBAAjB,EAAoC,UAACK,GAAD,EAAI;YACvC,IAAI9B,KAAK,GAAG0C,QAAQ,CAACxC,GAAT,CAAkB4B,GAAlB,CAAZ;;YACA,IAAI9B,KAAK,IAAI,IAAb,EAAmB;cAClB,IAAIsF,OAAJ,EAAa;gBACZtF,KAAK,IAAI9B,KAAI,CAACyH,gBAAL,CAAsBjD,QAAtB,EAAgCZ,GAAhC,CAAT;cACA;;cAED5D,KAAI,CAAC0H,IAAL,CAAU,MAAV,EAAkB5F,KAAlB;;cACA9B,KAAI,CAAC2H,IAAL,CAAU,MAAV,EAAkB7F,KAAlB;YACA;UACD,CAVD;UAYAtC,MAAM,CAAC+B,IAAP,CAAYvB,KAAI,CAACwD,iBAAjB,EAAoC,UAACI,GAAD,EAAI;YACvC,IAAI9B,KAAK,GAAG0C,QAAQ,CAACxC,GAAT,CAAkB4B,GAAlB,CAAZ;;YACA,IAAI9B,KAAK,IAAI,IAAb,EAAmB;cAClB,IAAIsF,OAAJ,EAAa;gBACZtF,KAAK,IAAI9B,KAAI,CAAC4H,gBAAL,CAAsBpD,QAAtB,EAAgCZ,GAAhC,CAAT;cACA;;cAED5D,KAAI,CAAC0H,IAAL,CAAU,MAAV,EAAkB5F,KAAlB;;cACA9B,KAAI,CAAC2H,IAAL,CAAU,MAAV,EAAkB7F,KAAlB;YACA;UACD,CAVD;UAYAjB,KAAK,CAACgH,qBAAN,CAA4BrD,QAA5B,EAAsCxE,KAAI,CAACqD,aAA3C;UACAtC,KAAK,CAAC8G,qBAAN,CAA4BrD,QAA5B,EAAsCxE,KAAI,CAACsD,aAA3C;QACA,CA3BD;QA6BAzC,KAAK,CAACiH,kBAAN,GAA2B,IAA3B;QACA/G,KAAK,CAAC+G,kBAAN,GAA2B,IAA3B;;QAEA,IAAI,CAAC,KAAK9F,GAAL,CAAS,cAAT,CAAL,EAA+B;UAC9B,IAAI,KAAK+F,cAAL,CAAoB,MAApB,KAA+B,KAAKA,cAAL,CAAoB,MAApB,CAAnC,EAAgE;YAC/DlH,KAAK,CAACmH,iBAAN;UACA;;UACD,IAAI,KAAKD,cAAL,CAAoB,MAApB,KAA+B,KAAKA,cAAL,CAAoB,MAApB,CAAnC,EAAgE;YAC/DhH,KAAK,CAACiH,iBAAN;UACA;QACD;;QAED,KAAKC,qBAAL,GAhD8C,CAkD9C;;;QACA,KAAKC,iBAAL,CAAuB7H,SAAvB;MACA;;MAED,IAAI,KAAK6F,OAAL,CAAa,KAAb,KAAuB,KAAKA,OAAL,CAAa,KAAb,CAA3B,EAAgD;QAC/C,KAAK+B,qBAAL;MACA;;MAED,IAAI,CAAC,KAAKE,YAAV,EAAwB;QACvBtH,KAAK,CAACuH,gBAAN,CAAuB,IAAvB;;QACArH,KAAK,CAACqH,gBAAN,CAAuB,IAAvB;;QACA,KAAKD,YAAL,GAAoB,IAApB;MACA;;MAED,IAAI,KAAK9B,YAAL,IAAqB,KAAK0B,cAAL,CAAoB,YAApB,CAArB,IAA0D,KAAKA,cAAL,CAAoB,UAApB,CAA1D,IAA6F,KAAK7B,OAAL,CAAa,KAAb,CAA7F,IAAoH,KAAKA,OAAL,CAAa,KAAb,CAApH,IAA2I,KAAKmC,WAApJ,EAAiK;QAEhK,IAAIC,UAAU,GAAG,KAAKA,UAAL,EAAjB;QACA,IAAIC,QAAQ,GAAG,KAAKA,QAAL,EAAf;QACA,IAAIC,iBAAiB,GAAG,KAAKxG,GAAL,CAAS,mBAAT,EAA8B,CAA9B,CAAxB;;QACA,IAAIwG,iBAAiB,GAAG,CAApB,IAAyB1C,QAA7B,EAAuC;UACtC,IAAIA,QAAQ,CAAC9D,GAAT,CAAa,UAAb,EAAyByG,UAAzB,MAAyCF,QAAQ,GAAGD,UAApD,IAAkEE,iBAAtE,EAAyF;YACxF,KAAKE,YAAL,GAAoB,IAApB;UACA,CAFD,MAGK;YACJ,KAAKA,YAAL,GAAoB,KAApB;UACA;QACD;;QAED,IAAI,CAAC,KAAKC,IAAL,IAAaL,UAAb,IAA2B,KAAKM,IAAL,IAAaL,QAAxC,IAAoD,KAAKrC,OAAL,CAAa,KAAb,CAApD,IAA2E,KAAKA,OAAL,CAAa,KAAb,CAA3E,IAAkG,KAAKmC,WAAvG,IAAsH,KAAKhC,YAA5H,KAA6I,CAAC,KAAKwC,mBAAvJ,EAA4K;UAC3K,KAAKA,mBAAL,GAA2B,IAA3B;UAEA,IAAMC,GAAG,GAAG,KAAK9G,GAAL,CAAS,KAAT,EAAgB,CAAhB,CAAZ;UACA,IAAM+G,GAAG,GAAG,KAAK/G,GAAL,CAAS,KAAT,EAAgB,CAAhB,CAAZ;UACA,IAAMgH,SAAO,GAAG,KAAKhH,GAAL,CAAS,SAAT,EAAoB,KAApB,CAAhB;UACA,IAAMiH,cAAc,GAAG,KAAK1E,UAAL,CAAgB,gBAAhB,CAAvB;;UAEA,IAAIuB,QAAQ,KAAKjF,KAAjB,EAAwB;YACvBE,KAAK,CAACmI,gBAAN;;YACA,KAAKC,aAAL,CAAmB,eAAnB,EAAoC9I,SAApC;YACA,KAAK8I,aAAL,CAAmB,eAAnB,EAAoC9I,SAApC;;YACA,IAAI,CAAC4I,cAAL,EAAqB;cACpB,KAAK,IAAIG,CAAC,GAAGd,UAAb,EAAyBc,CAAC,GAAGb,QAA7B,EAAuCa,CAAC,EAAxC,EAA4C;gBAC3C,KAAKC,yBAAL,CAA+B,KAAK7B,SAAL,CAAe4B,CAAf,CAA/B,EAAkDL,GAAlD,EAAuDC,SAAvD;cACA;YACD,CAJD,MAKK;cACJjI,KAAK,CAACuI,0BAAN;YACA;UACD,CAZD,MAaK,IAAIxD,QAAQ,KAAK/E,KAAjB,EAAwB;YAC5BF,KAAK,CAACqI,gBAAN;;YACA,KAAKC,aAAL,CAAmB,eAAnB,EAAoC9I,SAApC;YACA,KAAK8I,aAAL,CAAmB,eAAnB,EAAoC9I,SAApC;;YACA,IAAI,CAAC4I,cAAL,EAAqB;cACpB,KAAK,IAAIG,CAAC,GAAGd,UAAb,EAAyBc,CAAC,GAAGb,QAA7B,EAAuCa,CAAC,EAAxC,EAA4C;gBAC3C,KAAKG,yBAAL,CAA+B,KAAK/B,SAAL,CAAe4B,CAAf,CAA/B,EAAkDN,GAAlD,EAAuDE,SAAvD;cACA;YACD,CAJD,MAKK;cACJjI,KAAK,CAACuI,0BAAN;YACA;UACD;;UAED,IAAIxD,QAAQ,KAAKjF,KAAjB,EAAwB;YACvB,IAAI,KAAKmB,GAAL,CAAS,YAAT,MAA2B,eAA/B,EAAgD;cAC/C,IAAMwH,aAAa,GAAG,KAAKjF,UAAL,CAAgB,eAAhB,CAAtB;;cACA,IAAIiF,aAAa,IAAI,IAArB,EAA2B;gBAC1B,KAAKL,aAAL,CAAmB,MAAnB,EAA2BK,aAA3B;gBACAzI,KAAK,CAACiH,iBAAN;cACA;;cACD,IAAMyB,aAAa,GAAG,KAAKlF,UAAL,CAAgB,eAAhB,CAAtB;;cACA,IAAIkF,aAAa,IAAI,IAArB,EAA2B;gBAC1B,KAAKN,aAAL,CAAmB,MAAnB,EAA2BM,aAA3B;gBACA1I,KAAK,CAACiH,iBAAN;cACA;YACD;UACD,CAbD,MAcK,IAAIlC,QAAQ,KAAK/E,KAAjB,EAAwB;YAC5B,IAAI,KAAKiB,GAAL,CAAS,YAAT,MAA2B,eAA/B,EAAgD;cAC/C,IAAM0H,aAAa,GAAG,KAAKnF,UAAL,CAAgB,eAAhB,CAAtB;;cACA,IAAImF,aAAa,IAAI,IAArB,EAA2B;gBAC1B,KAAKP,aAAL,CAAmB,MAAnB,EAA2BO,aAA3B;gBACA3I,KAAK,CAACiH,iBAAN;cACA;;cACD,IAAM2B,aAAa,GAAG,KAAKpF,UAAL,CAAgB,eAAhB,CAAtB;;cACA,IAAIoF,aAAa,IAAI,IAArB,EAA2B;gBAC1B,KAAKR,aAAL,CAAmB,MAAnB,EAA2BQ,aAA3B;gBACA9I,KAAK,CAACmH,iBAAN;cACA;YACD;UACD;;UAED,IAAI,KAAKD,cAAL,CAAoB,eAApB,KAAwC,KAAKA,cAAL,CAAoB,eAApB,CAA5C,EAAkF;YACjFlH,KAAK,CAACyI,0BAAN;UACA;;UAED,IAAI,KAAKvB,cAAL,CAAoB,eAApB,KAAwC,KAAKA,cAAL,CAAoB,eAApB,CAA5C,EAAkF;YACjFhH,KAAK,CAACuI,0BAAN;UACA,CAtE0K,CAuE3K;;QACA;MACD;IACD;;;;;;WAGD;MAAA;;MACC,IAAI,KAAKpI,UAAL,CAAgB0I,MAAhB,GAAyB,CAA7B,EAAgC;QAC/B,IAAIC,mBAAiB,GAAG,KAAKC,kBAA7B;;QACA,IAAID,mBAAiB,IAAI,IAAzB,EAA+B;UAC9BA,mBAAiB,GAAG,KAAK5J,QAAL,CAAcC,IAAd,CAAmBb,QAAQ,CAACc,GAAT,CAAa,KAAKC,KAAlB,EAAyB,EAAzB,CAAnB,CAApB;UACA,KAAK0J,kBAAL,GAA0BD,mBAA1B;UAEAA,mBAAiB,CAAC7I,GAAlB,CAAsB,MAAtB,EAA8B,UAAC+I,OAAD,EAAUC,MAAV,EAAgB;YAC7C,IAAM9C,MAAM,GAAGlH,KAAI,CAACkH,MAApB;;YACA,IAAIA,MAAJ,EAAY;cACX,IAAM+C,CAAC,GAAGjK,KAAI,CAACI,KAAL,CAAWmC,SAAX,CAAqB+D,KAArB,EAAV;;cACA,IAAM4D,CAAC,GAAGlK,KAAI,CAACI,KAAL,CAAWmC,SAAX,CAAqBgE,MAArB,EAAV;;cACAwD,OAAO,CAACI,MAAR,CAAe,CAACF,CAAhB,EAAmB,CAACC,CAApB;cACAH,OAAO,CAACK,MAAR,CAAe,CAACH,CAAhB,EAAmBC,CAAC,GAAG,CAAvB;cACAH,OAAO,CAACK,MAAR,CAAeH,CAAC,GAAG,CAAnB,EAAsBC,CAAC,GAAG,CAA1B;cACAH,OAAO,CAACK,MAAR,CAAeH,CAAC,GAAG,CAAnB,EAAsB,CAACC,CAAvB;cACAH,OAAO,CAACK,MAAR,CAAe,CAACH,CAAhB,EAAmB,CAACC,CAApB;;cAGAlK,KAAI,CAACkB,UAAL,CAAgBK,IAAhB,CAAqB,UAACE,SAAD,EAAU;gBAC9B,IAAM4I,IAAI,GAAG5I,SAAS,CAACe,YAAV,CAAuBR,GAAvB,CAA2B,UAA3B,CAAb;;gBAEA,IAAIkF,MAAJ,EAAY;kBACX,IAAImD,IAAJ,EAAU;oBACT,IAAIC,IAAI,GAAGD,IAAI,CAACrI,GAAL,CAAS,MAAT,CAAX;;oBACA,IAAIsI,IAAJ,EAAU;sBACTA,IAAI,CAACP,OAAD,EAAUC,MAAV,CAAJ;oBACA;kBACD;gBACD;cACD,CAXD;YAYA;;YACDhK,KAAI,CAACuK,aAAL,CAAmBC,QAAnB,CAA4BC,IAA5B,GAAmCZ,mBAAkB,CAACW,QAAtD;UACA,CA1BD;QA2BA;;QAEDX,mBAAiB,CAACa,SAAlB;;QACAb,mBAAiB,CAACc,aAAlB,CAAgC,MAAhC;MACA,CArCD,MAsCK;QACJ,KAAKJ,aAAL,CAAmBC,QAAnB,CAA4BC,IAA5B,GAAmC,IAAnC;MACA;IACD;;;;;;WAGD;MACChK,iBAAMmK,eAAN,CAAqBjK,IAArB,CAAqB,IAArB,EADD,CAEC;;;MACA,KAAKkK,EAAL,GAAU,KAAK7D,CAAL,EAAV;MACA,KAAK8D,EAAL,GAAU,KAAK3D,CAAL,EAAV;;MACA,KAAK4D,cAAL;IACA;;;;;;WAED;MACC,IAAM3G,KAAK,GAAG,KAAKA,KAAnB;;MACA,IAAIA,KAAJ,EAAW;QACV,IAAM4G,WAAW,GAAG5G,KAAK,CAACtD,MAAN,CAAaiD,OAAb,CAAqB,IAArB,CAApB;QAEA,KAAKkH,aAAL,GAAqB,EAArB;;QAEA,IAAID,WAAW,GAAG,CAAlB,EAAqB;UACpB,IAAIlK,MAAM,SAAV;;UAEA,KAAK,IAAIsI,CAAC,GAAG4B,WAAW,GAAG,CAA3B,EAA8B5B,CAAC,IAAI,CAAnC,EAAsCA,CAAC,EAAvC,EAA2C;YAC1CtI,MAAM,GAAGsD,KAAK,CAACtD,MAAN,CAAaoK,QAAb,CAAsB9B,CAAtB,CAAT;;YACA,IAAItI,MAAM,CAACkB,GAAP,CAAW,OAAX,MAAwB,KAAKA,GAAL,CAAS,OAAT,CAAxB,IAA6ClB,MAAM,CAACkB,GAAP,CAAW,OAAX,MAAwB,KAAKA,GAAL,CAAS,OAAT,CAArE,IAA0FlB,MAAM,CAACyE,SAAP,KAAqB,KAAKA,SAAxH,EAAmI;cAClI,KAAK0F,aAAL,CAAmB/K,IAAnB,CAAwBY,MAAxB;;cACA,IAAI,CAACA,MAAM,CAACkB,GAAP,CAAW,SAAX,CAAL,EAA4B;gBAC3B;cACA;YACD;UACD;QACD;;QAED,KAAKmJ,eAAL;MACA;IACD;;;;;;WAED;MAAA;;MACC5L,OAAO,CAACgC,IAAR,CAAa,KAAK6J,gBAAlB,EAAoC,UAACC,IAAD,EAAOvJ,KAAP,EAAY;QAC/C,OAAQA,KAAK,CAACwJ,cAAN,CAAqBtL,KAAI,CAACuL,GAA1B,CAAR;MACA,CAFD;MAIA,KAAKH,gBAAL,GAAwB,EAAxB;MACA5L,MAAM,CAAC+B,IAAP,CAAY,KAAKiG,SAAjB,EAA4B,UAAChD,QAAD,EAAS;QACpCA,QAAQ,CAAC/B,MAAT,CAAgB,cAAhB,EAAgCpC,SAAhC;QACAmE,QAAQ,CAAC/B,MAAT,CAAgB,cAAhB,EAAgCpC,SAAhC;MACA,CAHD;IAIA;;;;;;WAED;MAAA,kBACC;;;MACA,IAAMyF,QAAQ,GAAG,KAAK9D,GAAL,CAAS,UAAT,CAAjB;MACA,IAAMnB,KAAK,GAAG,KAAKmB,GAAL,CAAS,OAAT,CAAd;MACA,IAAMjB,KAAK,GAAG,KAAKiB,GAAL,CAAS,OAAT,CAAd;MAEA,IAAI6B,KAAJ;MACA,IAAI2H,cAAJ;;MACA,IAAI1F,QAAQ,KAAKjF,KAAjB,EAAwB;QACvBgD,KAAK,GAAG,QAAR;QACA2H,cAAc,GAAG,cAAjB;MACA,CAHD,MAIK,IAAI1F,QAAQ,KAAK/E,KAAjB,EAAwB;QAC5B8C,KAAK,GAAG,QAAR;QACA2H,cAAc,GAAG,cAAjB;MACA;;MAED,IAAIC,GAAG,GAAG,KAAKR,aAAL,CAAmBrB,MAA7B;MACA,IAAI8B,KAAK,GAAG,CAAZ;MACA,IAAMC,eAAe,GAAG,KAAK3J,GAAL,CAAS,iBAAT,CAAxB;MAEA,KAAKoJ,gBAAL,GAAwB,EAAxB;MAEA5L,MAAM,CAAC+B,IAAP,CAAY,KAAKiG,SAAjB,EAA4B,UAAChD,QAAD,EAAS;QACpC,KAAK,IAAIoH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,GAApB,EAAyBG,CAAC,EAA1B,EAA8B;UAC7B,IAAIC,aAAa,GAAG7L,KAAI,CAACiL,aAAL,CAAmBW,CAAnB,CAApB;UACA,IAAIE,WAAW,GAAGD,aAAa,CAACrE,SAAd,CAAwBkE,KAAxB,CAAlB;UACA,IAAI5J,KAAK,GAAG0C,QAAQ,CAACxC,GAAT,CAAa6B,KAAb,CAAZ;;UAEA,IAAIiI,WAAJ,EAAiB;YAChB,IAAIC,UAAU,GAAGD,WAAW,CAAC9J,GAAZ,CAAgB6B,KAAhB,CAAjB;;YACA,IAAI8H,eAAJ,EAAqB;cACpB,IAAIrM,KAAK,CAAC0M,QAAN,CAAelK,KAAf,CAAJ,EAA2B;gBAC1B,IAAIxC,KAAK,CAAC0M,QAAN,CAAeD,UAAf,CAAJ,EAAgC;kBAC/B,IAAIjK,KAAK,IAAI,CAAT,IAAciK,UAAU,IAAI,CAAhC,EAAmC;oBAClCvH,QAAQ,CAAC/B,MAAT,CAAgB+I,cAAhB,EAAgCM,WAAhC;oBACA9L,KAAI,CAACoL,gBAAL,CAAsBS,aAAa,CAACN,GAApC,IAA2CM,aAA3C;oBACAA,aAAa,CAACP,cAAd,CAA6BtL,KAAI,CAACuL,GAAlC,IAAyCvL,KAAzC;oBACA;kBACA;;kBACD,IAAI8B,KAAK,GAAG,CAAR,IAAaiK,UAAU,GAAG,CAA9B,EAAiC;oBAChCvH,QAAQ,CAAC/B,MAAT,CAAgB+I,cAAhB,EAAgCM,WAAhC;oBACA9L,KAAI,CAACoL,gBAAL,CAAsBS,aAAa,CAACN,GAApC,IAA2CM,aAA3C;oBACAA,aAAa,CAACP,cAAd,CAA6BtL,KAAI,CAACuL,GAAlC,IAAyCvL,KAAzC;oBACA;kBACA;gBACD;cACD,CAfD,MAgBK;gBACJ;cACA;YACD,CApBD,MAqBK;cACJ,IAAIV,KAAK,CAAC0M,QAAN,CAAelK,KAAf,KAAyBxC,KAAK,CAAC0M,QAAN,CAAeD,UAAf,CAA7B,EAAyD;gBACxDvH,QAAQ,CAAC/B,MAAT,CAAgB+I,cAAhB,EAAgCM,WAAhC;gBACA9L,KAAI,CAACoL,gBAAL,CAAsBS,aAAa,CAACN,GAApC,IAA2CM,aAA3C;gBACAA,aAAa,CAACP,cAAd,CAA6BtL,KAAI,CAACuL,GAAlC,IAAyCvL,KAAzC;gBACA;cACA;YACD;UACD;QACD;;QAED0L,KAAK;MACL,CAzCD;IA0CA;;;;;;WAED,UAAoClH,QAApC,EAAmFsE,GAAnF,EAAgG1B,OAAhG,EAAgH;MAAhH;;MACC5H,MAAM,CAAC+B,IAAP,CAAY,KAAKkC,kBAAjB,EAAqC,UAACG,GAAD,EAAI;QACxC,IAAI9B,KAAK,GAAG0C,QAAQ,CAACxC,GAAT,CAAkB4B,GAAlB,CAAZ;;QACA,IAAI9B,KAAK,IAAI,IAAb,EAAmB;UAClB,IAAIsF,OAAJ,EAAa;YACZtF,KAAK,IAAI9B,KAAI,CAACiM,uBAAL,CAA6BzH,QAA7B,EAAuCZ,GAAvC,CAAT;UACA;;UAED5D,KAAI,CAAC0H,IAAL,CAAU,eAAV,EAA2B5F,KAA3B;;UACA9B,KAAI,CAAC2H,IAAL,CAAU,eAAV,EAA2B7F,KAAK,GAAGgH,GAAnC;QACA;MACD,CAVD;IAWA;;;;;;WAED,UAAoCtE,QAApC,EAAmFuE,GAAnF,EAAgG3B,OAAhG,EAAgH;MAAhH;;MACC5H,MAAM,CAAC+B,IAAP,CAAY,KAAKmC,kBAAjB,EAAqC,UAACE,GAAD,EAAI;QAExC,IAAI9B,KAAK,GAAG0C,QAAQ,CAACxC,GAAT,CAAkB4B,GAAlB,CAAZ;;QACA,IAAI9B,KAAK,IAAI,IAAb,EAAmB;UAClB,IAAIsF,OAAJ,EAAa;YACZtF,KAAK,IAAI9B,KAAI,CAACkM,uBAAL,CAA6B1H,QAA7B,EAAuCZ,GAAvC,CAAT;UACA;;UAED5D,KAAI,CAAC0H,IAAL,CAAU,eAAV,EAA2B5F,KAA3B;;UACA9B,KAAI,CAAC2H,IAAL,CAAU,eAAV,EAA2B7F,KAAK,GAAGiH,GAAnC;QACA;MACD,CAXD;IAYA;;EAED;;;;;;;;WAGA,UAA+BvE,QAA/B,EAAsEZ,GAAtE,EAAiF;MAChF,IAAMkI,WAAW,GAAGtH,QAAQ,CAACxC,GAAT,CAAa,cAAb,CAApB;;MAEA,IAAI8J,WAAJ,EAAiB;QAChB,IAAMK,eAAe,GAAGL,WAAW,CAACnJ,SAApC;QAEA,OAAOmJ,WAAW,CAAC9J,GAAZ,CAAgB4B,GAAhB,EAA4B,CAA5B,IAAiCuI,eAAe,CAACnK,GAAhB,CAAoB,KAApB,EAA2B,CAA3B,CAAjC,GAAiE,KAAKkK,uBAAL,CAA6BJ,WAA7B,EAA0ClI,GAA1C,CAAxE;MACA;;MACD,OAAO,CAAP;IACA;;EAED;;;;;;;;WAGA,UAA+BY,QAA/B,EAAsEZ,GAAtE,EAAiF;MAChF,IAAMkI,WAAW,GAAGtH,QAAQ,CAACxC,GAAT,CAAa,cAAb,CAApB;;MAEA,IAAI8J,WAAJ,EAAiB;QAChB,IAAMK,eAAe,GAAGL,WAAW,CAACnJ,SAApC;QACA,OAAOmJ,WAAW,CAAC9J,GAAZ,CAAgB4B,GAAhB,EAA4B,CAA5B,IAAiCuI,eAAe,CAACnK,GAAhB,CAAoB,KAApB,EAA2B,CAA3B,CAAjC,GAAiE,KAAKiK,uBAAL,CAA6BH,WAA7B,EAA0ClI,GAA1C,CAAxE;MACA;;MACD,OAAO,CAAP;IACA;;EAED;;;;;;;;WAGA,UAAwBY,QAAxB,EAA+DZ,GAA/D,EAA0E;MACzE,IAAMkI,WAAW,GAAGtH,QAAQ,CAACxC,GAAT,CAAa,cAAb,CAApB;;MAEA,IAAI8J,WAAJ,EAAiB;QAChB,OAAOA,WAAW,CAAC9J,GAAZ,CAAgB4B,GAAhB,EAA4B,CAA5B,IAAiC,KAAKgE,gBAAL,CAAsBkE,WAAtB,EAAmClI,GAAnC,CAAxC;MACA;;MACD,OAAO,CAAP;IACA;;EAED;;;;;;;;WAGA,UAAwBY,QAAxB,EAA+DZ,GAA/D,EAA0E;MACzE,IAAMkI,WAAW,GAAGtH,QAAQ,CAACxC,GAAT,CAAa,cAAb,CAApB;;MAEA,IAAI8J,WAAJ,EAAiB;QAChB,OAAOA,WAAW,CAAC9J,GAAZ,CAAgB4B,GAAhB,EAA4B,CAA5B,IAAiC,KAAK6D,gBAAL,CAAsBqE,WAAtB,EAAmClI,GAAnC,CAAxC;MACA;;MACD,OAAO,CAAP;IACA;;EAED;;;;;;;;WAGA,UAA0BwI,SAA1B,EAAyE;MACxE,KAAKC,kBAAL;IACA;;;;;;WAED;MACC,KAAKC,UAAL,GAAkB,IAAlB;MACA,KAAK5B,SAAL;IACA;;;;;;WAED;MACC,KAAK6B,gBAAL;;MACA,KAAKlG,YAAL,GAAoB,IAApB;MACA,KAAKgB,cAAL,GAAsB,KAAtB;MACA,KAAKmF,qBAAL,GAA6B,KAA7B;MACA,KAAK9B,SAAL;IACA;;;;;;WAED;MACCjK,iBAAMgM,WAAN,CAAiB9L,IAAjB,CAAiB,IAAjB;;MACA,KAAK2L,UAAL,GAAkB,KAAlB;MACA,KAAKzD,mBAAL,GAA2B,KAA3B;MACA,KAAKR,WAAL,GAAmB,KAAnB;MACA,KAAKhB,cAAL,GAAsB,KAAtB;IACA;;;;;;WAED,UAAuBzE,MAAvB,EAAqC;MAEpC,IAAIC,MAAM,GAAGD,MAAM,CAACZ,GAAP,CAAW,QAAX,CAAb;;MACA,IAAIa,MAAJ,EAAY;QACX,IAAI2B,QAAQ,GAAG3B,MAAM,CAAC2B,QAAtB;QAEA,IAAIkI,SAAS,GAAG9J,MAAM,CAACZ,GAAP,CAAW,WAAX,EAAwBwC,QAAQ,CAACxC,GAAT,CAAa,WAAb,EAA0B,GAA1B,CAAxB,CAAhB;QACA,IAAI2K,SAAS,GAAG/J,MAAM,CAACZ,GAAP,CAAW,WAAX,EAAwBwC,QAAQ,CAACxC,GAAT,CAAa,WAAb,EAA0B,GAA1B,CAAxB,CAAhB;QAEA,IAAInB,KAAK,GAAG,KAAKmB,GAAL,CAAS,OAAT,CAAZ;QACA,IAAIjB,KAAK,GAAG,KAAKiB,GAAL,CAAS,OAAT,CAAZ;QAEA,IAAM4K,SAAS,GAAG/L,KAAK,CAACgM,oBAAN,CAA2BrI,QAA3B,EAAqC,KAAKE,OAA1C,EAAmDgI,SAAnD,EAA8D,KAAK1K,GAAL,CAAS,KAAT,EAAgB,CAAhB,CAA9D,CAAlB;QACA,IAAM8K,SAAS,GAAG/L,KAAK,CAACgM,oBAAN,CAA2BvI,QAA3B,EAAqC,KAAKG,OAA1C,EAAmDgI,SAAnD,EAA8D,KAAK3K,GAAL,CAAS,KAAT,EAAgB,CAAhB,CAA9D,CAAlB;QAEA,IAAIgL,KAAK,GAAG,KAAKC,QAAL,CAAcL,SAAd,EAAyBE,SAAzB,CAAZ;QAEA,IAAInN,IAAI,GAAG6E,QAAQ,CAACxC,GAAT,CAAa,MAAb,EAAqBgL,KAAK,CAAChG,CAA3B,CAAX;QACA,IAAIpH,KAAK,GAAG4E,QAAQ,CAACxC,GAAT,CAAa,OAAb,EAAsBgL,KAAK,CAAChG,CAA5B,CAAZ;QACA,IAAIkG,KAAG,GAAG1I,QAAQ,CAACxC,GAAT,CAAa,KAAb,EAAoBgL,KAAK,CAAC7F,CAA1B,CAAV;QACA,IAAIgG,MAAM,GAAG3I,QAAQ,CAACxC,GAAT,CAAa,QAAb,EAAuBgL,KAAK,CAAC7F,CAA7B,CAAb;;QAEA,IAAI,KAAKiG,iBAAL,CAAuBR,SAAvB,EAAkCE,SAAlC,CAAJ,EAAkD;UACjD,IAAI,CAAClK,MAAM,CAAC2B,UAAP,CAAkB,QAAlB,CAAL,EAAkC;YACjC1B,MAAM,CAACC,UAAP,CAAkB,SAAlB,EAA6B,IAA7B;UACA,CAFD,MAGK;YACJD,MAAM,CAACC,UAAP,CAAkB,SAAlB,EAA6B,KAA7B;UACA;;UAED,IAAImH,CAAC,GAAGrK,KAAK,GAAGD,IAAhB;UACA,IAAIuK,CAAC,GAAGiD,MAAM,GAAGD,KAAjB;;UAEA,IAAIrK,MAAM,CAACZ,MAAP,CAAc,OAAd,CAAJ,EAA4B;YAC3BY,MAAM,CAAC7B,GAAP,CAAW,UAAX,EAAuBqM,IAAI,CAACC,GAAL,CAASrD,CAAT,CAAvB;YACApH,MAAM,CAAC7B,GAAP,CAAW,WAAX,EAAwBqM,IAAI,CAACC,GAAL,CAASpD,CAAT,CAAxB;UACA;;UAED,IAAIlD,CAAC,GAAGrH,IAAI,GAAGsK,CAAC,GAAGyC,SAAnB;UACA,IAAIvF,CAAC,GAAGgG,MAAM,GAAGjD,CAAC,GAAGyC,SAArB;UAEA9J,MAAM,CAAC7B,GAAP,CAAW,GAAX,EAAgBgG,CAAhB;UACAnE,MAAM,CAAC7B,GAAP,CAAW,GAAX,EAAgBmG,CAAhB;QACA,CArBD,MAsBK;UACJtE,MAAM,CAACC,UAAP,CAAkB,SAAlB,EAA6B,KAA7B;QACA;MACD;IACD;;;;;;WAED,UAA4ByK,UAA5B,EAAgDC,UAAhD,EAAkE;MACjE,OAAO,KAAK9E,YAAZ;IACA;;EAED;;;;;;;;WAGA,UAAkB+E,EAAlB,EAA4B;MAC3B,IAAI,KAAKC,SAAL,CAAeD,EAAf,CAAJ,EAAwB;QACvB,KAAKE,oBAAL;;QACA,KAAKC,UAAL,GAAkB,KAAKF,SAAL,CAAeD,EAAf,CAAlB;;QACA,KAAKI,iBAAL;;QACA,KAAKC,UAAL,GAAkBL,EAAlB;QAEA,IAAMnM,IAAI,GAAG,gBAAb;;QACA,IAAI,KAAKH,MAAL,CAAY4M,SAAZ,CAAsBzM,IAAtB,CAAJ,EAAiC;UAChC,KAAKH,MAAL,CAAY6M,QAAZ,CAAqB1M,IAArB,EAA2B;YAAEA,IAAI,EAAEA,IAAR;YAAc0I,MAAM,EAAE,IAAtB;YAA4ByD,EAAE,EAAEA;UAAhC,CAA3B;QACA;MACD;IACD;;;;;;WAED;MACC,IAAI,KAAKQ,OAAL,CAAarE,MAAb,GAAsB,CAA1B,EAA6B;QAC5BpK,MAAM,CAAC+B,IAAP,CAAY,KAAKqM,UAAjB,EAA6B,UAACpJ,QAAD,EAAS;UACrC,IAAIyJ,OAAO,GAAGzJ,QAAQ,CAACyJ,OAAvB;;UACA,IAAIA,OAAJ,EAAa;YACZzO,MAAM,CAAC+B,IAAP,CAAY0M,OAAZ,EAAqB,UAACrL,MAAD,EAAO;cAC3B,IAAIC,MAAM,GAAGD,MAAM,CAACZ,GAAP,CAAW,QAAX,CAAb;;cACA,IAAIa,MAAJ,EAAY;gBACXA,MAAM,CAACC,UAAP,CAAkB,SAAlB,EAA6B,KAA7B;cACA;YACD,CALD;UAMA;QACD,CAVD;MAWA;;MAED,KAAK+F,mBAAL,GAA2B,KAA3B,CAfD,CAemC;IAClC;;EAED;;;;;;;;;;;WAMA,UAAkBqF,QAAlB,EAAmC;;;;;;;;;cAClC,KAAKnH,MAAL;;cACIoH,QAAQ,GAAwB,EAAhC;cACJA,QAAQ,CAACjO,IAAT,CAAcO,iBAAM6E,IAAN,CAAU3E,IAAV,CAAU,IAAV,EAAWuN,QAAX,EAAqBE,IAArB,CAA0B;gBACvCpO,KAAI,CAACqO,UAAL,GAAkB,KAAlB;;gBACA,IAAIxN,KAAK,GAAGb,KAAI,CAACgC,GAAL,CAAS,OAAT,CAAZ;;gBACA,IAAIjB,KAAK,GAAGf,KAAI,CAACgC,GAAL,CAAS,OAAT,CAAZ;;gBACA,IAAI8D,QAAQ,GAAG9F,KAAI,CAACgC,GAAL,CAAS,UAAT,CAAf;;gBACA,IAAIjB,KAAK,KAAK+E,QAAd,EAAwB;kBACvB/E,KAAK,CAACuI,0BAAN;gBACA;;gBACD,IAAIzI,KAAK,KAAKiF,QAAd,EAAwB;kBACvBjF,KAAK,CAACyI,0BAAN;gBACA;cACD,CAXa,CAAd;cAYA6E,QAAQ,CAACjO,IAAT,CAAc,KAAKiG,gBAAL,CAAsBb,IAAtB,CAA2B4I,QAA3B,CAAd;cACAC,QAAQ,CAACjO,IAAT,CAAc,KAAKoO,kBAAL,CAAwB,IAAxB,EAA8BJ,QAA9B,CAAd;cACA;cAAA;cAAA,EAAMK,OAAO,CAACC,GAAR,CAAYL,QAAZ,CAAN;;;cAAAM;;;;;;;;IACA;;EAED;;;;;;;;;;;WAMA,UAAkBP,QAAlB,EAAmC;;;;;;;;;cAClC,KAAKnH,MAAL;;cACIoH,QAAQ,GAAmB,EAA3B;cACJA,QAAQ,CAACjO,IAAT,CAAcO,iBAAMiO,IAAN,CAAU/N,IAAV,CAAU,IAAV,EAAWuN,QAAX,EAAqBE,IAArB,CAA0B;gBACvCpO,KAAI,CAAC2O,SAAL,GAAiB,KAAjB;cACA,CAFa,CAAd;cAGAR,QAAQ,CAACjO,IAAT,CAAc,KAAKiG,gBAAL,CAAsBuI,IAAtB,CAA2BR,QAA3B,CAAd;cACAC,QAAQ,CAACjO,IAAT,CAAc,KAAKoO,kBAAL,CAAwB,KAAxB,EAA+BJ,QAA/B,CAAd;cACA;cAAA;cAAA,EAAMK,OAAO,CAACC,GAAR,CAAYL,QAAZ,CAAN;;;cAAAM;;;;;;;;IACA;;EAED;;;;;;;;;;;;WAOA,UAA0BjK,QAA1B,EAAyE0J,QAAzE,EAA0F;;;;;;cACnFC,QAAQ,GAAG,CAAC1N,iBAAMmO,YAAN,CAAkBjO,IAAlB,CAAkB,IAAlB,EAAmB6D,QAAnB,EAA6B0J,QAA7B,CAAD,CAAX;;cAEN,IAAI,CAAC5O,KAAK,CAAC0M,QAAN,CAAekC,QAAf,CAAL,EAA+B;gBAC9BA,QAAQ,GAAG,KAAKlM,GAAL,CAAS,wBAAT,EAAmC,CAAnC,CAAX;cACA;;cAEK6M,MAAM,GAAG,KAAK7M,GAAL,CAAS,sBAAT,CAAT;cAENxC,MAAM,CAAC+B,IAAP,CAAY,KAAKuN,YAAjB,EAA+B,UAAClL,GAAD,EAAI;gBAClCuK,QAAQ,CAACjO,IAAT,CAAcsE,QAAQ,CAACuK,OAAT,CAAiB;kBAAEnL,GAAG,EAAEA,GAAG,GAAG,SAAb;kBAA+BoL,EAAE,EAAExK,QAAQ,CAACxC,GAAT,CAAa4B,GAAb,CAAnC;kBAA6DsK,QAAQ,EAAEA,QAAvE;kBAAkFW,MAAM,EAAEA;gBAA1F,CAAjB,EAAqHI,WAArH,EAAd;cACA,CAFD;cAIA;cAAA;cAAA,EAAMV,OAAO,CAACC,GAAR,CAAYL,QAAZ,CAAN;;;cAAAM;;;;;;;;IACA;;EAED;;;;;;;;;;;;WAOA,UAA0BjK,QAA1B,EAAyE0J,QAAzE,EAA0F;;;;;;cACnFC,QAAQ,GAAG,CAAC1N,iBAAMyO,YAAN,CAAkBvO,IAAlB,CAAkB,IAAlB,EAAmB6D,QAAnB,EAA6B0J,QAA7B,CAAD,CAAX;cAEAnI,WAAW,GAAG,KAAK7D,MAAL,CAAYC,MAAZ,CAAmB,QAAnB,EAA6B,EAA7B,CAAd;;cAEN,IAAI,CAAC7C,KAAK,CAAC0M,QAAN,CAAekC,QAAf,CAAL,EAA+B;gBAC9BA,QAAQ,GAAGnI,WAAW,CAAC/D,GAAZ,CAAgB,wBAAhB,EAA0C,KAAKA,GAAL,CAAS,wBAAT,EAAmC,CAAnC,CAA1C,CAAX;cACA;;cAEK6M,MAAM,GAAG9I,WAAW,CAAC/D,GAAZ,CAAgB,sBAAhB,EAAwC,KAAKA,GAAL,CAAS,sBAAT,CAAxC,CAAT;cAEAnB,KAAK,GAAG,KAAKmB,GAAL,CAAS,OAAT,CAAR;cACAjB,KAAK,GAAG,KAAKiB,GAAL,CAAS,OAAT,CAAR;cACA8D,QAAQ,GAAG,KAAK9D,GAAL,CAAS,UAAT,CAAX;cACAoF,OAAO,GAAG,KAAKpF,GAAL,CAAS,SAAT,CAAV;;cAEN,IAAI8D,QAAQ,KAAKjF,KAAb,IAAsB,CAACiF,QAA3B,EAAqC;gBAEpCtG,MAAM,CAAC+B,IAAP,CAAY,KAAK+B,aAAjB,EAAgC,UAACM,GAAD,EAAI;kBACnC,IAAIlE,GAAG,GAAGqB,KAAK,CAACwD,UAAN,CAAiB,KAAjB,CAAV;kBACA,IAAI4K,SAAS,GAAGpO,KAAK,CAACoO,SAAN,EAAhB;;kBACA,IAAI7P,KAAK,CAAC0M,QAAN,CAAetM,GAAf,KAAuBA,GAAG,GAAGyP,SAAjC,EAA4C;oBAC3CA,SAAS,GAAGzP,GAAZ;kBACA;;kBACD,IAAI0H,OAAJ,EAAa;oBACZ+H,SAAS,GAAG,CAAZ;kBACA;;kBACDhB,QAAQ,CAACjO,IAAT,CAAcsE,QAAQ,CAACuK,OAAT,CAAiB;oBAAEnL,GAAG,EAAEA,GAAG,GAAG,SAAb;oBAA+BoL,EAAE,EAAEG,SAAnC;oBAA8CjB,QAAQ,EAAEA,QAAxD;oBAAmEW,MAAM,EAAEA;kBAA3E,CAAjB,EAAsGI,WAAtG,EAAd;gBACA,CAVD;cAWA;;cACD,IAAInJ,QAAQ,KAAK/E,KAAb,IAAsB,CAAC+E,QAA3B,EAAqC;gBAEhCsJ,QAAMvO,KAAK,CAAC0D,UAAN,CAAiB,KAAjB,CAAN;gBACA8K,cAAYxO,KAAK,CAACsO,SAAN,EAAZ;;gBACJ,IAAI7P,KAAK,CAAC0M,QAAN,CAAeoD,KAAf,KAAuBA,KAAG,GAAGC,WAAjC,EAA4C;kBAC3CA,WAAS,GAAGD,KAAZ;gBACA;;gBACD,IAAIhI,OAAJ,EAAa;kBACZiI,WAAS,GAAG,CAAZ;gBACA;;gBAED7P,MAAM,CAAC+B,IAAP,CAAY,KAAK8B,aAAjB,EAAgC,UAACO,GAAD,EAAI;kBACnCuK,QAAQ,CAACjO,IAAT,CAAcsE,QAAQ,CAACuK,OAAT,CAAiB;oBAAEnL,GAAG,EAAEA,GAAG,GAAG,SAAb;oBAA+BoL,EAAE,EAAEK,WAAnC;oBAA8CnB,QAAQ,EAAEA,QAAxD;oBAAmEW,MAAM,EAAEA;kBAA3E,CAAjB,EAAsGI,WAAtG,EAAd;gBACA,CAFD;cAGA;;cAED;cAAA;cAAA,EAAMV,OAAO,CAACC,GAAR,CAAYL,QAAZ,CAAN;;;cAAAM;;;;;;;;IACA;;;;;;WAED;MACC,KAAKpG,WAAL,GAAmB,IAAnB;MACA,KAAKqC,SAAL;;MACA,KAAKzC,qBAAL;IACA;;;;;;WAED;MACC,IAAMqH,aAAa,GAAG,KAAKhE,cAA3B;;MACA,IAAIgE,aAAJ,EAAmB;QAElB/P,OAAO,CAACgC,IAAR,CAAa+N,aAAb,EAA4B,UAACjE,IAAD,EAAOvJ,KAAP,EAAY;UACvC,IAAI,CAACA,KAAK,CAACuG,WAAX,EAAwB;YACvBvG,KAAK,CAACyN,eAAN;UACA;QACD,CAJD;MAKA;IACD;;;;;;WAED;MACC9O,iBAAM+O,aAAN,CAAmB7O,IAAnB,CAAmB,IAAnB;;MACA,IAAI,KAAK8O,QAAT,EAAmB;QAClB,KAAKC,cAAL;;QACA,KAAKD,QAAL,GAAgB,KAAhB;MACA;IACD;;EAED;;;;;;;;;;WAKA,UAA2BjL,QAA3B,EAAoF;MACnF,KAAK6H,kBAAL,CAAwB7H,QAAxB;MACA,KAAK0D,iBAAL,CAAuB1D,QAAvB;;MAEA,IAAI,KAAKxC,GAAL,CAAS,SAAT,CAAJ,EAAyB;QACxB,IAAI,CAAC,KAAK2N,QAAL,EAAL,EAAsB;UACrB,IAAMC,OAAO,GAAG,KAAK5N,GAAL,CAAS,SAAT,CAAhB;;UACA,IAAI4N,OAAJ,EAAa;YACZA,OAAO,CAACC,YAAR,CAAqBrL,QAArB;;YAEA,IAAIA,QAAJ,EAAc;cACb,IAAIkI,SAAS,GAAG,KAAK1K,GAAL,CAAS,WAAT,EAAsB,CAAtB,CAAhB;cACA,IAAI2K,SAAS,GAAG,KAAK3K,GAAL,CAAS,WAAT,EAAsB,CAAtB,CAAhB;cAEA,IAAI8N,aAAa,GAAGtL,QAAQ,CAACxC,GAAT,CAAa,WAAb,EAA0B0K,SAA1B,CAApB;cACA,IAAIqD,aAAa,GAAGvL,QAAQ,CAACxC,GAAT,CAAa,WAAb,EAA0B2K,SAA1B,CAApB;cAEA,IAAM9L,KAAK,GAAG,KAAKmB,GAAL,CAAS,OAAT,CAAd;cACA,IAAMjB,KAAK,GAAG,KAAKiB,GAAL,CAAS,OAAT,CAAd;cAEA,IAAM8G,GAAG,GAAG,KAAK9G,GAAL,CAAS,KAAT,EAAgB,CAAhB,CAAZ;cACA,IAAM+G,GAAG,GAAG,KAAK/G,GAAL,CAAS,KAAT,EAAgB,CAAhB,CAAZ;cAEA,IAAMgO,IAAI,GAAGnP,KAAK,CAACgM,oBAAN,CAA2BrI,QAA3B,EAAqC,KAAKmC,cAA1C,EAA2D,KAAKsJ,YAAL,GAAoB,CAAC,KAAKC,YAAL,GAAoB,KAAKD,YAA1B,IAA0CH,aAAzH,EAAwIhH,GAAxI,CAAb;cACA,IAAMqH,IAAI,GAAGpP,KAAK,CAACgM,oBAAN,CAA2BvI,QAA3B,EAAqC,KAAKsC,cAA1C,EAA2D,KAAKsJ,YAAL,GAAoB,CAAC,KAAKC,YAAL,GAAoB,KAAKD,YAA1B,IAA0CL,aAAzH,EAAwIhH,GAAxI,CAAb;cAEA,IAAMiE,KAAK,GAAG,KAAKC,QAAL,CAAc+C,IAAd,EAAoBG,IAApB,CAAd;cAEA,IAAIG,MAAI,GAAG,IAAX;cACA9Q,MAAM,CAAC+B,IAAP,CAAY,KAAKuN,YAAjB,EAA+B,UAACjL,KAAD,EAAM;gBACpC,IAAIW,QAAQ,CAACxC,GAAT,CAAa6B,KAAb,KAA8B,IAAlC,EAAwC;kBACvCyM,MAAI,GAAG,KAAP;gBACA;cACD,CAJD;;cAMA,IAAIA,MAAJ,EAAU;gBACT,IAAMlM,KAAK,GAAG,KAAKA,KAAnB;;gBACA,IAAIA,KAAK,IAAIA,KAAK,CAACmM,MAAN,CAAavD,KAAb,CAAb,EAAkC;kBACjC4C,OAAO,CAACY,KAAR,CAAcC,IAAd,CAAmBC,aAAnB;kBACAd,OAAO,CAAC5O,GAAR,CAAY,eAAZ,EAA6B,KAAK2P,iBAAL,CAAuBnM,QAAvB,CAA7B;kBACAoL,OAAO,CAAC5O,GAAR,CAAY,SAAZ,EAAuB,KAAKwJ,QAAL,CAAcoG,QAAd,CAAuB;oBAAE5J,CAAC,EAAEgG,KAAK,CAAChG,CAAX;oBAAcG,CAAC,EAAE6F,KAAK,CAAC7F;kBAAvB,CAAvB,CAAvB;gBACA,CAJD,MAKK;kBACJyI,OAAO,CAACC,YAAR,CAAqBxP,SAArB;gBACA;cACD,CAVD,MAWK;gBACJuP,OAAO,CAACC,YAAR,CAAqBxP,SAArB;cACA;YACD;UACD;QACD,CA9CD,MA+CK;UACJ,KAAKwQ,WAAL;QACA;MACD;IACD;;;;;;WAED,UAA4BrM,QAA5B,EAAyE;MACxE,IAAI,KAAKxC,GAAL,CAAS,qBAAT,KAAmC,QAAvC,EAAiD;QAChD,IAAMiM,OAAO,GAAGzJ,QAAQ,CAACyJ,OAAzB;;QACA,IAAIA,OAAO,IAAIA,OAAO,CAACrE,MAAR,GAAiB,CAAhC,EAAmC;UAClC,IAAMhH,MAAM,GAAGqL,OAAO,CAAC,CAAD,CAAtB;UACA,IAAMpL,MAAM,GAAGD,MAAM,CAACZ,GAAP,CAAW,QAAX,CAAf;;UACA,IAAIa,MAAJ,EAAY;YACX,OAAOA,MAAP;UACA;QACD;MACD;;MACD,OAAO,IAAP;IACA;;EAED;;;;;;;;WAGA,UAAyB2B,QAAzB,EAAkF;MACjF,IAAMsM,cAAc,GAAG,KAAK9O,GAAL,CAAS,gBAAT,CAAvB;;MAEA,IAAI8O,cAAJ,EAAoB;QAEnB,IAAMN,KAAK,GAAGM,cAAc,CAAC9O,GAAf,CAAmB,OAAnB,CAAd;;QACA,IAAIwO,KAAJ,EAAW;UACV,IAAIO,GAAG,GAAG,EAAV;;UACA,IAAIvM,QAAJ,EAAc;YACbgM,KAAK,CAACX,YAAN,CAAmBrL,QAAnB;;YACAuM,GAAG,GAAG,KAAK/O,GAAL,CAAS,iBAAT,EAA4BwO,KAAK,CAACxO,GAAN,CAAU,MAAV,EAAkB,KAAKA,GAAL,CAAS,MAAT,EAAiB,EAAjB,CAAlB,CAA5B,CAAN;UACA,CAHD,MAIK;YACJwO,KAAK,CAACX,YAAN,CAAmB,KAAKmB,cAAxB;;YACAD,GAAG,GAAG,KAAK/O,GAAL,CAAS,sBAAT,EAAiC,KAAKA,GAAL,CAAS,iBAAT,EAA4BwO,KAAK,CAACxO,GAAN,CAAU,MAAV,EAAkB,KAAKA,GAAL,CAAS,MAAT,EAAiB,EAAjB,CAAlB,CAA5B,CAAjC,CAAN;UACA;;UAEDwO,KAAK,CAACxP,GAAN,CAAU,MAAV,EAAkB+P,GAAlB;QACA;;QAED,IAAME,UAAU,GAAGH,cAAc,CAAC9O,GAAf,CAAmB,YAAnB,CAAnB;;QACA,IAAIiP,UAAJ,EAAgB;UACf,IAAIF,GAAG,GAAG,EAAV;;UACA,IAAIvM,QAAJ,EAAc;YACbyM,UAAU,CAACpB,YAAX,CAAwBrL,QAAxB;;YACAuM,GAAG,GAAG,KAAK/O,GAAL,CAAS,iBAAT,EAA4BiP,UAAU,CAACjP,GAAX,CAAe,MAAf,EAAuB,EAAvB,CAA5B,CAAN;UACA,CAHD,MAIK;YACJiP,UAAU,CAACpB,YAAX,CAAwB,KAAKmB,cAA7B;;YACAD,GAAG,GAAG,KAAK/O,GAAL,CAAS,sBAAT,EAAiCiP,UAAU,CAACjP,GAAX,CAAe,MAAf,EAAuB,EAAvB,CAAjC,CAAN;UACA;;UAEDiP,UAAU,CAACjQ,GAAX,CAAe,MAAf,EAAuB+P,GAAvB;QACA;MACD;IACD;;;;;;WAED;MACC,IAAIN,IAAI,GAAG,SAAS,KAAK/L,OAAzB;;MACA,IAAI,KAAK1C,GAAL,CAAS,OAAT,EAAkBC,MAAlB,CAAwC,UAAxC,CAAJ,EAAyD;QACxDwO,IAAI,IAAI,eAAR;MACA;;MACDA,IAAI,IAAI,YAAY,KAAK9L,OAAzB;;MACA,IAAI,KAAK3C,GAAL,CAAS,OAAT,EAAkBC,MAAlB,CAAwC,UAAxC,CAAJ,EAAyD;QACxDwO,IAAI,IAAI,eAAR;MACA;;MACDA,IAAI,IAAI,GAAR;MACA,OAAOA,IAAP;IACA;;EAED;;;;;;;;WAGA,UAAgB7D,SAAhB,EAAmCE,SAAnC,EAAoD;MACnD,IAAI9F,CAAC,GAAG,KAAKhF,GAAL,CAAS,OAAT,EAAkBA,GAAlB,CAAsB,UAAtB,EAAkCkP,oBAAlC,CAAuDtE,SAAvD,CAAR;MACA,IAAIzF,CAAC,GAAG,KAAKnF,GAAL,CAAS,OAAT,EAAkBA,GAAlB,CAAsB,UAAtB,EAAkCkP,oBAAlC,CAAuDpE,SAAvD,CAAR;MAEA,OAAO;QAAE9F,CAAC,EAAEA,CAAL;QAAQG,CAAC,EAAEA;MAAX,CAAP;IACA;;;;;;WAED,UAAyBgK,SAAzB,EAA0C;MACzC,OAAO,IAAP;IACA;;EAED;;;;;;;;WAGA;MACC,KAAKN,WAAL;MACA,KAAK3I,iBAAL,CAAuB7H,SAAvB;MACA,KAAKgM,kBAAL,CAAwBhM,SAAxB;IACA;;;;;;WAED;MACCI,iBAAM8L,gBAAN,CAAsB5L,IAAtB,CAAsB,IAAtB;;MACA,KAAKyQ,aAAL;IACA;KA7uCF,CAgvCC;;;;;;WACA;MACC,KAAKtO,UAAL,CAAgB,eAAhB,EAAiCzC,SAAjC;MACA,KAAKyC,UAAL,CAAgB,eAAhB,EAAiCzC,SAAjC;MACA,KAAKyC,UAAL,CAAgB,eAAhB,EAAiCzC,SAAjC;MACA,KAAKyC,UAAL,CAAgB,eAAhB,EAAiCzC,SAAjC;MAEA,KAAKyC,UAAL,CAAgB,MAAhB,EAAwBzC,SAAxB;MACA,KAAKyC,UAAL,CAAgB,MAAhB,EAAwBzC,SAAxB;MACA,KAAKyC,UAAL,CAAgB,MAAhB,EAAwBzC,SAAxB;MACA,KAAKyC,UAAL,CAAgB,MAAhB,EAAwBzC,SAAxB;IACA;;EAED;;;;;;;;;;;;WAOA,UAAuBmC,YAAvB,EAA4D;MAC3D,OAAO,KAAKtB,UAAL,CAAgBhB,IAAhB,CAAqB;QAC3BsC,YAAY,EAAEA;MADa,CAArB,CAAP;IAGA;;EAvwCDzC;oBAAA;sBAAA;kBAAA;WAAkC;EAAlC;EACAA;oBAAA;sBAAA;kBAAA;WAA0Cb,MAAM,CAACmS,UAAP,CAAkBC,MAAlB,CAAyB,CAACC,QAAQ,CAAChM,SAAV,CAAzB;EAA1C;EAuwCD;AAAC,CAzwCD,CAAuCrG,MAAvC;;SAAsBqS","names":["DataItem","Series","List","Container","Graphics","$type","$object","$array","$utils","min","left","right","max","__extends","Object","_this","children","push","new","_root","undefined","fields","valueFields","_setRawDefault","_super","_afterNew","call","_settings","xAxis","series","yAxis","set","_disposers","axisRanges","events","onAll","change","type","each","oldValues","axisRange","_removeAxisRange","_processAxisRange","newValue","oldValue","value","Error","get","isType","states","create","opacity","visible","_makeFieldNames","container","axisDataItem","setRaw","axis","component","bullet","sprite","setPrivate","axisFill","_seriesAxisRanges","disposeDataItem","remove","dispose","_updateFields","_valueXFields","_valueYFields","_valueXShowFields","_valueYShowFields","__valueXShowFields","__valueYShowFields","valueXFields","key","field","field_1","indexOf","split","valueYFields","field_2","_dispose","chart","removeValue","removeFirst","getPrivate","dataItem","inited","_xField","_yField","xName","xCapName","capitalizeFirst","yName","yCapName","xLetter","yLetter","open","low","high","show","className","_xOpenField","_xLowField","_xHighField","_yOpenField","_yLowField","_yHighField","baseAxis","hiddenState","lookup","sequencedInterpolation","isDirty","bulletsContainer","_prepareChildren","_valuesDirty","width","height","_handleMaskBullets","tooltipPositionX","tooltipFieldX","_tooltipFieldX","tooltipPositionY","tooltipFieldY","_tooltipFieldY","_fixVC","x","relativeToValue","parent","y","stacked","_dataProcessed","_stack","_unstack","dataItems","getStackedXValue","_min","_max","getStackedYValue","processSeriesDataItem","_seriesValuesDirty","isPrivateDirty","markDirtyExtremes","_markStakedDirtyStack","updateLegendValue","_dataGrouped","_groupSeriesData","_stackDirty","startIndex","endIndex","minBulletDistance","axisLength","_showBullets","_psi","_pei","_selectionProcessed","vcx","vcy","stacked_1","outOfSelection","_calculateTotals","setPrivateRaw","i","processYSelectionDataItem","markDirtySelectionExtremes","processXSelectionDataItem","selectionMinY","selectionMaxY","selectionMinX","selectionMaxX","length","mainContainerMask_1","_mainContainerMask","display","target","w","h","moveTo","lineTo","fill","draw","mainContainer","_display","mask","markDirty","_markDirtyKey","_updateChildren","_x","_y","_makeRangeMask","seriesIndex","_couldStackTo","getIndex","_stackDataItems","_reallyStackedTo","_key","_stackedSeries","uid","stackToItemKey","len","index","stackToNegative","s","stackToSeries","stackToItem","stackValue","isNumber","getStackedXValueWorking","getStackedYValueWorking","stackedToSeries","_dataItem","updateLegendMarker","_axesDirty","_afterDataChange","_aggregatesCalculated","_clearDirty","locationX","locationY","positionX","getDataItemPositionX","positionY","getDataItemPositionY","point","getPoint","top_1","bottom","_shouldShowBullet","Math","abs","_positionX","_positionY","id","_dataSets","_handleDataSetChange","_dataItems","_markDataSetDirty","_dataSetId","isEnabled","dispatch","bullets","duration","promises","then","_isShowing","_sequencedShowHide","Promise","all","_a","hide","_isHiding","showDataItem","easing","_valueFields","animate","to","waitForStop","hideDataItem","baseValue","min_1","baseValue_1","stackedSeries","_markDirtyStack","_afterChanged","_skipped","_markDirtyAxes","isHidden","tooltip","_setDataItem","itemLocationX","itemLocationY","xPos","_aLocationX0","_aLocationX1","yPos","_aLocationY0","_aLocationY1","show_1","inPlot","label","text","markDirtyText","_getTooltipTarget","toGlobal","hideTooltip","legendDataItem","txt","_emptyDataItem","valueLabel","positionToCoordinate","_position","resetExtremes","classNames","concat","XYSeries"],"sourceRoot":"","sources":["../../../../../../src/.internal/charts/xy/series/XYSeries.ts"],"sourcesContent":["import type { Axis, IAxisPrivate, IAxisDataItem } from \"../axes/Axis\";\nimport type { AxisRenderer } from \"../axes/AxisRenderer\";\nimport type { IPoint } from \"../../../core/util/IPoint\";\nimport type { Sprite } from \"../../../core/render/Sprite\";\nimport type { Bullet } from \"../../../core/render/Bullet\";\nimport type { XYChart } from \"../XYChart\";\nimport type { CategoryAxis } from \"../axes/CategoryAxis\";\nimport type { DateAxis } from \"../axes/DateAxis\";\nimport type { ITimeInterval } from \"../../../core/util/Time\";\n\nimport { DataItem } from \"../../../core/render/Component\";\nimport { Series, ISeriesSettings, ISeriesDataItem, ISeriesPrivate, ISeriesEvents } from \"../../../core/render/Series\";\nimport { List } from \"../../../core/util/List\";\nimport { Container } from \"../../../core/render/Container\";\nimport { Graphics } from \"../../../core/render/Graphics\";\n\nimport * as $type from \"../../../core/util/Type\";\nimport * as $object from \"../../../core/util/Object\";\nimport * as $array from \"../../../core/util/Array\";\nimport * as $utils from \"../../../core/util/Utils\";\n\n/**\n * @ignore\n */\nfunction min(left: number | undefined, right: number | undefined): number | undefined {\n\tif (left == null) {\n\t\treturn right;\n\n\t} else if (right == null) {\n\t\treturn left;\n\n\t} else if (right < left) {\n\t\treturn right;\n\n\t} else {\n\t\treturn left;\n\t}\n}\n\n/**\n * @ignore\n */\nfunction max(left: number | undefined, right: number | undefined): number | undefined {\n\tif (left == null) {\n\t\treturn right;\n\n\t} else if (right == null) {\n\t\treturn left;\n\n\t} else if (right > left) {\n\t\treturn right;\n\n\t} else {\n\t\treturn left;\n\t}\n}\n\n/**\n * Interface representing a series axis range.\n *\n * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/axes/axis-ranges/#Series_axis_ranges} for more info\n */\nexport interface IXYSeriesAxisRange {\n\n\t/**\n\t * Related axis data item.\n\t */\n\taxisDataItem: DataItem<IAxisDataItem>;\n\n\t/**\n\t * A [[Container]] element that range's elements are placed in.\n\t */\n\tcontainer?: Container;\n\n\t/**\n\t * Target series.\n\t */\n\tseries?: XYSeries;\n\n}\n\nexport interface IXYAxisPrivate extends IAxisPrivate {\n\tmin?: number;\n\tmax?: number;\n}\n\nexport interface IXYAxis extends Axis<AxisRenderer> {\n\t_privateSettings: IXYAxisPrivate;\n}\n\nexport interface IXYSeriesEvents extends ISeriesEvents {\n\n\t/**\n\t * Kicks in when axis starts using different data set, e.g. data\n\t * of different granularit on [[DateAxis]].\n\t *\n\t * @since 5.1.1\n\t */\n\tdatasetchanged: {\n\t\tid: string\n\t}\n}\n\n/**\n * XY chart series data item.\n */\nexport interface IXYSeriesDataItem extends ISeriesDataItem {\n\tvalueX?: number;\n\tvalueXWorking?: number;\n\tvalueXChange?: number;\n\tvalueXChangePercent?: number;\n\tvalueXChangeSelection?: number;\n\tvalueXChangeSelectionPercent?: number;\n\tvalueXChangePrevious?: number;\n\tvalueXChangePreviousPercent?: number;\n\tvalueXWorkingOpen?: number;\n\tvalueXWorkingClose?: number;\n\n\tvalueY?: number;\n\tvalueYChange?: number;\n\tvalueYWorking?: number;\n\tvalueYChangePercent?: number;\n\tvalueYChangeSelection?: number;\n\tvalueYChangeSelectionPercent?: number;\n\tvalueYChangePrevious?: number;\n\tvalueYChangePreviousPercent?: number;\n\tvalueYWorkingOpen?: number;\n\tvalueYWorkingClose?: number;\n\n\topenValueX?: number;\n\topenValueXWorking?: number;\n\topenValueXChange?: number;\n\topenValueXChangePercent?: number;\n\topenValueXChangeSelection?: number;\n\topenValueXChangeSelectionPercent?: number;\n\topenValueXChangePrevious?: number;\n\topenValueXChangePreviousPercent?: number;\n\topenValueXWorkingOpen?: number;\n\topenValueXWorkingClose?: number;\n\topenValueY?: number;\n\topenValueYWorking?: number;\n\topenValueYChange?: number;\n\topenValueYChangePercent?: number;\n\topenValueYChangeSelection?: number;\n\topenValueYChangeSelectionPercent?: number;\n\topenValueYChangePrevious?: number;\n\topenValueYChangePreviousPercent?: number;\n\topenValueYWorkingOpen?: number;\n\topenValueYWorkingClose?: number;\n\n\tlowValueX?: number;\n\tlowValueXWorking?: number;\n\tlowValueXChange?: number;\n\tlowValueXChangePercent?: number;\n\tlowValueXChangeSelection?: number;\n\tlowValueXChangeSelectionPercent?: number;\n\tlowValueXChangePrevious?: number;\n\tlowValueXChangePreviousPercent?: number;\n\tlowValueXWorkingOpen?: number;\n\tlowValueXWorkingClose?: number;\n\n\thighValueX?: number;\n\thighValueXWorking?: number;\n\thighValueXChange?: number;\n\thighValueXChangePercent?: number;\n\thighValueXChangeSelection?: number;\n\thighValueXChangeSelectionPercent?: number;\n\thighValueXChangePrevious?: number;\n\thighValueXChangePreviousPercent?: number;\n\thighValueXWorkingOpen?: number;\n\thighValueXWorkingClose?: number;\n\n\tlowValueY?: number;\n\tlowValueYWorking?: number;\n\tlowValueYChange?: number;\n\tlowValueYChangePercent?: number;\n\tlowValueYChangeSelection?: number;\n\tlowValueYChangeSelectionPercent?: number;\n\tlowValueYChangePrevious?: number;\n\tlowValueYChangePreviousPercent?: number;\n\tlowValueYWorkingOpen?: number;\n\tlowValueYWorkingClose?: number;\n\n\thighValueY?: number;\n\thighValueYWorking?: number;\n\thighValueYChange?: number;\n\thighValueYChangePercent?: number;\n\thighValueYChangeSelection?: number;\n\thighValueYChangeSelectionPercent?: number;\n\thighValueYChangePrevious?: number;\n\thighValueYChangePreviousPercent?: number;\n\thighValueYWorkingOpen?: number;\n\thighValueYWorkingClose?: number;\n\n\tcategoryX?: string;\n\tcategoryY?: string;\n\n\topenCategoryX?: string;\n\topenCategoryY?: string;\n\n\tlocationX?: number;\n\tlocationY?: number;\n\n\topenLocationX?: number;\n\topenLocationY?: number;\n\n\tstackToItemX?: DataItem<IXYSeriesDataItem>;\n\tstackToItemY?: DataItem<IXYSeriesDataItem>;\n\n\tleft?: number;\n\tright?: number;\n\ttop?: number;\n\tbottom?: number;\n\n\tpoint?: IPoint;\n\n\toriginals?: Array<DataItem<IXYSeriesDataItem>>;\n}\n\nexport interface IXYSeriesSettings extends ISeriesSettings {\n\n\t/**\n\t * Minimal distance between data items in pixels.\n\t *\n\t * If data items are closer than this, bullets are turned off to avoid\n\t * overcrowding.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/#Bullets} for more info\n\t */\n\tminBulletDistance?: number;\n\n\t/**\n\t * X axis series uses.\n\t */\n\txAxis: IXYAxis;\n\n\t/**\n\t * Y axis series uses.\n\t */\n\tyAxis: IXYAxis;\n\n\t/**\n\t * If set to `true` series will be stacked to other series that also have\n\t * this setting set to `true`.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/#Stacked_series} for more info\n\t */\n\tstacked?: boolean;\n\n\t/**\n\t * Whether to stack negative values from zero (`true`) or from whatever\n\t * previous series value is (`false`).\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/#Negative_value_stacking} for more info\n\t */\n\tstackToNegative?: boolean;\n\n\t/**\n\t * Base axis for the series.\n\t *\n\t * A base axis will dictate direction series plot.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/#Base_axis} for more info\n\t */\n\tbaseAxis?: IXYAxis;\n\n\t/**\n\t * Input data field for X value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/#Data_fields} for more info\n\t */\n\tvalueXField?: string;\n\n\t/**\n\t * Input data field for Y value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/#Data_fields} for more info\n\t */\n\tvalueYField?: string;\n\n\t/**\n\t * Exclude series values when calculating totals for category/interval.\n\t *\n\t * @default false\n\t */\n\texcludeFromTotal?: boolean;\n\n\t/**\n\t * Display data field for X value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/#Data_fields} for more info\n\t */\n\tvalueXShow?: \"valueXWorking\" | \"valueXChange\" | \"valueXChangePercent\" | \"valueXChangeSelection\" | \"valueXChangeSelectionPercent\" | \"valueXChangePrevious\" | \"valueXChangePreviousPercent\" | \"valueXTotal\" | \"valueXTotalPercent\" | \"valueXSum\";\n\n\t/**\n\t * Display data field for Y value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/#Data_fields} for more info\n\t */\n\tvalueYShow?: \"valueYWorking\" | \"valueYChange\" | \"valueYChangePercent\" | \"valueYChangeSelection\" | \"valueYChangeSelectionPercent\" | \"valueYChangePrevious\" | \"valueYChangePreviousPercent\" | \"valueYTotal\" | \"valueYTotalPercent\" | \"valueYSum\";\n\n\t/**\n\t * Indicates what aggregate value to use for collective data item, when\n\t * aggregating X values from several data items.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/axes/date-axis/#Dynamic_data_item_grouping} for more info\n\t */\n\tvalueXGrouped?: \"open\" | \"close\" | \"low\" | \"high\" | \"average\" | \"sum\" | \"extreme\";\n\n\t/**\n\t * Indicates what aggregate value to use for collective data item, when\n\t * aggregating X values from several data items.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/axes/date-axis/#Dynamic_data_item_grouping} for more info\n\t */\n\tvalueYGrouped?: \"open\" | \"close\" | \"low\" | \"high\" | \"average\" | \"sum\" | \"extreme\";\n\n\t/**\n\t * Input data field for X open value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/#Data_fields} for more info\n\t */\n\topenValueXField?: string;\n\n\t/**\n\t * Input data field for X open value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/#Data_fields} for more info\n\t */\n\topenValueYField?: string;\n\n\t/**\n\t * Display data field for X open value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/#Data_fields} for more info\n\t */\n\topenValueXShow?: \"openValueXWorking\" | \"openValueXChange\" | \"openValueXChangePercent\" | \"openValueXChangeSelection\" | \"openValueXChangeSelectionPercent\" | \"openValueXChangePrevious\" | \"openValueXChangePreviousPercent\";\n\n\t/**\n\t * Display data field for Y open value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/#Data_fields} for more info\n\t */\n\topenValueYShow?: \"openValueYWorking\" | \"openValueYChange\" | \"openValueYChangePercent\" | \"openValueYChangeSelection\" | \"openValueYChangeSelectionPercent\" | \"openValueYChangePrevious\" | \"openValueYChangePreviousPercent\";\n\n\t/**\n\t * Display data field for Y open value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/axes/date-axis/#Dynamic_data_item_grouping} for more info\n\t */\n\topenValueXGrouped?: \"open\" | \"close\" | \"low\" | \"high\" | \"average\" | \"sum\" | \"extreme\";\n\n\t/**\n\t * Display data field for Y open value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/axes/date-axis/#Dynamic_data_item_grouping} for more info\n\t */\n\topenValueYGrouped?: \"open\" | \"close\" | \"low\" | \"high\" | \"average\" | \"sum\" | \"extreme\";\n\n\n\n\t/**\n\t * Input data field for X low value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/candlestick-series/} for more info\n\t */\n\tlowValueXField?: string;\n\n\t/**\n\t * Input data field for Y low value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/candlestick-series/} for more info\n\t */\n\tlowValueYField?: string;\n\n\t/**\n\t * Input data field for X high value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/candlestick-series/} for more info\n\t */\n\thighValueXField?: string;\n\n\t/**\n\t * Input data field for Y high value.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/candlestick-series/} for more info\n\t */\n\thighValueYField?: string;\n\n\t/**\n\t * Display data field for X low value.\n\t */\n\tlowValueXShow?: \"lowValueXWorking\" | \"lowValueXChange\" | \"lowValueXChangePercent\" | \"lowValueXChangeSelection\" | \"lowValueXChangeSelectionPercent\" | \"lowValueXChangePrevious\" | \"lowValueXChangePreviousPercent\";\n\n\t/**\n\t * Display data field for Y low value.\n\t */\n\tlowValueYShow?: \"lowValueYWorking\" | \"lowValueYChange\" | \"lowValueYChangePercent\" | \"lowValueYChangeSelection\" | \"lowValueYChangeSelectionPercent\" | \"lowValueYChangePrevious\" | \"lowValueYChangePreviousPercent\";\n\n\t/**\n\t * Indicates what aggregate value to use for collective data item, when\n\t * aggregating X low values from several data items.\n\t */\n\tlowValueXGrouped?: \"open\" | \"close\" | \"low\" | \"high\" | \"average\" | \"sum\" | \"extreme\";\n\n\t/**\n\t * Indicates what aggregate value to use for collective data item, when\n\t * aggregating Y low values from several data items.\n\t */\n\tlowValueYGrouped?: \"open\" | \"close\" | \"low\" | \"high\" | \"average\" | \"sum\" | \"extreme\";\n\n\t/**\n\t * Display data field for X high value.\n\t */\n\thighValueXShow?: \"highValueXWorking\" | \"highValueXChange\" | \"highValueXChangePercent\" | \"highValueXChangeSelection\" | \"highValueXChangeSelectionPercent\" | \"highValueXChangePrevious\" | \"highValueXChangePreviousPercent\";\n\n\t/**\n\t * Display data field for Y low value.\n\t */\n\thighValueYShow?: \"highValueYWorking\" | \"highValueYChange\" | \"highValueYChangePercent\" | \"highValueYChangeSelection\" | \"highValueYChangeSelectionPercent\" | \"highValueYChangePrevious\" | \"highValueYChangePreviousPercent\";\n\n\t/**\n\t * Indicates what aggregate value to use for collective data item, when\n\t * aggregating X high values from several data items.\n\t */\n\thighValueXGrouped?: \"open\" | \"close\" | \"high\" | \"high\" | \"average\" | \"sum\" | \"extreme\";\n\n\t/**\n\t * Indicates what aggregate value to use for collective data item, when\n\t * aggregating X high values from several data items.\n\t */\n\thighValueYGrouped?: \"open\" | \"close\" | \"high\" | \"high\" | \"average\" | \"sum\" | \"extreme\";\n\n\t/**\n\t * Horizontal location of the low data point relative to its cell.\n\t *\n\t * `0` - beginning, `0.5` - middle, `1` - end.\n\t *\n\t * @default 0.5\n\t */\n\tlowLocationX?: number;\n\n\t/**\n\t * Vertical location of the low data point relative to its cell.\n\t *\n\t * `0` - beginning, `0.5` - middle, `1` - end.\n\t *\n\t * @default 0.5\n\t */\n\tlowLocationY?: number;\n\n\t/**\n\t * Horizontal location of the high data point relative to its cell.\n\t *\n\t * `0` - beginning, `0.5` - middle, `1` - end.\n\t *\n\t * @default 0.5\n\t */\n\thighLocationX?: number;\n\n\t/**\n\t * Vertical location of the high data point relative to its cell.\n\t *\n\t * `0` - beginning, `0.5` - middle, `1` - end.\n\t *\n\t * @default 0.5\n\t */\n\thighLocationY?: number;\n\n\n\t/**\n\t * Input data field for X category.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/#Data_fields} for more info\n\t */\n\tcategoryXField?: string;\n\n\t/**\n\t * Input data field for Y category.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/#Data_fields} for more info\n\t */\n\tcategoryYField?: string;\n\n\t/**\n\t * Display data field for X category.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/#Data_fields} for more info\n\t */\n\topenCategoryXField?: string;\n\n\t/**\n\t * Display data field for Y category.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/#Data_fields} for more info\n\t */\n\topenCategoryYField?: string;\n\n\t/**\n\t * If set to `true` this series will be ignored when calculating scale of the\n\t * related axes.\n\t *\n\t * @default false\n\t */\n\tignoreMinMax?: boolean;\n\n\t/**\n\t * @ignore\n\t */\n\tvcx?: number;\n\n\t/**\n\t * @ignore\n\t */\n\tvcy?: number;\n\n\t/**\n\t * Horizontal location of the data point relative to its cell.\n\t *\n\t * `0` - beginning, `0.5` - middle, `1` - end.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/line-series/#Data_item_location} for more info\n\t * @default 0.5\n\t */\n\tlocationX?: number;\n\n\t/**\n\t * Vertical location of the data point relative to its cell.\n\t *\n\t * `0` - beginning, `0.5` - middle, `1` - end.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/line-series/#Data_item_location} for more info\n\t * @default 0.5\n\t */\n\tlocationY?: number;\n\n\t/**\n\t * Horizontal location of the open data point relative to its cell.\n\t *\n\t * `0` - beginning, `0.5` - middle, `1` - end.\n\t *\n\t * @default 0.5\n\t */\n\topenLocationX?: number;\n\n\t/**\n\t * Vertical location of the open data point relative to its cell.\n\t *\n\t * `0` - beginning, `0.5` - middle, `1` - end.\n\t *\n\t * @default 0.5\n\t */\n\topenLocationY?: number;\n\n\t/**\n\t * If set to `true` [[XYCursor]] will show closest data item from series\n\t * even if it is outside currently hovered date axis interval.\n\t *\n\t * This setting is relevant only if `baseAxis` is a date axis.\n\t */\n\tsnapTooltip?: boolean;\n\n\t/**\n\t * Text to use for series legend label when no particular category/interval\n\t * is selected.\n\t */\n\tlegendRangeLabelText?: string;\n\n\t/**\n\t * Text to use for series legend value label when no particular\n\t * category/interval is selected.\n\t */\n\tlegendRangeValueText?: string;\n\n\n\t/**\n\t * If set to `true`, series bullets will be masked by plot area.\n\t */\n\tmaskBullets?: boolean;\n\n\t/**\n\t * Whether series' tooltip should inherit its color from series or its first\n\t * bullet.\n\t *\n\t * @default \"series\"\n\t */\n\tseriesTooltipTarget?: \"series\" | \"bullet\";\n\n\t/**\n\t * Indicates horizontal position at which to show series' tooltip at.\n\t *\n\t * @default \"value\"\n\t * @since 5.0.16\n\t */\n\ttooltipPositionX?: \"open\" | \"value\" | \"low\" | \"high\";\n\n\t/**\n\t * Indicates vertical position at which to show series' tooltip at.\n\t *\n\t * @default \"value\"\n\t * @since 5.0.16\n\t */\n\ttooltipPositionY?: \"open\" | \"value\" | \"low\" | \"high\";\n\n\n\t/**\n\t * If set to `true` data items for this series won't be grouped even if\n\t * the `groupData: true` is set on a related [[DateAxis]].\n\t * \n\t * @since 5.0.19\n\t */\n\tgroupDataDisabled?: boolean;\n\n\t/**\n\t * A [[DataItem]] that is being used for current tooltip, e.g. by a chart\n\t * cursor.\n\t *\n\t * @since 5.1.2\n\t */\n\ttooltipDataItem?: DataItem<IXYSeriesDataItem>\n\n\t/**\n\t * If set to `true`, when data is grouped, the `originals` setting of the\n\t * group data items will be populated by the original (source) data items\n\t * that fall into the group.\n\t *\n\t * Please note that if `groupDataCallback` is set, this setting is ignored\n\t * as originals will always be included, regardless of the value.\n\t *\n\t * @since 5.1.11\n\t * @default false\n\t */\n\tgroupDataWithOriginals?: boolean;\n\n\t/**\n\t * A custom function to call when grouping data items.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/axes/date-axis/#Custom_aggregation_functions} for more info\n\t * @since 5.1.11\n\t */\n\tgroupDataCallback?: (dataItem: DataItem<IXYSeriesDataItem>, interval: ITimeInterval) => void;\n\n}\n\nexport interface IXYSeriesPrivate extends ISeriesPrivate {\n\n\tminX?: number;\n\tmaxX?: number;\n\n\tminY?: number;\n\tmaxY?: number;\n\n\tselectionMinX?: number;\n\tselectionMaxX?: number;\n\n\tselectionMinY?: number;\n\tselectionMaxY?: number;\n\n\tvalueXAverage?: number;\n\tvalueXCount?: number;\n\tvalueXSum?: number;\n\tvalueXAbsoluteSum?: number;\n\tvalueXLow?: number;\n\tvalueXHigh?: number;\n\tvalueXOpen?: number;\n\tvalueXClose?: number;\n\n\tvalueYAverage?: number;\n\tvalueYCount?: number;\n\tvalueYSum?: number;\n\tvalueYAbsoluteSum?: number;\n\tvalueYLow?: number;\n\tvalueYHigh?: number;\n\tvalueYOpen?: number;\n\tvalueYClose?: number;\n\n\tvalueXAverageSelection?: number;\n\tvalueXCountSelection?: number;\n\tvalueXSumSelection?: number;\n\tvalueXAbsoluteSumSelection?: number;\n\tvalueXLowSelection?: number;\n\tvalueXHighSelection?: number;\n\tvalueXOpenSelection?: number;\n\tvalueXCloseSelection?: number;\n\n\tvalueYAverageSelection?: number;\n\tvalueYCountSelection?: number;\n\tvalueYSumSelection?: number;\n\tvalueYAbsoluteSumSelection?: number;\n\tvalueYLowSelection?: number;\n\tvalueYHighSelection?: number;\n\tvalueYOpenSelection?: number;\n\tvalueYCloseSelection?: number;\n\n\topenValueXAverage?: number;\n\topenValueXCount?: number;\n\topenValueXSum?: number;\n\topenValueXAbsoluteSum?: number;\n\topenValueXLow?: number;\n\topenValueXHigh?: number;\n\topenValueXOpen?: number;\n\topenValueXClose?: number;\n\n\topenValueYAverage?: number;\n\topenValueYCount?: number;\n\topenValueYSum?: number;\n\topenValueYAbsoluteSum?: number;\n\topenValueYLow?: number;\n\topenValueYHigh?: number;\n\topenValueYOpen?: number;\n\topenValueYClose?: number;\n\n\topenValueXAverageSelection?: number;\n\topenValueXCountSelection?: number;\n\topenValueXSumSelection?: number;\n\topenValueXAbsoluteSumSelection?: number;\n\topenValueXLowSelection?: number;\n\topenValueXHighSelection?: number;\n\topenValueXOpenSelection?: number;\n\topenValueXCloseSelection?: number;\n\n\topenValueYAverageSelection?: number;\n\topenValueYCountSelection?: number;\n\topenValueYSumSelection?: number;\n\topenValueYAbsoluteSumSelection?: number;\n\topenValueYLowSelection?: number;\n\topenValueYHighSelection?: number;\n\topenValueYOpenSelection?: number;\n\topenValueYCloseSelection?: number;\n\n\tlowValueXAverage?: number;\n\tlowValueXCount?: number;\n\tlowValueXSum?: number;\n\tlowValueXAbsoluteSum?: number;\n\tlowValueXLow?: number;\n\tlowValueXHigh?: number;\n\tlowValueXlow?: number;\n\tlowValueXClose?: number;\n\n\tlowValueYAverage?: number;\n\tlowValueYCount?: number;\n\tlowValueYSum?: number;\n\tlowValueYAbsoluteSum?: number;\n\tlowValueYLow?: number;\n\tlowValueYHigh?: number;\n\tlowValueYlow?: number;\n\tlowValueYClose?: number;\n\n\tlowValueXAverageSelection?: number;\n\tlowValueXCountSelection?: number;\n\tlowValueXSumSelection?: number;\n\tlowValueXAbsoluteSumSelection?: number;\n\tlowValueXLowSelection?: number;\n\tlowValueXHighSelection?: number;\n\tlowValueXlowSelection?: number;\n\tlowValueXCloseSelection?: number;\n\n\tlowValueYAverageSelection?: number;\n\tlowValueYCountSelection?: number;\n\tlowValueYSumSelection?: number;\n\tlowValueYAbsoluteSumSelection?: number;\n\tlowValueYLowSelection?: number;\n\tlowValueYHighSelection?: number;\n\tlowValueYlowSelection?: number;\n\tlowValueYCloseSelection?: number;\n\n\thighValueXAverage?: number;\n\thighValueXCount?: number;\n\thighValueXSum?: number;\n\thighValueXAbsoluteSum?: number;\n\thighValueXLow?: number;\n\thighValueXHigh?: number;\n\thighValueXhigh?: number;\n\thighValueXClose?: number;\n\n\thighValueYAverage?: number;\n\thighValueYCount?: number;\n\thighValueYSum?: number;\n\thighValueYAbsoluteSum?: number;\n\thighValueYLow?: number;\n\thighValueYHigh?: number;\n\thighValueYhigh?: number;\n\thighValueYClose?: number;\n\n\thighValueXAverageSelection?: number;\n\thighValueXCountSelection?: number;\n\thighValueXSumSelection?: number;\n\thighValueXAbsoluteSumSelection?: number;\n\thighValueXLowSelection?: number;\n\thighValueXHighSelection?: number;\n\thighValueXhighSelection?: number;\n\thighValueXCloseSelection?: number;\n\n\thighValueYAverageSelection?: number;\n\thighValueYCountSelection?: number;\n\thighValueYSumSelection?: number;\n\thighValueYAbsoluteSumSelection?: number;\n\thighValueYLowSelection?: number;\n\thighValueYHighSelection?: number;\n\thighValueYhighSelection?: number;\n\thighValueYCloseSelection?: number;\n\n\toutOfSelection?: boolean;\n}\n\n\n/**\n * A base class for all XY chart series.\n *\n * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/series/} for more info\n */\nexport abstract class XYSeries extends Series {\n\tpublic static className: string = \"XYSeries\";\n\tpublic static classNames: Array<string> = Series.classNames.concat([XYSeries.className]);\n\n\tdeclare public _settings: IXYSeriesSettings;\n\tdeclare public _privateSettings: IXYSeriesPrivate;\n\tdeclare public _dataItemSettings: IXYSeriesDataItem;\n\tdeclare public _axisRangeType: IXYSeriesAxisRange;\n\tdeclare public _events: IXYSeriesEvents;\n\n\tprotected _xField!: string;\n\tprotected _yField!: string;\n\tprotected _xOpenField!: string;\n\tprotected _yOpenField!: string;\n\n\tprotected _xLowField!: string;\n\tprotected _xHighField!: string;\n\tprotected _yLowField!: string;\n\tprotected _yHighField!: string;\n\n\tprotected _axesDirty: boolean = false;\n\tpublic _stackDirty: boolean = false;\n\n\tprotected _selectionProcessed = false;\n\n\tdeclare public chart: XYChart | undefined;\n\n\tpublic _dataSets: { [index: string]: Array<DataItem<IXYSeriesDataItem>> } = {};\n\n\tpublic _mainContainerMask: Graphics | undefined;\n\n\tprotected _x: number = 0;\n\tprotected _y: number = 0;\n\n\t/**\n\t * A [[Container]] that us used to put series' elements in.\n\t *\n\t * @default Container.new()\n\t */\n\tpublic readonly mainContainer: Container = this.children.push(Container.new(this._root, {}));\n\n\t/**\n\t * A list of axis ranges that affect the series.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/axes/axis-ranges/} for more info\n\t */\n\tpublic readonly axisRanges: List<this[\"_axisRangeType\"]> = new List();\n\n\tprotected _skipped: boolean = false;\n\n\tprotected _couldStackTo: Array<XYSeries> = [];\n\n\tprotected _reallyStackedTo: { [index: number]: XYSeries } = {};\n\n\tpublic _stackedSeries: { [index: number]: XYSeries } = {};\n\n\tprotected _aLocationX0: number = 0;\n\tprotected _aLocationX1: number = 1;\n\tprotected _aLocationY0: number = 0;\n\tprotected _aLocationY1: number = 1;\n\n\tprotected _showBullets: boolean = true;\n\n\tprotected valueXFields = [\n\t\t\"valueX\",\n\t\t\"openValueX\",\n\t\t\"lowValueX\",\n\t\t\"highValueX\"\n\t];\n\n\tprotected valueYFields = [\n\t\t\"valueY\",\n\t\t\"openValueY\",\n\t\t\"lowValueY\",\n\t\t\"highValueY\"\n\t];\n\n\tpublic _valueXFields!: Array<string>;\n\tpublic _valueYFields!: Array<string>;\n\n\t// used for full min/max\n\tprotected _valueXShowFields!: Array<string>;\n\tprotected _valueYShowFields!: Array<string>;\n\n\t// used for selection (uses working)\n\tprotected __valueXShowFields!: Array<string>;\n\tprotected __valueYShowFields!: Array<string>;\n\n\tprotected _emptyDataItem = new DataItem(this, undefined, {});\n\n\tpublic _dataSetId?: string;\n\n\tprotected _tooltipFieldX?: string;\n\tprotected _tooltipFieldY?: string;\n\n\tprotected _afterNew() {\n\t\tthis.fields.push(\"categoryX\", \"categoryY\", \"openCategoryX\", \"openCategoryY\");\n\t\tthis.valueFields.push(\"valueX\", \"valueY\", \"openValueX\", \"openValueY\", \"lowValueX\", \"lowValueY\", \"highValueX\", \"highValueY\");\n\n\t\tthis._setRawDefault(\"vcx\", 1);\n\t\tthis._setRawDefault(\"vcy\", 1);\n\t\t// this can't go to themes, as data might be parsed before theme\n\t\tthis._setRawDefault(\"valueXShow\", \"valueXWorking\");\n\t\tthis._setRawDefault(\"valueYShow\", \"valueYWorking\");\n\n\t\tthis._setRawDefault(\"openValueXShow\", \"openValueXWorking\");\n\t\tthis._setRawDefault(\"openValueYShow\", \"openValueYWorking\");\n\n\t\tthis._setRawDefault(\"lowValueXShow\", \"lowValueXWorking\");\n\t\tthis._setRawDefault(\"lowValueYShow\", \"lowValueYWorking\");\n\n\t\tthis._setRawDefault(\"highValueXShow\", \"highValueXWorking\");\n\t\tthis._setRawDefault(\"highValueYShow\", \"highValueYWorking\");\n\n\t\tthis._setRawDefault(\"lowValueXGrouped\", \"low\");\n\t\tthis._setRawDefault(\"lowValueYGrouped\", \"low\");\n\n\t\tthis._setRawDefault(\"highValueXGrouped\", \"high\");\n\t\tthis._setRawDefault(\"highValueYGrouped\", \"high\");\n\n\n\n\t\tsuper._afterNew();\n\n\t\tthis._settings.xAxis.series.push(this);\n\t\tthis._settings.yAxis.series.push(this);\n\n\t\tthis.set(\"maskContent\", true);\n\n\t\tthis._disposers.push(this.axisRanges.events.onAll((change) => {\n\t\t\tif (change.type === \"clear\") {\n\t\t\t\t$array.each(change.oldValues, (axisRange) => {\n\t\t\t\t\tthis._removeAxisRange(axisRange);\n\t\t\t\t});\n\t\t\t} else if (change.type === \"push\") {\n\t\t\t\tthis._processAxisRange(change.newValue);\n\t\t\t} else if (change.type === \"setIndex\") {\n\t\t\t\tthis._processAxisRange(change.newValue);\n\t\t\t} else if (change.type === \"insertIndex\") {\n\t\t\t\tthis._processAxisRange(change.newValue);\n\t\t\t} else if (change.type === \"removeIndex\") {\n\t\t\t\tthis._removeAxisRange(change.oldValue);\n\t\t\t} else if (change.type === \"moveIndex\") {\n\t\t\t\tthis._processAxisRange(change.value);\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"Unknown IStreamEvent type\");\n\t\t\t}\n\t\t}))\n\n\t\tif (!this.get(\"baseAxis\")) {\n\t\t\tconst xAxis = this.get(\"xAxis\");\n\t\t\tconst yAxis = this.get(\"yAxis\");\n\n\t\t\tif (yAxis.isType<CategoryAxis<any>>(\"CategoryAxis\") || yAxis.isType<DateAxis<any>>(\"DateAxis\")) {\n\t\t\t\tthis.set(\"baseAxis\", yAxis);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.set(\"baseAxis\", xAxis);\n\t\t\t}\n\t\t}\n\n\t\tthis.states.create(\"hidden\", <any>{ opacity: 1, visible: false });\n\n\t\tthis._makeFieldNames();\n\t}\n\n\tprotected _processAxisRange(axisRange: this[\"_axisRangeType\"]) {\n\t\tconst container = Container.new(this._root, {});\n\t\taxisRange.container = container;\n\t\tthis.children.push(container);\n\n\t\taxisRange.series = this;\n\n\t\tconst axisDataItem = axisRange.axisDataItem;\n\t\taxisDataItem.setRaw(\"isRange\", true);\n\n\t\tconst axis = <Axis<AxisRenderer>>axisDataItem.component;\n\t\tif (axis) {\n\t\t\taxis._processAxisRange(axisDataItem, [\"range\", \"series\"]);\n\n\t\t\tconst bullet = axisDataItem.get(\"bullet\");\n\t\t\tif (bullet) {\n\t\t\t\tconst sprite = bullet.get(\"sprite\");\n\t\t\t\tif (sprite) {\n\t\t\t\t\tsprite.setPrivate(\"visible\", false);\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst axisFill = axisDataItem.get(\"axisFill\");\n\t\t\tif (axisFill) {\n\t\t\t\tcontainer.set(\"mask\", axisFill);\n\t\t\t}\n\t\t\taxis._seriesAxisRanges.push(axisDataItem);\n\t\t}\n\t}\n\n\tprotected _removeAxisRange(axisRange: this[\"_axisRangeType\"]) {\n\t\tconst axisDataItem = axisRange.axisDataItem;\n\t\tconst axis = <Axis<AxisRenderer>>axisDataItem.component;\n\t\taxis.disposeDataItem(axisDataItem);\n\n\t\t$array.remove(axis._seriesAxisRanges, axisDataItem);\n\n\t\tconst container = axisRange.container;\n\t\tif (container) {\n\t\t\tcontainer.dispose();\n\t\t}\n\t}\n\n\tprotected _updateFields() {\n\t\tsuper._updateFields();\n\n\t\tthis._valueXFields = [];\n\t\tthis._valueYFields = [];\n\t\tthis._valueXShowFields = [];\n\t\tthis._valueYShowFields = [];\n\n\t\tthis.__valueXShowFields = [];\n\t\tthis.__valueYShowFields = [];\n\n\t\tif (this.valueXFields) {\n\t\t\t$array.each(this.valueXFields as Array<keyof this[\"_settings\"]>, (key) => {\n\t\t\t\tconst field = this.get(<any>(key + \"Field\"));\n\t\t\t\tif (field) {\n\t\t\t\t\tthis._valueXFields.push(<any>key);\n\t\t\t\t\tlet field = this.get(<any>(key + \"Show\"));\n\t\t\t\t\tthis.__valueXShowFields.push(field);\n\n\t\t\t\t\tif (field.indexOf(\"Working\") != -1) {\n\t\t\t\t\t\tthis._valueXShowFields.push(field.split(\"Working\")[0]);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis._valueYShowFields.push(field);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (this.valueYFields) {\n\t\t\t$array.each(this.valueYFields as Array<keyof this[\"_settings\"]>, (key) => {\n\t\t\t\tconst field = this.get(<any>(key + \"Field\"));\n\n\t\t\t\tif (field) {\n\t\t\t\t\tthis._valueYFields.push(<any>key);\n\t\t\t\t\tlet field = this.get(<any>(key + \"Show\"));\n\t\t\t\t\tthis.__valueYShowFields.push(field);\n\n\t\t\t\t\tif (field.indexOf(\"Working\") != -1) {\n\t\t\t\t\t\tthis._valueYShowFields.push(field.split(\"Working\")[0]);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis._valueYShowFields.push(field);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected _dispose() {\n\t\tsuper._dispose();\n\n\t\tconst chart = this.chart;\n\t\tif (chart) {\n\t\t\tchart.series.removeValue(this);\n\t\t}\n\n\t\t$array.removeFirst(this.get(\"xAxis\").series, this);\n\t\t$array.removeFirst(this.get(\"yAxis\").series, this);\n\t}\n\n\t// TODO use  SelectKeys<this[\"_privateSettings\"], number | undefined>\n\tprotected _min<Key extends keyof this[\"_privateSettings\"]>(key: Key, value: number | undefined) {\n\t\tlet newValue = min(this.getPrivate(key) as any, value);\n\t\tthis.setPrivate(key, newValue as any);\n\t}\n\n\t// TODO use  SelectKeys<this[\"_privateSettings\"], number | undefined>\n\tprotected _max<Key extends keyof this[\"_privateSettings\"]>(key: Key, value: number | undefined) {\n\t\tlet newValue = max(this.getPrivate(key) as any, value);\n\t\tthis.setPrivate(key, newValue as any);\n\t}\n\n\tprotected _shouldMakeBullet(dataItem: DataItem<this[\"_dataItemSettings\"]>): boolean {\n\t\tif (!this.get(\"xAxis\").inited || !this.get(\"yAxis\").inited) {\n\t\t\treturn false\n\t\t}\n\t\tif (dataItem.get(this._xField as any) != null && dataItem.get(this._yField as any) != null) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected _makeFieldNames() {\n\t\tconst xAxis = this.get(\"xAxis\");\n\t\tconst yAxis = this.get(\"yAxis\");\n\t\tconst xName = xAxis.getPrivate(\"name\")!;\n\t\tconst xCapName = $utils.capitalizeFirst(xName);\n\n\t\tconst yName = yAxis.getPrivate(\"name\")!;\n\t\tconst yCapName = $utils.capitalizeFirst(yName);\n\n\t\tconst xLetter = xAxis.get(\"renderer\").getPrivate(\"letter\")!\n\t\tconst yLetter = yAxis.get(\"renderer\").getPrivate(\"letter\")!\n\n\t\tconst open = \"open\";\n\t\tconst low = \"low\";\n\t\tconst high = \"high\";\n\t\tconst show = \"Show\";\n\n\t\tif (xAxis.className === \"ValueAxis\") {\n\t\t\tthis._xField = this.get(<any>(xName + xLetter! + show));\n\t\t\tthis._xOpenField = this.get(<any>(open + xCapName + xLetter! + show));\n\t\t\tthis._xLowField = this.get(<any>(low + xCapName + xLetter! + show));\n\t\t\tthis._xHighField = this.get(<any>(high + xCapName + xLetter! + show));\n\t\t}\n\t\telse {\n\t\t\tthis._xField = <any>(xName + xLetter!);\n\t\t\tthis._xOpenField = <any>(open + xCapName + xLetter!);\n\t\t\tthis._xLowField = <any>(low + xCapName + xLetter!);\n\t\t\tthis._xHighField = <any>(high + xCapName + xLetter!);\n\t\t}\n\n\t\tif (yAxis.className === \"ValueAxis\") {\n\t\t\tthis._yField = this.get(<any>(yName + yLetter! + show));\n\t\t\tthis._yOpenField = this.get(<any>(open + yCapName + yLetter! + show));\n\t\t\tthis._yLowField = this.get(<any>(low + yCapName + yLetter! + show));\n\t\t\tthis._yHighField = this.get(<any>(high + yCapName + yLetter! + show));\n\t\t}\n\t\telse {\n\t\t\tthis._yField = <any>(yName + yLetter!);\n\t\t\tthis._yOpenField = <any>(open + yCapName + yLetter!);\n\t\t\tthis._yLowField = <any>(low + yCapName + yLetter!);\n\t\t\tthis._yHighField = <any>(high + yCapName + yLetter!);\n\t\t}\n\t}\n\n\tprotected _fixVC() {\n\t\tconst xAxis = this.get(\"xAxis\");\n\t\tconst yAxis = this.get(\"yAxis\");\n\t\tconst baseAxis = this.get(\"baseAxis\");\n\t\tconst hiddenState = this.states.lookup(\"hidden\");\n\t\tconst sequencedInterpolation = this.get(\"sequencedInterpolation\");\n\n\t\tif (hiddenState) {\n\t\t\tlet value = 0;\n\t\t\tif (sequencedInterpolation) {\n\t\t\t\tvalue = 0.999999999999; // makes animate, good for stacked\n\t\t\t}\n\n\t\t\tif (xAxis === baseAxis) {\n\t\t\t\thiddenState.set(\"vcy\", value);\n\t\t\t}\n\t\t\telse if (yAxis === baseAxis) {\n\t\t\t\thiddenState.set(\"vcx\", value);\n\t\t\t}\n\t\t\telse {\n\t\t\t\thiddenState.set(\"vcy\", value);\n\t\t\t\thiddenState.set(\"vcx\", value);\n\t\t\t}\n\t\t}\n\t}\n\n\n\tprotected _handleMaskBullets() {\n\t\tif (this.isDirty(\"maskBullets\")) {\n\t\t\tthis.bulletsContainer.set(\"maskContent\", this.get(\"maskBullets\"));\n\t\t}\n\t}\n\n\n\tpublic _prepareChildren() {\n\t\tsuper._prepareChildren();\n\n\t\tif (this.isDirty(\"valueYShow\") || this.isDirty(\"valueXShow\" || this.isDirty(\"openValueYShow\") || this.isDirty(\"openValueXShow\") || this.isDirty(\"lowValueYShow\") || this.isDirty(\"lowValueXShow\") || this.isDirty(\"highValueYShow\") || this.isDirty(\"highValueXShow\"))) {\n\t\t\tthis._updateFields();\n\t\t\tthis._makeFieldNames();\n\t\t\tthis._valuesDirty = true;\n\t\t}\n\n\t\tthis.set(\"width\", this.get(\"xAxis\").width());\n\t\tthis.set(\"height\", this.get(\"yAxis\").height());\n\n\t\tthis._handleMaskBullets();\n\n\t\tconst xAxis = this.get(\"xAxis\");\n\t\tconst yAxis = this.get(\"yAxis\");\n\t\tconst baseAxis = this.get(\"baseAxis\");\n\n\t\tconst tooltipPositionX = this.get(\"tooltipPositionX\");\n\t\tlet tooltipFieldX: string;\n\n\t\tswitch (tooltipPositionX) {\n\t\t\tcase \"open\":\n\t\t\t\ttooltipFieldX = this._xOpenField;\n\t\t\t\tbreak;\n\t\t\tcase \"low\":\n\t\t\t\ttooltipFieldX = this._xLowField;\n\t\t\t\tbreak;\n\t\t\tcase \"high\":\n\t\t\t\ttooltipFieldX = this._xHighField;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\ttooltipFieldX = this._xField;\n\t\t}\n\t\tthis._tooltipFieldX = tooltipFieldX;\n\n\t\tconst tooltipPositionY = this.get(\"tooltipPositionY\");\n\t\tlet tooltipFieldY: string;\n\t\tswitch (tooltipPositionY) {\n\t\t\tcase \"open\":\n\t\t\t\ttooltipFieldY = this._yOpenField;\n\t\t\t\tbreak;\n\t\t\tcase \"low\":\n\t\t\t\ttooltipFieldY = this._yLowField;\n\t\t\t\tbreak;\n\t\t\tcase \"high\":\n\t\t\t\ttooltipFieldY = this._yHighField;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\ttooltipFieldY = this._yField;\n\t\t}\n\t\tthis._tooltipFieldY = tooltipFieldY;\n\n\t\tif (this.isDirty(\"baseAxis\")) {\n\t\t\tthis._fixVC();\n\t\t}\n\n\n\t\tthis.set(\"x\", xAxis.x() - $utils.relativeToValue(xAxis.get(\"centerX\", 0), xAxis.width()) - xAxis.parent!.get(\"paddingLeft\", 0));\n\t\tthis.set(\"y\", yAxis.y() - $utils.relativeToValue(yAxis.get(\"centerY\", 0), yAxis.height()) - yAxis.parent!.get(\"paddingTop\", 0));\n\t\tthis.bulletsContainer.set(\"y\", this.y());\n\t\tthis.bulletsContainer.set(\"x\", this.x());\n\n\t\tconst stacked = this.get(\"stacked\");\n\n\t\tif (this.isDirty(\"stacked\")) {\n\t\t\tif (stacked) {\n\t\t\t\tif (this._valuesDirty && !this._dataProcessed) {\n\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis._stack();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._unstack();\n\t\t\t}\n\t\t}\n\n\t\tif (this._valuesDirty && !this._dataProcessed) {\n\t\t\tthis._dataProcessed = true;\n\n\t\t\tif (stacked) {\n\t\t\t\tthis._stack();\n\t\t\t}\n\n\t\t\t$array.each(this.dataItems, (dataItem) => {\n\t\t\t\t$array.each(this._valueXShowFields, (key) => {\n\t\t\t\t\tlet value = dataItem.get(<any>key);\n\t\t\t\t\tif (value != null) {\n\t\t\t\t\t\tif (stacked) {\n\t\t\t\t\t\t\tvalue += this.getStackedXValue(dataItem, key);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis._min(\"minX\", value);\n\t\t\t\t\t\tthis._max(\"maxX\", value);\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\t$array.each(this._valueYShowFields, (key) => {\n\t\t\t\t\tlet value = dataItem.get(<any>key);\n\t\t\t\t\tif (value != null) {\n\t\t\t\t\t\tif (stacked) {\n\t\t\t\t\t\t\tvalue += this.getStackedYValue(dataItem, key);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis._min(\"minY\", value);\n\t\t\t\t\t\tthis._max(\"maxY\", value);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\txAxis.processSeriesDataItem(dataItem, this._valueXFields);\n\t\t\t\tyAxis.processSeriesDataItem(dataItem, this._valueYFields);\n\t\t\t})\n\n\t\t\txAxis._seriesValuesDirty = true;\n\t\t\tyAxis._seriesValuesDirty = true;\n\n\t\t\tif (!this.get(\"ignoreMinMax\")) {\n\t\t\t\tif (this.isPrivateDirty(\"minX\") || this.isPrivateDirty(\"maxX\")) {\n\t\t\t\t\txAxis.markDirtyExtremes();\n\t\t\t\t}\n\t\t\t\tif (this.isPrivateDirty(\"minY\") || this.isPrivateDirty(\"maxY\")) {\n\t\t\t\t\tyAxis.markDirtyExtremes();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._markStakedDirtyStack();\n\n\t\t\t//this.updateLegendMarker(undefined); // causes legend marker to change color instantly when on\n\t\t\tthis.updateLegendValue(undefined);\n\t\t}\n\n\t\tif (this.isDirty(\"vcx\") || this.isDirty(\"vcy\")) {\n\t\t\tthis._markStakedDirtyStack();\n\t\t}\n\n\t\tif (!this._dataGrouped) {\n\t\t\txAxis._groupSeriesData(this);\n\t\t\tyAxis._groupSeriesData(this);\n\t\t\tthis._dataGrouped = true;\n\t\t}\n\n\t\tif (this._valuesDirty || this.isPrivateDirty(\"startIndex\") || this.isPrivateDirty(\"endIndex\") || this.isDirty(\"vcx\") || this.isDirty(\"vcy\") || this._stackDirty) {\n\n\t\t\tlet startIndex = this.startIndex();\n\t\t\tlet endIndex = this.endIndex();\n\t\t\tlet minBulletDistance = this.get(\"minBulletDistance\", 0);\n\t\t\tif (minBulletDistance > 0 && baseAxis) {\n\t\t\t\tif (baseAxis.get(\"renderer\").axisLength() / (endIndex - startIndex) > minBulletDistance) {\n\t\t\t\t\tthis._showBullets = true;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis._showBullets = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ((this._psi != startIndex || this._pei != endIndex || this.isDirty(\"vcx\") || this.isDirty(\"vcy\") || this._stackDirty || this._valuesDirty) && !this._selectionProcessed) {\n\t\t\t\tthis._selectionProcessed = true;\n\n\t\t\t\tconst vcx = this.get(\"vcx\", 1);\n\t\t\t\tconst vcy = this.get(\"vcy\", 1);\n\t\t\t\tconst stacked = this.get(\"stacked\", false);\n\t\t\t\tconst outOfSelection = this.getPrivate(\"outOfSelection\");\n\n\t\t\t\tif (baseAxis === xAxis) {\n\t\t\t\t\tyAxis._calculateTotals();\n\t\t\t\t\tthis.setPrivateRaw(\"selectionMinY\", undefined);\n\t\t\t\t\tthis.setPrivateRaw(\"selectionMaxY\", undefined);\n\t\t\t\t\tif (!outOfSelection) {\n\t\t\t\t\t\tfor (let i = startIndex; i < endIndex; i++) {\n\t\t\t\t\t\t\tthis.processYSelectionDataItem(this.dataItems[i], vcy, stacked);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tyAxis.markDirtySelectionExtremes();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (baseAxis === yAxis) {\n\t\t\t\t\txAxis._calculateTotals();\n\t\t\t\t\tthis.setPrivateRaw(\"selectionMinX\", undefined);\n\t\t\t\t\tthis.setPrivateRaw(\"selectionMaxX\", undefined);\n\t\t\t\t\tif (!outOfSelection) {\n\t\t\t\t\t\tfor (let i = startIndex; i < endIndex; i++) {\n\t\t\t\t\t\t\tthis.processXSelectionDataItem(this.dataItems[i], vcx, stacked);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tyAxis.markDirtySelectionExtremes();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (baseAxis === xAxis) {\n\t\t\t\t\tif (this.get(\"valueYShow\") !== \"valueYWorking\") {\n\t\t\t\t\t\tconst selectionMinY = this.getPrivate(\"selectionMinY\");\n\t\t\t\t\t\tif (selectionMinY != null) {\n\t\t\t\t\t\t\tthis.setPrivateRaw(\"minY\", selectionMinY);\n\t\t\t\t\t\t\tyAxis.markDirtyExtremes();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst selectionMaxY = this.getPrivate(\"selectionMaxY\");\n\t\t\t\t\t\tif (selectionMaxY != null) {\n\t\t\t\t\t\t\tthis.setPrivateRaw(\"maxY\", selectionMaxY);\n\t\t\t\t\t\t\tyAxis.markDirtyExtremes();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (baseAxis === yAxis) {\n\t\t\t\t\tif (this.get(\"valueXShow\") !== \"valueXWorking\") {\n\t\t\t\t\t\tconst selectionMinX = this.getPrivate(\"selectionMinX\");\n\t\t\t\t\t\tif (selectionMinX != null) {\n\t\t\t\t\t\t\tthis.setPrivateRaw(\"minX\", selectionMinX);\n\t\t\t\t\t\t\tyAxis.markDirtyExtremes();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst selectionMaxX = this.getPrivate(\"selectionMaxX\")\n\t\t\t\t\t\tif (selectionMaxX != null) {\n\t\t\t\t\t\t\tthis.setPrivateRaw(\"maxX\", selectionMaxX);\n\t\t\t\t\t\t\txAxis.markDirtyExtremes();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this.isPrivateDirty(\"selectionMinX\") || this.isPrivateDirty(\"selectionMaxX\")) {\n\t\t\t\t\txAxis.markDirtySelectionExtremes();\n\t\t\t\t}\n\n\t\t\t\tif (this.isPrivateDirty(\"selectionMinY\") || this.isPrivateDirty(\"selectionMaxY\")) {\n\t\t\t\t\tyAxis.markDirtySelectionExtremes();\n\t\t\t\t}\n\t\t\t\t// this.updateLegendValue(undefined); flickers while panning\n\t\t\t}\n\t\t}\n\t}\n\n\n\tprotected _makeRangeMask() {\n\t\tif (this.axisRanges.length > 0) {\n\t\t\tlet mainContainerMask = this._mainContainerMask;\n\t\t\tif (mainContainerMask == null) {\n\t\t\t\tmainContainerMask = this.children.push(Graphics.new(this._root, {}));\n\t\t\t\tthis._mainContainerMask = mainContainerMask;\n\n\t\t\t\tmainContainerMask.set(\"draw\", (display, target) => {\n\t\t\t\t\tconst parent = this.parent;\n\t\t\t\t\tif (parent) {\n\t\t\t\t\t\tconst w = this._root.container.width();\n\t\t\t\t\t\tconst h = this._root.container.height();\n\t\t\t\t\t\tdisplay.moveTo(-w, -h);\n\t\t\t\t\t\tdisplay.lineTo(-w, h * 2);\n\t\t\t\t\t\tdisplay.lineTo(w * 2, h * 2);\n\t\t\t\t\t\tdisplay.lineTo(w * 2, -h);\n\t\t\t\t\t\tdisplay.lineTo(-w, -h);\n\n\n\t\t\t\t\t\tthis.axisRanges.each((axisRange) => {\n\t\t\t\t\t\t\tconst fill = axisRange.axisDataItem.get(\"axisFill\");\n\n\t\t\t\t\t\t\tif (parent) {\n\t\t\t\t\t\t\t\tif (fill) {\n\t\t\t\t\t\t\t\t\tlet draw = fill.get(\"draw\");\n\t\t\t\t\t\t\t\t\tif (draw) {\n\t\t\t\t\t\t\t\t\t\tdraw(display, target);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\tthis.mainContainer._display.mask = mainContainerMask!._display;\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tmainContainerMask.markDirty();\n\t\t\tmainContainerMask._markDirtyKey(\"fill\");\n\t\t}\n\t\telse {\n\t\t\tthis.mainContainer._display.mask = null;\n\t\t}\n\t}\n\n\n\tpublic _updateChildren() {\n\t\tsuper._updateChildren();\n\t\t// save for performance\n\t\tthis._x = this.x();\n\t\tthis._y = this.y();\n\t\tthis._makeRangeMask();\n\t}\n\n\tprotected _stack() {\n\t\tconst chart = this.chart;\n\t\tif (chart) {\n\t\t\tconst seriesIndex = chart.series.indexOf(this);\n\n\t\t\tthis._couldStackTo = [];\n\n\t\t\tif (seriesIndex > 0) {\n\t\t\t\tlet series: XYSeries;\n\n\t\t\t\tfor (let i = seriesIndex - 1; i >= 0; i--) {\n\t\t\t\t\tseries = chart.series.getIndex(i)!;\n\t\t\t\t\tif (series.get(\"xAxis\") === this.get(\"xAxis\") && series.get(\"yAxis\") === this.get(\"yAxis\") && series.className === this.className) {\n\t\t\t\t\t\tthis._couldStackTo.push(series);\n\t\t\t\t\t\tif (!series.get(\"stacked\")) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._stackDataItems();\n\t\t}\n\t}\n\n\tprotected _unstack() {\n\t\t$object.each(this._reallyStackedTo, (_key, value) => {\n\t\t\tdelete (value._stackedSeries[this.uid]);\n\t\t})\n\n\t\tthis._reallyStackedTo = {};\n\t\t$array.each(this.dataItems, (dataItem) => {\n\t\t\tdataItem.setRaw(\"stackToItemY\", undefined);\n\t\t\tdataItem.setRaw(\"stackToItemX\", undefined);\n\t\t})\n\t}\n\n\tprotected _stackDataItems() {\n\t\t// this works only with the same number of data @todo: search by date/category?\n\t\tconst baseAxis = this.get(\"baseAxis\");\n\t\tconst xAxis = this.get(\"xAxis\");\n\t\tconst yAxis = this.get(\"yAxis\");\n\n\t\tlet field: \"valueX\" | \"valueY\";\n\t\tlet stackToItemKey: \"stackToItemX\" | \"stackToItemY\";\n\t\tif (baseAxis === xAxis) {\n\t\t\tfield = \"valueY\";\n\t\t\tstackToItemKey = \"stackToItemY\";\n\t\t}\n\t\telse if (baseAxis === yAxis) {\n\t\t\tfield = \"valueX\";\n\t\t\tstackToItemKey = \"stackToItemX\";\n\t\t}\n\n\t\tlet len = this._couldStackTo.length;\n\t\tlet index = 0;\n\t\tconst stackToNegative = this.get(\"stackToNegative\");\n\n\t\tthis._reallyStackedTo = {};\n\n\t\t$array.each(this.dataItems, (dataItem) => {\n\t\t\tfor (let s = 0; s < len; s++) {\n\t\t\t\tlet stackToSeries = this._couldStackTo[s];\n\t\t\t\tlet stackToItem = stackToSeries.dataItems[index];\n\t\t\t\tlet value = dataItem.get(field);\n\n\t\t\t\tif (stackToItem) {\n\t\t\t\t\tlet stackValue = stackToItem.get(field);\n\t\t\t\t\tif (stackToNegative) {\n\t\t\t\t\t\tif ($type.isNumber(value)) {\n\t\t\t\t\t\t\tif ($type.isNumber(stackValue)) {\n\t\t\t\t\t\t\t\tif (value >= 0 && stackValue >= 0) {\n\t\t\t\t\t\t\t\t\tdataItem.setRaw(stackToItemKey, stackToItem);\n\t\t\t\t\t\t\t\t\tthis._reallyStackedTo[stackToSeries.uid] = stackToSeries;\n\t\t\t\t\t\t\t\t\tstackToSeries._stackedSeries[this.uid] = this;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (value < 0 && stackValue < 0) {\n\t\t\t\t\t\t\t\t\tdataItem.setRaw(stackToItemKey, stackToItem);\n\t\t\t\t\t\t\t\t\tthis._reallyStackedTo[stackToSeries.uid] = stackToSeries;\n\t\t\t\t\t\t\t\t\tstackToSeries._stackedSeries[this.uid] = this;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif ($type.isNumber(value) && $type.isNumber(stackValue)) {\n\t\t\t\t\t\t\tdataItem.setRaw(stackToItemKey, stackToItem);\n\t\t\t\t\t\t\tthis._reallyStackedTo[stackToSeries.uid] = stackToSeries;\n\t\t\t\t\t\t\tstackToSeries._stackedSeries[this.uid] = this;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tindex++;\n\t\t})\n\t}\n\n\tprotected processXSelectionDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>, vcx: number, stacked: boolean) {\n\t\t$array.each(this.__valueXShowFields, (key) => {\n\t\t\tlet value = dataItem.get(<any>key);\n\t\t\tif (value != null) {\n\t\t\t\tif (stacked) {\n\t\t\t\t\tvalue += this.getStackedXValueWorking(dataItem, key);\n\t\t\t\t}\n\n\t\t\t\tthis._min(\"selectionMinX\", value);\n\t\t\t\tthis._max(\"selectionMaxX\", value * vcx);\n\t\t\t}\n\t\t})\n\t}\n\n\tprotected processYSelectionDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>, vcy: number, stacked: boolean) {\n\t\t$array.each(this.__valueYShowFields, (key) => {\n\n\t\t\tlet value = dataItem.get(<any>key);\n\t\t\tif (value != null) {\n\t\t\t\tif (stacked) {\n\t\t\t\t\tvalue += this.getStackedYValueWorking(dataItem, key);\n\t\t\t\t}\n\n\t\t\t\tthis._min(\"selectionMinY\", value);\n\t\t\t\tthis._max(\"selectionMaxY\", value * vcy);\n\t\t\t}\n\t\t})\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic getStackedYValueWorking(dataItem: DataItem<IXYSeriesDataItem>, key: string): number {\n\t\tconst stackToItem = dataItem.get(\"stackToItemY\");\n\n\t\tif (stackToItem) {\n\t\t\tconst stackedToSeries = stackToItem.component as XYSeries;\n\n\t\t\treturn stackToItem.get(key as any, 0) * stackedToSeries.get(\"vcy\", 1) + this.getStackedYValueWorking(stackToItem, key);\n\t\t}\n\t\treturn 0;\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic getStackedXValueWorking(dataItem: DataItem<IXYSeriesDataItem>, key: string): number {\n\t\tconst stackToItem = dataItem.get(\"stackToItemX\");\n\n\t\tif (stackToItem) {\n\t\t\tconst stackedToSeries = stackToItem.component as XYSeries;\n\t\t\treturn stackToItem.get(key as any, 0) * stackedToSeries.get(\"vcx\", 1) + this.getStackedXValueWorking(stackToItem, key);\n\t\t}\n\t\treturn 0;\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic getStackedYValue(dataItem: DataItem<IXYSeriesDataItem>, key: string): number {\n\t\tconst stackToItem = dataItem.get(\"stackToItemY\");\n\n\t\tif (stackToItem) {\n\t\t\treturn stackToItem.get(key as any, 0) + this.getStackedYValue(stackToItem, key);\n\t\t}\n\t\treturn 0;\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic getStackedXValue(dataItem: DataItem<IXYSeriesDataItem>, key: string): number {\n\t\tconst stackToItem = dataItem.get(\"stackToItemX\");\n\n\t\tif (stackToItem) {\n\t\t\treturn stackToItem.get(key as any, 0) + this.getStackedXValue(stackToItem, key);\n\t\t}\n\t\treturn 0;\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic createLegendMarker(_dataItem?: DataItem<this[\"_dataItemSettings\"]>) {\n\t\tthis.updateLegendMarker();\n\t}\n\n\tpublic _markDirtyAxes() {\n\t\tthis._axesDirty = true;\n\t\tthis.markDirty();\n\t}\n\n\tpublic _markDataSetDirty() {\n\t\tthis._afterDataChange();\n\t\tthis._valuesDirty = true;\n\t\tthis._dataProcessed = false;\n\t\tthis._aggregatesCalculated = false;\n\t\tthis.markDirty();\n\t}\n\n\tpublic _clearDirty() {\n\t\tsuper._clearDirty();\n\t\tthis._axesDirty = false;\n\t\tthis._selectionProcessed = false;\n\t\tthis._stackDirty = false;\n\t\tthis._dataProcessed = false;\n\t}\n\n\tpublic _positionBullet(bullet: Bullet) {\n\n\t\tlet sprite = bullet.get(\"sprite\");\n\t\tif (sprite) {\n\t\t\tlet dataItem = sprite.dataItem as DataItem<this[\"_dataItemSettings\"]>;\n\n\t\t\tlet locationX = bullet.get(\"locationX\", dataItem.get(\"locationX\", 0.5));\n\t\t\tlet locationY = bullet.get(\"locationY\", dataItem.get(\"locationY\", 0.5));\n\n\t\t\tlet xAxis = this.get(\"xAxis\");\n\t\t\tlet yAxis = this.get(\"yAxis\");\n\n\t\t\tconst positionX = xAxis.getDataItemPositionX(dataItem, this._xField, locationX, this.get(\"vcx\", 1));\n\t\t\tconst positionY = yAxis.getDataItemPositionY(dataItem, this._yField, locationY, this.get(\"vcy\", 1))\n\n\t\t\tlet point = this.getPoint(positionX, positionY);\n\n\t\t\tlet left = dataItem.get(\"left\", point.x);\n\t\t\tlet right = dataItem.get(\"right\", point.x);\n\t\t\tlet top = dataItem.get(\"top\", point.y);\n\t\t\tlet bottom = dataItem.get(\"bottom\", point.y);\n\n\t\t\tif (this._shouldShowBullet(positionX, positionY)) {\n\t\t\t\tif (!bullet.getPrivate(\"hidden\")) {\n\t\t\t\t\tsprite.setPrivate(\"visible\", true);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tsprite.setPrivate(\"visible\", false);\n\t\t\t\t}\n\n\t\t\t\tlet w = right - left;\n\t\t\t\tlet h = bottom - top;\n\n\t\t\t\tif (sprite.isType(\"Label\")) {\n\t\t\t\t\tsprite.set(\"maxWidth\", Math.abs(w));\n\t\t\t\t\tsprite.set(\"maxHeight\", Math.abs(h));\n\t\t\t\t}\n\n\t\t\t\tlet x = left + w * locationX;\n\t\t\t\tlet y = bottom - h * locationY;\n\n\t\t\t\tsprite.set(\"x\", x);\n\t\t\t\tsprite.set(\"y\", y);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tsprite.setPrivate(\"visible\", false);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _shouldShowBullet(_positionX: number, _positionY: number): boolean {\n\t\treturn this._showBullets;\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic setDataSet(id: string) {\n\t\tif (this._dataSets[id]) {\n\t\t\tthis._handleDataSetChange();\n\t\t\tthis._dataItems = this._dataSets[id];\n\t\t\tthis._markDataSetDirty();\n\t\t\tthis._dataSetId = id;\n\n\t\t\tconst type = \"datasetchanged\";\n\t\t\tif (this.events.isEnabled(type)) {\n\t\t\t\tthis.events.dispatch(type, { type: type, target: this, id: id });\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _handleDataSetChange() {\n\t\tif (this.bullets.length > 0) {\n\t\t\t$array.each(this._dataItems, (dataItem) => {\n\t\t\t\tlet bullets = dataItem.bullets;\n\t\t\t\tif (bullets) {\n\t\t\t\t\t$array.each(bullets, (bullet) => {\n\t\t\t\t\t\tlet sprite = bullet.get(\"sprite\");\n\t\t\t\t\t\tif (sprite) {\n\t\t\t\t\t\t\tsprite.setPrivate(\"visible\", false);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tthis._selectionProcessed = false; // for totals to be calculated\n\t}\n\n\t/**\n\t * Shows hidden series.\n\t *\n\t * @param   duration  Duration of animation in milliseconds\n\t * @return            Animation promise\n\t */\n\tpublic async show(duration?: number): Promise<void> {\n\t\tthis._fixVC();\n\t\tlet promises: Array<Promise<any>> = [];\n\t\tpromises.push(super.show(duration).then(() => {\n\t\t\tthis._isShowing = false;\n\t\t\tlet xAxis = this.get(\"xAxis\");\n\t\t\tlet yAxis = this.get(\"yAxis\");\n\t\t\tlet baseAxis = this.get(\"baseAxis\");\n\t\t\tif (yAxis !== baseAxis) {\n\t\t\t\tyAxis.markDirtySelectionExtremes();\n\t\t\t}\n\t\t\tif (xAxis !== baseAxis) {\n\t\t\t\txAxis.markDirtySelectionExtremes();\n\t\t\t}\n\t\t}));\n\t\tpromises.push(this.bulletsContainer.show(duration));\n\t\tpromises.push(this._sequencedShowHide(true, duration));\n\t\tawait Promise.all(promises);\n\t}\n\n\t/**\n\t * Hides series.\n\t *\n\t * @param   duration  Duration of animation in milliseconds\n\t * @return            Animation promise\n\t */\n\tpublic async hide(duration?: number): Promise<void> {\n\t\tthis._fixVC();\n\t\tlet promises: Promise<any>[] = [];\n\t\tpromises.push(super.hide(duration).then(() => {\n\t\t\tthis._isHiding = false;\n\t\t}));\n\t\tpromises.push(this.bulletsContainer.hide(duration));\n\t\tpromises.push(this._sequencedShowHide(false, duration));\n\t\tawait Promise.all(promises);\n\t}\n\n\t/**\n\t * Shows series's data item.\n\t *\n\t * @param   dataItem  Data item\n\t * @param   duration  Animation duration in milliseconds\n\t * @return            Promise\n\t */\n\tpublic async showDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>, duration?: number): Promise<void> {\n\t\tconst promises = [super.showDataItem(dataItem, duration)];\n\n\t\tif (!$type.isNumber(duration)) {\n\t\t\tduration = this.get(\"stateAnimationDuration\", 0);\n\t\t}\n\n\t\tconst easing = this.get(\"stateAnimationEasing\");\n\n\t\t$array.each(this._valueFields, (key) => {\n\t\t\tpromises.push(dataItem.animate({ key: key + \"Working\" as any, to: dataItem.get(key as any), duration: duration!, easing: easing }).waitForStop());\n\t\t})\n\n\t\tawait Promise.all(promises);\n\t}\n\n\t/**\n\t * Hides series's data item.\n\t *\n\t * @param   dataItem  Data item\n\t * @param   duration  Animation duration in milliseconds\n\t * @return            Promise\n\t */\n\tpublic async hideDataItem(dataItem: DataItem<this[\"_dataItemSettings\"]>, duration?: number): Promise<void> {\n\t\tconst promises = [super.hideDataItem(dataItem, duration)];\n\n\t\tconst hiddenState = this.states.create(\"hidden\", {})\n\n\t\tif (!$type.isNumber(duration)) {\n\t\t\tduration = hiddenState.get(\"stateAnimationDuration\", this.get(\"stateAnimationDuration\", 0));\n\t\t}\n\n\t\tconst easing = hiddenState.get(\"stateAnimationEasing\", this.get(\"stateAnimationEasing\"));\n\n\t\tconst xAxis = this.get(\"xAxis\");\n\t\tconst yAxis = this.get(\"yAxis\");\n\t\tconst baseAxis = this.get(\"baseAxis\");\n\t\tconst stacked = this.get(\"stacked\");\n\n\t\tif (baseAxis === xAxis || !baseAxis) {\n\n\t\t\t$array.each(this._valueYFields, (key) => {\n\t\t\t\tlet min = yAxis.getPrivate(\"min\");\n\t\t\t\tlet baseValue = yAxis.baseValue();\n\t\t\t\tif ($type.isNumber(min) && min > baseValue) {\n\t\t\t\t\tbaseValue = min;\n\t\t\t\t}\n\t\t\t\tif (stacked) {\n\t\t\t\t\tbaseValue = 0;\n\t\t\t\t}\n\t\t\t\tpromises.push(dataItem.animate({ key: key + \"Working\" as any, to: baseValue, duration: duration!, easing: easing }).waitForStop());\n\t\t\t})\n\t\t}\n\t\tif (baseAxis === yAxis || !baseAxis) {\n\n\t\t\tlet min = xAxis.getPrivate(\"min\");\n\t\t\tlet baseValue = xAxis.baseValue();\n\t\t\tif ($type.isNumber(min) && min > baseValue) {\n\t\t\t\tbaseValue = min;\n\t\t\t}\n\t\t\tif (stacked) {\n\t\t\t\tbaseValue = 0;\n\t\t\t}\n\n\t\t\t$array.each(this._valueXFields, (key) => {\n\t\t\t\tpromises.push(dataItem.animate({ key: key + \"Working\" as any, to: baseValue, duration: duration!, easing: easing }).waitForStop());\n\t\t\t})\n\t\t}\n\n\t\tawait Promise.all(promises);\n\t}\n\n\tpublic _markDirtyStack() {\n\t\tthis._stackDirty = true;\n\t\tthis.markDirty();\n\t\tthis._markStakedDirtyStack();\n\t}\n\n\tprotected _markStakedDirtyStack() {\n\t\tconst stackedSeries = this._stackedSeries;\n\t\tif (stackedSeries) {\n\n\t\t\t$object.each(stackedSeries, (_key, value) => {\n\t\t\t\tif (!value._stackDirty) {\n\t\t\t\t\tvalue._markDirtyStack();\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\tpublic _afterChanged() {\n\t\tsuper._afterChanged();\n\t\tif (this._skipped) {\n\t\t\tthis._markDirtyAxes();\n\t\t\tthis._skipped = false;\n\t\t}\n\t}\n\n\t/**\n\t * Shows a tooltip for specific data item.\n\t *\n\t * @param  dataItem  Data item\n\t */\n\tpublic showDataItemTooltip(dataItem: DataItem<this[\"_dataItemSettings\"]> | undefined) {\n\t\tthis.updateLegendMarker(dataItem);\n\t\tthis.updateLegendValue(dataItem);\n\n\t\tif (this.get(\"tooltip\")) {\n\t\t\tif (!this.isHidden()) {\n\t\t\t\tconst tooltip = this.get(\"tooltip\")!;\n\t\t\t\tif (tooltip) {\n\t\t\t\t\ttooltip._setDataItem(dataItem);\n\n\t\t\t\t\tif (dataItem) {\n\t\t\t\t\t\tlet locationX = this.get(\"locationX\", 0);\n\t\t\t\t\t\tlet locationY = this.get(\"locationY\", 1);\n\n\t\t\t\t\t\tlet itemLocationX = dataItem.get(\"locationX\", locationX);\n\t\t\t\t\t\tlet itemLocationY = dataItem.get(\"locationY\", locationY);\n\n\t\t\t\t\t\tconst xAxis = this.get(\"xAxis\");\n\t\t\t\t\t\tconst yAxis = this.get(\"yAxis\");\n\n\t\t\t\t\t\tconst vcx = this.get(\"vcx\", 1);\n\t\t\t\t\t\tconst vcy = this.get(\"vcy\", 1);\n\n\t\t\t\t\t\tconst xPos = xAxis.getDataItemPositionX(dataItem, this._tooltipFieldX!, this._aLocationX0 + (this._aLocationX1 - this._aLocationX0) * itemLocationX, vcx);\n\t\t\t\t\t\tconst yPos = yAxis.getDataItemPositionY(dataItem, this._tooltipFieldY!, this._aLocationY0 + (this._aLocationY1 - this._aLocationY0) * itemLocationY, vcy);\n\n\t\t\t\t\t\tconst point = this.getPoint(xPos, yPos);\n\n\t\t\t\t\t\tlet show = true;\n\t\t\t\t\t\t$array.each(this._valueFields, (field) => {\n\t\t\t\t\t\t\tif (dataItem.get(field as any) == null) {\n\t\t\t\t\t\t\t\tshow = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\n\t\t\t\t\t\tif (show) {\n\t\t\t\t\t\t\tconst chart = this.chart;\n\t\t\t\t\t\t\tif (chart && chart.inPlot(point)) {\n\t\t\t\t\t\t\t\ttooltip.label.text.markDirtyText();\n\t\t\t\t\t\t\t\ttooltip.set(\"tooltipTarget\", this._getTooltipTarget(dataItem));\n\t\t\t\t\t\t\t\ttooltip.set(\"pointTo\", this._display.toGlobal({ x: point.x, y: point.y }));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\ttooltip._setDataItem(undefined);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\ttooltip._setDataItem(undefined);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.hideTooltip();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _getTooltipTarget(dataItem: DataItem<this[\"_dataItemSettings\"]>): Sprite {\n\t\tif (this.get(\"seriesTooltipTarget\") == \"bullet\") {\n\t\t\tconst bullets = dataItem.bullets;\n\t\t\tif (bullets && bullets.length > 0) {\n\t\t\t\tconst bullet = bullets[0];\n\t\t\t\tconst sprite = bullet.get(\"sprite\");\n\t\t\t\tif (sprite) {\n\t\t\t\t\treturn sprite;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic updateLegendValue(dataItem: DataItem<this[\"_dataItemSettings\"]> | undefined) {\n\t\tconst legendDataItem = this.get(\"legendDataItem\");\n\n\t\tif (legendDataItem) {\n\n\t\t\tconst label = legendDataItem.get(\"label\");\n\t\t\tif (label) {\n\t\t\t\tlet txt = \"\";\n\t\t\t\tif (dataItem) {\n\t\t\t\t\tlabel._setDataItem(dataItem);\n\t\t\t\t\ttxt = this.get(\"legendLabelText\", label.get(\"text\", this.get(\"name\", \"\")));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tlabel._setDataItem(this._emptyDataItem);\n\t\t\t\t\ttxt = this.get(\"legendRangeLabelText\", this.get(\"legendLabelText\", label.get(\"text\", this.get(\"name\", \"\"))));\n\t\t\t\t}\n\n\t\t\t\tlabel.set(\"text\", txt);\n\t\t\t}\n\n\t\t\tconst valueLabel = legendDataItem.get(\"valueLabel\");\n\t\t\tif (valueLabel) {\n\t\t\t\tlet txt = \"\";\n\t\t\t\tif (dataItem) {\n\t\t\t\t\tvalueLabel._setDataItem(dataItem);\n\t\t\t\t\ttxt = this.get(\"legendValueText\", valueLabel.get(\"text\", \"\"));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tvalueLabel._setDataItem(this._emptyDataItem);\n\t\t\t\t\ttxt = this.get(\"legendRangeValueText\", valueLabel.get(\"text\", \"\"));\n\t\t\t\t}\n\n\t\t\t\tvalueLabel.set(\"text\", txt);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _getItemReaderLabel(): string {\n\t\tlet text = \"X: {\" + this._xField;\n\t\tif (this.get(\"xAxis\").isType<DateAxis<any>>(\"DateAxis\")) {\n\t\t\ttext += \".formatDate()\";\n\t\t}\n\t\ttext += \"}; Y: {\" + this._yField;\n\t\tif (this.get(\"yAxis\").isType<DateAxis<any>>(\"DateAxis\")) {\n\t\t\ttext += \".formatDate()\";\n\t\t}\n\t\ttext += \"}\";\n\t\treturn text;\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic getPoint(positionX: number, positionY: number): IPoint {\n\t\tlet x = this.get(\"xAxis\").get(\"renderer\").positionToCoordinate(positionX);\n\t\tlet y = this.get(\"yAxis\").get(\"renderer\").positionToCoordinate(positionY);\n\n\t\treturn { x: x, y: y };\n\t}\n\n\tprotected _shouldInclude(_position: number): boolean {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic handleCursorHide() {\n\t\tthis.hideTooltip();\n\t\tthis.updateLegendValue(undefined);\n\t\tthis.updateLegendMarker(undefined);\n\t}\n\n\tpublic _afterDataChange() {\n\t\tsuper._afterDataChange();\n\t\tthis.resetExtremes();\n\t}\n\n\n\t// todo description\n\tpublic resetExtremes() {\n\t\tthis.setPrivate(\"selectionMinX\", undefined);\n\t\tthis.setPrivate(\"selectionMaxX\", undefined);\n\t\tthis.setPrivate(\"selectionMinY\", undefined);\n\t\tthis.setPrivate(\"selectionMaxY\", undefined);\n\n\t\tthis.setPrivate(\"minX\", undefined);\n\t\tthis.setPrivate(\"minY\", undefined);\n\t\tthis.setPrivate(\"maxX\", undefined);\n\t\tthis.setPrivate(\"maxY\", undefined);\n\t}\n\n\t/**\n\t * Creates and returns an axis range object.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/charts/xy-chart/axes/axis-ranges/} for more info\n\t * @param   axisDataItem  Axis data item\n\t * @return                Axis range\n\t */\n\tpublic createAxisRange(axisDataItem: DataItem<IAxisDataItem>): this[\"_axisRangeType\"] {\n\t\treturn this.axisRanges.push({\n\t\t\taxisDataItem: axisDataItem\n\t\t})\n\t}\n}\n"]},"metadata":{},"sourceType":"module"}