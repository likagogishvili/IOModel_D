{"ast":null,"code":"import { __extends } from \"tslib\";\nimport { Entity } from \"./Entity\";\nimport { StyleRule } from \"./Utils\";\nimport { MultiDisposer, CounterDisposer } from \"../../core/util/Disposer\";\nimport * as $utils from \"./Utils\";\n/**\r\n * @ignore\r\n */\n\nvar rules;\n/**\r\n * @ignore\r\n */\n\nfunction modalCSS(element, root, _prefix) {\n  var ic = root.interfaceColors;\n  var active = ic.get(\"secondaryButton\").toCSS();\n  var text = ic.get(\"text\").toCSS();\n  var shadow = ic.get(\"alternativeBackground\").toCSS(0.45); //const altbg = ic.get(\"alternativeBackground\")!.toCSS();\n\n  if (!rules) {\n    var disposer_1 = new MultiDisposer([new StyleRule(element, \".am5-modal\", {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"position\": \"absolute\",\n      \"z-index\": \"100000\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }), new StyleRule(element, \".am5-modal-curtain\", {\n      \"top\": \"0\",\n      \"left\": \"0\",\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"position\": \"absolute\",\n      \"background\": ic.get(\"background\").toCSS(0.5),\n      \"z-index\": \"100\"\n    }), new StyleRule(element, \".am5-modal-wrapper\", {\n      \"top\": \"0\",\n      \"left\": \"0\",\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"position\": \"absolute\",\n      \"text-align\": \"center\",\n      \"white-space\": \"nowrap\",\n      \"background\": ic.get(\"background\").toCSS(0.5),\n      \"z-index\": \"101\"\n    }), new StyleRule(element, \".am5-modal-wrapper:before\", {\n      \"content\": \"''\",\n      \"display\": \"inline-block\",\n      \"height\": \"100%\",\n      \"vertical-align\": \"middle\",\n      \"margin-right\": \"-0.25em\"\n    }), new StyleRule(element, \".am5-modal-content\", {\n      \"display\": \"inline-block\",\n      \"padding\": \"1.2em\",\n      \"vertical-align\": \"middle\",\n      \"text-align\": \"left\",\n      \"white-space\": \"normal\",\n      \"background\": ic.get(\"background\").toCSS(),\n      //\"border\": \"1px solid \" + ic.get(\"alternativeBackground\")!.toCSS(),\n      \"border-radius\": \"4px\",\n      \"-webkit-box-shadow\": \"0px 0px 36px 0px \" + shadow,\n      \"box-shadow\": \"0px 0px 36px 0px \" + shadow,\n      \"color\": text\n    }), new StyleRule(element, \".am5-modal-content h1\", {\n      \"font-size\": \"1em\",\n      \"margin\": \"0 0 0.5em 0\"\n    }), new StyleRule(element, \".am5-modal-table\", {\n      \"display\": \"table\",\n      \"margin\": \"1em 0\"\n    }), new StyleRule(element, \".am5-modal-table-row\", {\n      \"display\": \"table-row\"\n    }), new StyleRule(element, \".am5-modal-table-heading\", {\n      \"display\": \"table-heading\",\n      \"padding\": \"3px 10px 3px 0\"\n    }), new StyleRule(element, \".am5-modal-table-cell\", {\n      \"display\": \"table-cell\",\n      \"padding\": \"3px 0 3px 0\"\n    }), new StyleRule(element, \".am5-modal-table-cell > *\", {\n      \"vertical-align\": \"middle\"\n    }), new StyleRule(element, \".am5-modal-content input[type=text], .am5-modal-content input[type=number], .am5-modal-content select\", {\n      \"border\": \"1px solid \" + active,\n      \"border-radius\": \"4px\",\n      \"padding\": \"3px 5px\",\n      \"margin\": \"2px\"\n    }), new StyleRule(element, \".am5-modal-input-narrow\", {\n      \"width\": \"50px\"\n    }), new StyleRule(element, \".am5-modal-button\", {\n      \"font-weight\": \"400\",\n      \"color\": ic.get(\"secondaryButtonText\").toCSS(),\n      \"line-height\": \"1.5\",\n      \"text-align\": \"center\",\n      \"text-decoration\": \"none\",\n      \"vertical-align\": \"middle\",\n      \"cursor\": \"pointer\",\n      \"padding\": \"0.2em 0.8em\",\n      \"font-size\": \"1em\",\n      \"border-radius\": \"0.25em\",\n      \"margin\": \"0 0.25em 0 0\",\n      \"border\": \"1px solid \" + ic.get(\"secondaryButtonStroke\").toCSS(),\n      \"background\": ic.get(\"secondaryButton\").toCSS()\n    }), new StyleRule(element, \".am5-modal-button:hover\", {\n      \"background\": ic.get(\"secondaryButtonHover\").toCSS()\n    }), new StyleRule(element, \".am5-modal-button.am5-modal-primary\", {\n      \"color\": ic.get(\"primaryButtonText\").toCSS(),\n      \"border\": \"1px solid \" + ic.get(\"primaryButtonStroke\").toCSS(),\n      \"background\": ic.get(\"primaryButton\").toCSS()\n    }), new StyleRule(element, \".am5-modal-button.am5-modal-primary:hover\", {\n      \"background\": ic.get(\"primaryButtonHover\").toCSS()\n    })]);\n    rules = new CounterDisposer(function () {\n      rules = undefined;\n      disposer_1.dispose();\n    });\n  }\n\n  return rules.increment();\n}\n/**\r\n * Used to display a modal dialog with HTML content.\r\n */\n\n\nvar Modal =\n/** @class */\nfunction (_super) {\n  __extends(Modal, _super);\n\n  function Modal() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  } //protected _currentPass: number = 0;\n\n\n  Object.defineProperty(Modal.prototype, \"_afterNew\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      var _this = this; // Applying themes because this will not have parents\n\n\n      _super.prototype._afterNewApplyThemes.call(this); // Load CSS\n\n\n      modalCSS($utils.getShadowRoot(this._root.dom), this._root); // Create elements\n\n      var container = document.createElement(\"div\");\n      container.className = \"am5-modal\";\n      container.style.display = \"none\";\n\n      this.root._inner.appendChild(container);\n\n      this.setPrivate(\"container\", container);\n      var curtain = document.createElement(\"div\");\n      curtain.className = \"am5-modal-curtain\";\n      container.appendChild(curtain);\n      this.setPrivate(\"curtain\", curtain);\n      $utils.addEventListener(curtain, \"click\", function () {\n        _this.cancel();\n      });\n      var wrapper = document.createElement(\"div\");\n      wrapper.className = \"am5-modal-wrapper\";\n      container.appendChild(wrapper);\n      this.setPrivate(\"wrapper\", wrapper);\n      var content = document.createElement(\"div\");\n      content.className = \"am5-modal-content\";\n      wrapper.appendChild(content);\n      this.setPrivate(\"content\", content);\n      var html = this.get(\"content\");\n\n      if (html) {\n        content.innerHTML = html;\n      } // Close on ESC\n\n\n      if ($utils.supports(\"keyboardevents\")) {\n        this._disposers.push($utils.addEventListener(document, \"keydown\", function (ev) {\n          if (_this.isOpen() && ev.keyCode == 27) {\n            _this.cancel();\n          }\n        }));\n      }\n    }\n  });\n  Object.defineProperty(Modal.prototype, \"_beforeChanged\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      _super.prototype._beforeChanged.call(this);\n\n      if (this.isDirty(\"content\")) {\n        this.getPrivate(\"content\").innerHTML = this.get(\"content\", \"\");\n      }\n    }\n  });\n  /**\r\n   * Returns `true` if modal is currently open.\r\n   *\r\n   * @return  Modal open?\r\n   */\n\n  Object.defineProperty(Modal.prototype, \"isOpen\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      return this.getPrivate(\"container\").style.display != \"none\";\n    }\n  });\n  /**\r\n   * Opens modal.\r\n   */\n\n  Object.defineProperty(Modal.prototype, \"open\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      this.getPrivate(\"container\").style.display = \"block\";\n      this.events.dispatch(\"opened\", {\n        type: \"opened\",\n        target: this\n      });\n    }\n  });\n  /**\r\n   * Closes modal.\r\n   */\n\n  Object.defineProperty(Modal.prototype, \"close\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      this.getPrivate(\"container\").style.display = \"none\";\n      this.events.dispatch(\"closed\", {\n        type: \"closed\",\n        target: this\n      });\n    }\n  });\n  /**\r\n   * Closes modal and invokes `cancelled` event.\r\n   */\n\n  Object.defineProperty(Modal.prototype, \"cancel\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      this.getPrivate(\"container\").style.display = \"none\";\n      this.events.dispatch(\"cancelled\", {\n        type: \"cancelled\",\n        target: this\n      });\n    }\n  });\n  /**\r\n   * Disposes modal.\r\n   */\n\n  Object.defineProperty(Modal.prototype, \"dispose\", {\n    enumerable: false,\n    configurable: true,\n    writable: true,\n    value: function () {\n      _super.prototype.dispose.call(this);\n\n      this.root.dom.removeChild(this.getPrivate(\"container\"));\n    }\n  });\n  Object.defineProperty(Modal, \"className\", {\n    enumerable: true,\n    configurable: true,\n    writable: true,\n    value: \"Modal\"\n  });\n  Object.defineProperty(Modal, \"classNames\", {\n    enumerable: true,\n    configurable: true,\n    writable: true,\n    value: Entity.classNames.concat([Modal.className])\n  });\n  return Modal;\n}(Entity);\n\nexport { Modal };","map":{"version":3,"mappings":"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","names":["Entity","StyleRule","MultiDisposer","CounterDisposer","$utils","rules","modalCSS","element","root","_prefix","ic","interfaceColors","active","get","toCSS","text","shadow","disposer_1","undefined","dispose","increment","__extends","_super","_afterNewApplyThemes","call","getShadowRoot","_root","dom","container","document","createElement","className","style","display","_inner","appendChild","setPrivate","curtain","addEventListener","_this","cancel","wrapper","content","html","innerHTML","supports","_disposers","push","ev","isOpen","keyCode","_beforeChanged","isDirty","getPrivate","events","dispatch","type","target","removeChild","Object","classNames","concat","Modal"],"sourceRoot":"","sources":["../../../../../src/.internal/core/util/Modal.ts"],"sourcesContent":["import type { Root } from \"../Root\"\n\nimport { Entity, IEntitySettings, IEntityPrivate, IEntityEvents } from \"./Entity\";\nimport { StyleRule } from \"./Utils\"\nimport { MultiDisposer, IDisposer, CounterDisposer } from \"../../core/util/Disposer\";\n\nimport * as $utils from \"./Utils\"\n\n\n/**\n * @ignore\n */\nlet rules: CounterDisposer | undefined;\n\n/**\n * @ignore\n */\nfunction modalCSS(element: ShadowRoot | null, root: Root, _prefix?: string): IDisposer {\n\tconst ic = root.interfaceColors;\n\tconst active = ic.get(\"secondaryButton\")!.toCSS();\n\tconst text = ic.get(\"text\")!.toCSS();\n\tconst shadow = ic.get(\"alternativeBackground\")!.toCSS(0.45);\n\t//const altbg = ic.get(\"alternativeBackground\")!.toCSS();\n\n\tif (!rules) {\n\t\tconst disposer = new MultiDisposer([\n\n\t\t\tnew StyleRule(element, \".am5-modal\", {\n\t\t\t\t\"width\": \"100%\",\n\t\t\t\t\"height\": \"100%\",\n\t\t\t\t\"position\": \"absolute\",\n\t\t\t\t\"z-index\": \"100000\",\n\t\t\t\t\"top\": \"0\",\n\t\t\t\t\"left\": \"0\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5-modal-curtain\", {\n\t\t\t\t\"top\": \"0\",\n\t\t\t\t\"left\": \"0\",\n\t\t\t\t\"width\": \"100%\",\n\t\t\t\t\"height\": \"100%\",\n\t\t\t\t\"position\": \"absolute\",\n\t\t\t\t\"background\": ic.get(\"background\")!.toCSS(0.5),\n\t\t\t\t\"z-index\": \"100\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5-modal-wrapper\", {\n\t\t\t\t\"top\": \"0\",\n\t\t\t\t\"left\": \"0\",\n\t\t\t\t\"width\": \"100%\",\n\t\t\t\t\"height\": \"100%\",\n\t\t\t\t\"position\": \"absolute\",\n\t\t\t\t\"text-align\": \"center\",\n\t\t\t\t\"white-space\": \"nowrap\",\n\t\t\t\t\"background\": ic.get(\"background\")!.toCSS(0.5),\n\t\t\t\t\"z-index\": \"101\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5-modal-wrapper:before\", {\n\t\t\t\t\"content\": \"''\",\n\t\t\t\t\"display\": \"inline-block\",\n\t\t\t\t\"height\": \"100%\",\n\t\t\t\t\"vertical-align\": \"middle\",\n\t\t\t\t\"margin-right\": \"-0.25em\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5-modal-content\", {\n\t\t\t\t\"display\": \"inline-block\",\n\t\t\t\t\"padding\": \"1.2em\",\n\t\t\t\t\"vertical-align\": \"middle\",\n\t\t\t\t\"text-align\": \"left\",\n\t\t\t\t\"white-space\": \"normal\",\n\t\t\t\t\"background\": ic.get(\"background\")!.toCSS(),\n\t\t\t\t//\"border\": \"1px solid \" + ic.get(\"alternativeBackground\")!.toCSS(),\n\t\t\t\t\"border-radius\": \"4px\",\n\t\t\t\t\"-webkit-box-shadow\": \"0px 0px 36px 0px \" + shadow,\n\t\t\t\t\"box-shadow\": \"0px 0px 36px 0px \" + shadow,\n\t\t\t\t\"color\": text\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5-modal-content h1\", {\n\t\t\t\t\"font-size\": \"1em\",\n\t\t\t\t\"margin\": \"0 0 0.5em 0\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5-modal-table\", {\n\t\t\t\t\"display\": \"table\",\n\t\t\t\t\"margin\": \"1em 0\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5-modal-table-row\", {\n\t\t\t\t\"display\": \"table-row\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5-modal-table-heading\", {\n\t\t\t\t\"display\": \"table-heading\",\n\t\t\t\t\"padding\": \"3px 10px 3px 0\",\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5-modal-table-cell\", {\n\t\t\t\t\"display\": \"table-cell\",\n\t\t\t\t\"padding\": \"3px 0 3px 0\",\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5-modal-table-cell > *\", {\n\t\t\t\t\"vertical-align\": \"middle\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5-modal-content input[type=text], .am5-modal-content input[type=number], .am5-modal-content select\", {\n\t\t\t\t\"border\": \"1px solid \" + active,\n\t\t\t\t\"border-radius\": \"4px\",\n\t\t\t\t\"padding\": \"3px 5px\",\n\t\t\t\t\"margin\": \"2px\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5-modal-input-narrow\", {\n\t\t\t\t\"width\": \"50px\"\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5-modal-button\", {\n\t\t\t\t\"font-weight\": \"400\",\n\t\t\t\t\"color\": ic.get(\"secondaryButtonText\")!.toCSS(),\n\t\t\t\t\"line-height\": \"1.5\",\n\t\t\t\t\"text-align\": \"center\",\n\t\t\t\t\"text-decoration\": \"none\",\n\t\t\t\t\"vertical-align\": \"middle\",\n\t\t\t\t\"cursor\": \"pointer\",\n\t\t\t\t\"padding\": \"0.2em 0.8em\",\n\t\t\t\t\"font-size\": \"1em\",\n\t\t\t\t\"border-radius\": \"0.25em\",\n\t\t\t\t\"margin\": \"0 0.25em 0 0\",\n\t\t\t\t\"border\": \"1px solid \" + ic.get(\"secondaryButtonStroke\")!.toCSS(),\n\t\t\t\t\"background\": ic.get(\"secondaryButton\")!.toCSS()\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5-modal-button:hover\", {\n\t\t\t\t\"background\": ic.get(\"secondaryButtonHover\")!.toCSS()\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5-modal-button.am5-modal-primary\", {\n\t\t\t\t\"color\": ic.get(\"primaryButtonText\")!.toCSS(),\n\t\t\t\t\"border\": \"1px solid \" + ic.get(\"primaryButtonStroke\")!.toCSS(),\n\t\t\t\t\"background\": ic.get(\"primaryButton\")!.toCSS()\n\t\t\t}),\n\n\t\t\tnew StyleRule(element, \".am5-modal-button.am5-modal-primary:hover\", {\n\t\t\t\t\"background\": ic.get(\"primaryButtonHover\")!.toCSS()\n\t\t\t}),\n\n\t\t]);\n\n\t\trules = new CounterDisposer(() => {\n\t\t\trules = undefined;\n\t\t\tdisposer.dispose();\n\t\t});\n\t}\n\n\treturn rules.increment();\n}\n\n\nexport interface IModalSettings extends IEntitySettings {\n\tcontent?: string;\n}\n\nexport interface IModalPrivate extends IEntityPrivate {\n\tcontainer: HTMLDivElement;\n\tcurtain: HTMLDivElement;\n\twrapper: HTMLDivElement;\n\tcontent: HTMLDivElement;\n}\n\nexport interface IModalEvents extends IEntityEvents {\n\t\"opened\": {}\n\t\"closed\": {}\n\t\"cancelled\": {}\n}\n\n/**\n * Used to display a modal dialog with HTML content.\n */\nexport class Modal extends Entity {\n\tpublic static className: string = \"Modal\";\n\tpublic static classNames: Array<string> = Entity.classNames.concat([Modal.className]);\n\n\tdeclare public _settings: IModalSettings;\n\tdeclare public _privateSettings: IModalPrivate;\n\tdeclare public _events: IModalEvents;\n\n\t//protected _currentPass: number = 0;\n\n\tprotected _afterNew() {\n\t\t// Applying themes because this will not have parents\n\t\tsuper._afterNewApplyThemes();\n\n\t\t// Load CSS\n\t\tmodalCSS($utils.getShadowRoot(this._root.dom), this._root);\n\n\t\t// Create elements\n\t\tconst container = document.createElement(\"div\");\n\t\tcontainer.className = \"am5-modal\";\n\t\tcontainer.style.display = \"none\";\n\t\tthis.root._inner.appendChild(container);\n\t\tthis.setPrivate(\"container\", container);\n\n\t\tconst curtain = document.createElement(\"div\");\n\t\tcurtain.className = \"am5-modal-curtain\";\n\t\tcontainer.appendChild(curtain);\n\t\tthis.setPrivate(\"curtain\", curtain);\n\n\t\t$utils.addEventListener(curtain, \"click\", () => {\n\t\t\tthis.cancel();\n\t\t});\n\n\t\tconst wrapper = document.createElement(\"div\");\n\t\twrapper.className = \"am5-modal-wrapper\";\n\t\tcontainer.appendChild(wrapper);\n\t\tthis.setPrivate(\"wrapper\", wrapper);\n\n\t\tconst content = document.createElement(\"div\");\n\t\tcontent.className = \"am5-modal-content\";\n\t\twrapper.appendChild(content);\n\t\tthis.setPrivate(\"content\", content);\n\n\t\tconst html = this.get(\"content\");\n\t\tif (html) {\n\t\t\tcontent.innerHTML = html;\n\t\t}\n\n\t\t// Close on ESC\n\t\tif ($utils.supports(\"keyboardevents\")) {\n\t\t\tthis._disposers.push($utils.addEventListener(document, \"keydown\", (ev: KeyboardEvent) => {\n\t\t\t\tif (this.isOpen() && ev.keyCode == 27) {\n\t\t\t\t\tthis.cancel();\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n\n\tpublic _beforeChanged() {\n\t\tsuper._beforeChanged();\n\n\t\tif (this.isDirty(\"content\")) {\n\t\t\tthis.getPrivate(\"content\").innerHTML = this.get(\"content\", \"\");\n\t\t}\n\t}\n\n\t/**\n\t * Returns `true` if modal is currently open.\n\t * \n\t * @return  Modal open?\n\t */\n\tpublic isOpen(): boolean {\n\t\treturn this.getPrivate(\"container\").style.display != \"none\";\n\t}\n\n\t/**\n\t * Opens modal.\n\t */\n\tpublic open(): void {\n\t\tthis.getPrivate(\"container\").style.display = \"block\";\n\t\tthis.events.dispatch(\"opened\", {\n\t\t\ttype: \"opened\",\n\t\t\ttarget: this\n\t\t});\n\t}\n\n\t/**\n\t * Closes modal.\n\t */\n\tpublic close(): void {\n\t\tthis.getPrivate(\"container\").style.display = \"none\";\n\t\tthis.events.dispatch(\"closed\", {\n\t\t\ttype: \"closed\",\n\t\t\ttarget: this\n\t\t});\n\t}\n\n\t/**\n\t * Closes modal and invokes `cancelled` event.\n\t */\n\tpublic cancel(): void {\n\t\tthis.getPrivate(\"container\").style.display = \"none\";\n\t\tthis.events.dispatch(\"cancelled\", {\n\t\t\ttype: \"cancelled\",\n\t\t\ttarget: this\n\t\t});\n\t}\n\n\t/**\n\t * Disposes modal.\n\t */\n\tpublic dispose() {\n\t\tsuper.dispose();\n\t\tthis.root.dom.removeChild(this.getPrivate(\"container\"));\n\t}\n\n}"]},"metadata":{},"sourceType":"module"}